var SCM = SCM || {};
SCM.Ajax = function(s) {
    var e = {
        get: function(e, t) {
            return new i(e,"GET",t)
        },
        post: function(e, t) {
            return new i(e,"POST",t)
        },
        ajax: function(e, t, n) {
            return new i(e,t,n)
        },
        _objectToFormData: n,
        _formatPostData: p
    };
    var r = {
        Text: "text",
        Html: "html",
        Json: "json",
        Xml: "xml",
        ActionResultModel: {
            Full: "actionResultModelFull",
            FullEnsureSuccess: "actionResultModelFullEnsureSuccess",
            Success: "actionResultModelSuccess",
            Html: "actionResultModelHtml",
            RedirectUrl: "actionResultModelRedirectUrl",
            ReturnId: "actionResultModelReturnId",
            Data: "actionResultModelData"
        }
    }
      , a = {
        Default: "Default",
        Json: "application/json; charset=utf-8",
        UrlEncoded: "application/x-www-form-urlencoded"
    };
    function i(e, t, n, i) {
        this._url = e,
        this._method = t || "GET",
        this._data = n,
        this._dataType = i || r.Text,
        this._internalPromise = null,
        this._requestContentType = a.Default,
        this._abortableRequestHandle = null
    }
    function t(e) {
        this._ajaxResult = e,
        this._expectedComponent = r.ActionResultModel.Full,
        this._internalPromise = null
    }
    function l(e, t, n) {
        e = new Error(e);
        return e.name = "AjaxError",
        e.userFriendlyMessage = t,
        e.actionResultModel = n,
        Object.setPrototypeOf(e, Object.getPrototypeOf(this)),
        Error.captureStackTrace && Error.captureStackTrace(e, l),
        e
    }
    function o(e, t, n, i, a) {
        if ("function" == typeof window.fetch)
            return function(e, t, n, i, a) {
                var o = new AbortController;
                "GET" === t && n && (e = function(e, t) {
                    "object" == typeof t && (t = function(t) {
                        return Object.keys(t).map(function(e) {
                            return e + "=" + t[e]
                        }).join("&")
                    }(t));
                    t && t.length && ["?", "&"].includes(t[0]) && (t = t.substring(1));
                    return e.includes("?") ? e + "&" + t : e + "?" + t
                }(e, n),
                n = void 0);
                n = {
                    method: t,
                    body: p(n, a),
                    signal: o.signal
                };
                return n.headers = function(e, t) {
                    var n = {};
                    !function(e) {
                        var t = window.location.origin
                          , e = new URL(e,t).origin;
                        return t === e
                    }(e) || (n["X-Requested-With"] = "XMLHttpRequest",
                    n["X-Requested-With-Lies"] = "Not actually XMLHttpRequest, but Fetch API via SCM.Ajax; X-Requested-With is set for server-side backwards compatibility");
                    f(t) && (n["Content-Type"] = t);
                    return n
                }(e, a),
                {
                    promise: fetch(e, n).then(function(e) {
                        if (!e.ok)
                            throw new l("Bad response from server: " + e.status + ": " + e.statusText,"Bad response from server");
                        return i === r.Json ? e.json() : e.text()
                    }).catch(function(e) {
                        throw new l("Request failed: " + e,"Request failed")
                    }),
                    abortableRequestHandle: o
                }
            }(e, t, n, i, a);
        if ("function" == typeof s && s() && s().jquery)
            return function(e, t, n, a, i) {
                var o, r = {
                    url: e,
                    method: t,
                    type: t,
                    data: n,
                    dataType: a
                };
                !function(e) {
                    return e instanceof FormData && Array.from(e).filter(function(e) {
                        return 1 < e.length && e[1]instanceof File
                    }).length
                }(n) || (r.contentType = !1,
                r.processData = !1);
                f(i) && (r.contentType = i);
                return {
                    promise: new Promise(function(t, i) {
                        o = s.ajax(r).done(function(e) {
                            t(e)
                        }).fail(function(e, t, n) {
                            i(new l("parsererror" === t ? "Failed to parse response as " + a : n,"Request failed"))
                        })
                    }
                    ),
                    abortableRequestHandle: o
                }
            }(e, t, n, i, a);
        throw new Error("No supported AJAX implementations found.")
    }
    function n(e) {
        if (e) {
            if (e instanceof FormData || "object" != typeof e)
                return e;
            var t = new FormData;
            return function n(i, a, o) {
                i = i || new FormData;
                if (Array.isArray(a))
                    for (var e = 0; e < a.length; e++) {
                        var t = o + "[" + e + "]";
                        n(i, a[e], t)
                    }
                else
                    d(a) ? i.append(o, a.toISOString()) : !c(a) || u(a) || h(a) ? i.append(o, a) : Object.keys(a).forEach(function(e) {
                        var t = o ? o + "[" + e + "]" : e;
                        n(i, a[e], t)
                    })
            }(t, e),
            t
        }
    }
    function c(e) {
        return e === Object(e)
    }
    function d(e) {
        return e instanceof Date
    }
    function u(e) {
        return e && "number" == typeof e.size && "string" == typeof e.type && "function" == typeof e.slice
    }
    function h(e) {
        return u(e) && "string" == typeof e.name && ("object" == typeof e.lastModifiedDate || "number" == typeof e.lastModified)
    }
    function f(e) {
        return e && e === a.Json
    }
    function p(e, t) {
        switch (t) {
        case a.UrlEncoded:
            return new URLSearchParams(e);
        case a.Json:
            return JSON.stringify(e);
        default:
            return n(e)
        }
    }
    function g(e, t) {
        e = e.then(function(e) {
            if (!e || void 0 === e.Success)
                throw new l("Response does not appear to be an ActionResultModel","Unexpected response from server");
            return e
        });
        if (t === r.ActionResultModel.Full)
            return e;
        e = e.then(function(e) {
            if (e.Success)
                return e;
            var t, n = "Unspecified error";
            throw (t = e) && t.Messages && t.Messages.length ? n = e.Messages[0] : (t = e) && t.ValidationErrors && t.ValidationErrors.length && t.ValidationErrors[0].Errors && t.ValidationErrors[0].Errors.length ? n = e.ValidationErrors[0].Errors[0] : e.Html && (n = e.Html),
            new l(n,"Request was not successful",e)
        });
        return t === r.ActionResultModel.FullEnsureSuccess ? e : t === r.ActionResultModel.Success ? e.then(function() {
            return !0
        }) : t === r.ActionResultModel.Html ? e.then(function(e) {
            if ("string" != typeof e.Html)
                throw new l("No HTML was provided in the response","Unexpected response from server",e);
            return e.Html
        }) : t === r.ActionResultModel.RedirectUrl ? e.then(function(e) {
            if ("string" != typeof e.RedirectUrl)
                throw new l("No RedirectUrl was provided in the response","Unexpected response from server",e);
            return e.RedirectUrl
        }) : t === r.ActionResultModel.ReturnId ? e.then(function(e) {
            if ("string" != typeof e.ReturnId)
                throw new l("No ReturnId was provided in the response","Unexpected response from server",e);
            return e.ReturnId
        }) : t === r.ActionResultModel.Data ? e.then(function(e) {
            if (void 0 === e.Data || null === e.Data || "object" != typeof e.Data)
                throw new l("No Data object was provided in the response","Unexpected response from server",e);
            return e.Data
        }) : e
    }
    return i.prototype.then = function(e, t) {
        var n;
        return this._internalPromise || (n = o(this._url, this._method, this._data, this._dataType, this._requestContentType),
        this._internalPromise = n.promise,
        this._abortableRequestHandle = n.abortableRequestHandle),
        this._internalPromise = this._internalPromise.then(e, t),
        this
    }
    ,
    i.prototype.catch = function(e) {
        var t;
        return this._internalPromise || (t = o(this._url, this._method, this._data, this._dataType, this._requestContentType),
        this._internalPromise = t.promise,
        this._abortableRequestHandle = t.abortableRequestHandle),
        this._internalPromise = this._internalPromise.catch(e),
        this
    }
    ,
    i.prototype.finally = function(e) {
        var t;
        return this._internalPromise || (t = o(this._url, this._method, this._data, this._dataType, this._requestContentType),
        this._internalPromise = t.promise,
        this._abortableRequestHandle = t.abortableRequestHandle),
        this._internalPromise = this._internalPromise.finally(e),
        this
    }
    ,
    i.prototype.sendAsJson = function() {
        return this._requestContentType = a.Json,
        this
    }
    ,
    i.prototype.sendAsUrlEncoded = function() {
        return this._requestContentType = a.UrlEncoded,
        this
    }
    ,
    i.prototype.abort = function() {
        var e;
        return (e = this._abortableRequestHandle) && e.abort && e.abort(),
        this
    }
    ,
    i.prototype.expectJson = function() {
        return this._dataType = r.Json,
        this.then(function(e) {
            return e
        })
    }
    ,
    i.prototype.expectHtml = function() {
        return this._dataType = r.Html,
        this.then(function(e) {
            return e
        })
    }
    ,
    i.prototype.expectText = function() {
        return this._dataType = r.Text,
        this.then(function(e) {
            return e
        })
    }
    ,
    i.prototype.expectXml = function() {
        return this._dataType = r.Xml,
        this.then(function(e) {
            return e
        })
    }
    ,
    i.prototype.expect = function(t, n) {
        return "function" == typeof t && (n = t,
        t = null),
        this.then(function(e) {
            if (!n(e))
                throw new l(t || "Unexpected result from server");
            return e
        })
    }
    ,
    i.prototype.expectActionResultModel = function() {
        return this._dataType = r.Json,
        new t(this)
    }
    ,
    t.prototype.then = function(e, t) {
        return this._internalPromise = (this._internalPromise || g(this._ajaxResult, this._expectedComponent)).then(e, t),
        this
    }
    ,
    t.prototype.catch = function(e) {
        return this.intrnalPromise = (this._internalPromise || g(this._ajaxResult, this._expectedComponent)).catch(e),
        this
    }
    ,
    t.prototype.finally = function(e) {
        return this._internalPromise = (this._internalPromise || g(this._ajaxResult, this._expectedComponent)).finally(e),
        this
    }
    ,
    t.prototype.ensureSuccess = function() {
        return this._expectedComponent = r.ActionResultModel.FullEnsureSuccess,
        this
    }
    ,
    t.prototype.expectSuccess = function() {
        return this._expectedComponent = r.ActionResultModel.Success,
        this
    }
    ,
    t.prototype.expectHtml = function() {
        return this._expectedComponent = r.ActionResultModel.Html,
        this
    }
    ,
    t.prototype.expectRedirectUrl = function() {
        return this._expectedComponent = r.ActionResultModel.RedirectUrl,
        this
    }
    ,
    t.prototype.expectReturnId = function() {
        return this._expectedComponent = r.ActionResultModel.ReturnId,
        this
    }
    ,
    t.prototype.expectData = function() {
        return this._expectedComponent = r.ActionResultModel.Data,
        this
    }
    ,
    t.prototype.abort = function() {
        return this._ajaxResult && this._ajaxResult.abort(),
        this
    }
    ,
    l.prototype = Object.create(Error.prototype, {
        constructor: {
            value: Error,
            enumerable: !1,
            writable: !0,
            configurable: !0
        }
    }),
    Object.setPrototypeOf ? Object.setPrototypeOf(l, Error) : l.__proto__ = Error,
    e
}(window.jQuery || {}),
"object" == typeof module && module.exports && (module.exports = SCM.Ajax);
var SCM = SCM || {};
SCM.Retry = function() {
    var e = {
        policy: function() {
            return new t
        },
        wait: function(e) {
            return (new t).handleResult(function() {
                return !0
            }).waitAndRetry(1, e).execute(function() {}).catch(function() {})
        }
    };
    var i = function(e) {
        return 50
    };
    function t() {
        this._exceptionPredicates = [],
        this._resultPredicates = [],
        this._retryCount = 0,
        this._onRetry = null,
        this._waitTimeCalculator = i
    }
    function f(e) {
        e = new Error(e);
        return e.name = "RetryError",
        Object.setPrototypeOf(e, Object.getPrototypeOf(this)),
        Error.captureStackTrace && Error.captureStackTrace(e, f),
        e
    }
    return t.prototype.handleException = function(e) {
        if (void 0 === e)
            this._exceptionPredicates.push(function() {
                return !0
            });
        else {
            if ("function" != typeof e)
                throw new f("exceptionPredicate must be a function");
            this._exceptionPredicates.push(e)
        }
        return this
    }
    ,
    t.prototype.handleResult = function(e) {
        if ("function" != typeof e)
            throw new f("resultPredicate must be a function");
        return this._resultPredicates.push(e),
        this
    }
    ,
    t.prototype.untilResultIs = function(t) {
        return this._resultPredicates.push(function(e) {
            return e != t
        }),
        this
    }
    ,
    t.prototype.retry = function(e, t) {
        return void 0 === e && (e = 1),
        "function" == typeof e && (t = e,
        e = 1),
        this._retryCount = e,
        "function" == typeof t && (this._onRetry = t),
        this
    }
    ,
    t.prototype.waitAndRetry = function(e, t, n) {
        if ("number" != typeof e)
            throw new f("retryCount must be specified as an integer");
        return this._retryCount = e,
        void 0 !== t && (this._waitTimeCalculator = function(t, e) {
            if ("number" == typeof t)
                return function(e) {
                    return t
                }
                ;
            if (Array.isArray(t) && t.length === e) {
                if (t.length !== e)
                    throw new f("Wait time array length must match retryCount");
                return function(e) {
                    return t[e - 1]
                }
            }
            return "function" != typeof t ? i : t
        }(t, e)),
        "function" == typeof n && (this._onRetry = n),
        this
    }
    ,
    t.prototype.execute = function(s) {
        var l = this._resultPredicates
          , c = this._exceptionPredicates
          , d = this._onRetry
          , u = this._waitTimeCalculator
          , h = this._retryCount;
        return new Promise(function(e, n) {
            var i = 0;
            function a() {
                try {
                    var e = s();
                    (t = e) && "function" == typeof t.then && "function" == typeof t.catch ? e.then(function(e) {
                        o(e)
                    }).catch(function(e) {
                        r(e)
                    }) : o(e)
                } catch (e) {
                    r(e)
                }
                var t
            }
            function o(t) {
                l.some(function(e) {
                    return e(t)
                }) ? i < h ? (i++,
                "function" == typeof d && d(t, i),
                setTimeout(a, u(i))) : n(new f("retryCount exceeded")) : e(t)
            }
            function r(t) {
                i < h && c.some(function(e) {
                    return e(t)
                }) ? (i++,
                "function" == typeof d && d(t, i),
                setTimeout(a, u(i))) : n(t)
            }
            a()
        }
        )
    }
    ,
    f.prototype = Object.create(Error.prototype, {
        constructor: {
            value: Error,
            enumerable: !1,
            writable: !0,
            configurable: !0
        }
    }),
    Object.setPrototypeOf ? Object.setPrototypeOf(f, Error) : f.__proto__ = Error,
    e
}(),
SCM.wait = SCM.wait || SCM.Retry.wait,
"object" == typeof module && module.exports && (module.exports = SCM.Retry),
function() {
    function e(e, t) {
        t = t || {
            bubbles: !1,
            cancelable: !1,
            detail: void 0
        };
        var n = document.createEvent("CustomEvent");
        return n.initCustomEvent(e, t.bubbles, t.cancelable, t.detail),
        n
    }
    "function" != typeof window.CustomEvent && (e.prototype = window.Event.prototype,
    window.CustomEvent = e)
}(),
function() {
    var e, t = (e = window.navigator.userAgent,
    0 < (t = e.indexOf("MSIE")) ? parseInt(e.substring(t + 5, e.indexOf(".", t))) : navigator.userAgent.match(/trident/gi) ? 11 : navigator.userAgent.match(/edge/gi) ? 13 : 0);
    0 < t && t < 13 ? $("html").addClass("IE IE-" + t) : 12 < t && $("html").addClass("IE IE-Edge")
}();
var debounce = function(i, a, o) {
    var r;
    return function() {
        var e = this
          , t = arguments
          , n = o && !r;
        clearTimeout(r),
        r = setTimeout(function() {
            r = null,
            o || i.apply(e, t)
        }, a),
        n && i.apply(e, t)
    }
};
function updateViewportDimensions() {
    var e = window
      , t = document
      , n = t.documentElement
      , t = t.getElementsByTagName("body")[0];
    return {
        width: e.innerWidth || n.clientWidth || t.clientWidth,
        height: e.innerHeight || n.clientHeight || t.clientHeight
    }
}
var viewport = updateViewportDimensions()
  , SCM = SCM || {};
SCM.JSUtility = function(d) {
    return {
        equalHeights: function(n, i) {
            function e() {
                var t, e;
                d(n).length && d(window).width() > i ? (t = 0,
                (e = d(n)).attr("style", ""),
                e.each(function() {
                    var e = d(this).outerHeight();
                    t < e && (t = e)
                }),
                d(n).css("height", t)) : d(n).attr("style", "")
            }
            e(),
            d(window).resize(function() {
                e()
            })
        },
        addStateToggle: function(e, t, n) {
            var i = d(e)
              , a = d(t)
              , o = "active-state"
              , r = "target-active"
              , s = d("body")
              , l = t.replace(/.|#/, "") + "-active"
              , t = a.find(".close");
            function c() {
                a.removeClass(o),
                i.removeClass(r),
                n && s.removeClass(l)
            }
            n = n || !1,
            i.click(function(e) {
                e.preventDefault(),
                a.toggleClass(o),
                i.toggleClass(r),
                n && s.toggleClass(l)
            }),
            s.click(function(e) {
                d(e.target).closest(i.add(a)).length || c()
            }),
            t.click(function() {
                c()
            })
        },
        toggleVisibility: function(e, t, n) {
            var i = d(e)
              , a = "target-active";
            t = t || !1,
            n = n || 640;
            function o() {
                var e = d(this)
                  , t = d("." + e.attr("data-toggle-target"));
                e.toggleClass(a),
                t.slideToggle().toggleClass("active")
            }
            var r = debounce(function() {
                t ? (viewport = updateViewportDimensions()).width > n ? (i.off("click.toggle-visibility"),
                i.removeClass(a),
                i.each(function() {
                    d("." + d(this).attr("data-toggle-target")).removeAttr("style").removeClass("active")
                })) : (i.off("click.toggle-visibility"),
                i.on("click.toggle-visibility", o)) : i.on("click.toggle-visibility", o)
            }, 150, !0);
            r(),
            t && d(window).resize(function() {
                r()
            })
        },
        getParameterByName: function(e, t) {
            t = t || window.location.href,
            e = e.replace(/[\[\]]/g, "\\$&");
            t = new RegExp("[?&]" + e + "(=([^&#]*)|&|#|$)").exec(t);
            return t ? t[2] ? decodeURIComponent(t[2].replace(/\+/g, " ")) : "" : null
        }
    }
}(jQuery);
var SCM = SCM || {};
SCM.Logging = function() {
    var e = {
        debug: function(e) {
            n() && console.log(e)
        },
        warn: function(e) {
            console.warn(e)
        },
        error: function(e) {
            console.error(e)
        }
    }
      , t = null;
    return {
        init: function() {},
        getLogger: function() {
            return e
        },
        isJsDebugEnabled: n
    };
    function n() {
        var e;
        return null !== t ? t : t = (e = SCM.JSUtility.getParameterByName("JsDebug", window.location.href)) && "true" === e
    }
}();
var SCM = SCM || {};
SCM.JqueryMigrateLogger = function() {
    var t, n, i = 5e3, e = 20, a = 0;
    return {
        init: function() {
            if (n = SCM.Logging.getLogger(),
            !((t = $("[data-jquery-migrate-logging-enabled]")) && t.length && jQuery.migrateWarnings))
                return void n.debug("jquery-migrate logging is disabled");
            n.debug("jquery-migrate logging is enabled.  Attempting to initialize Application Insights.");
            var e = function() {
                if (!t && !t.length)
                    return "";
                var e = t.data("jqueryMigrateInstrumentationKey");
                return e ? e.trim() : ""
            }();
            if (!e)
                return;
            if (function(e) {
                var t = "appInsightsSDK";
                window[t] = "appInsights";
                t = window[t],
                e = window[t] || function(t) {
                    function e(t) {
                        r[t] = function() {
                            var e = arguments;
                            r.queue.push(function() {
                                r[t].apply(r, e)
                            })
                        }
                    }
                    var r = {
                        config: t,
                        initialize: !0
                    }
                      , n = document
                      , i = window;
                    setTimeout(function() {
                        var e = n.createElement("script");
                        e.src = t.url || "https://az416426.vo.msecnd.net/scripts/b/ai.2.min.js",
                        n.getElementsByTagName("script")[0].parentNode.appendChild(e)
                    });
                    try {
                        r.cookie = n.cookie
                    } catch (t) {}
                    r.queue = [],
                    r.version = 2;
                    for (var s = ["Event", "PageView", "Exception", "Trace", "DependencyData", "Metric", "PageViewPerformance"]; s.length; )
                        e("track" + s.pop());
                    e("startTrackPage"),
                    e("stopTrackPage");
                    var l, a = "Track" + s[0];
                    return e("start" + a),
                    e("stop" + a),
                    e("setAuthenticatedUserContext"),
                    e("clearAuthenticatedUserContext"),
                    e("flush"),
                    !0 === t.disableExceptionTracking || t.extensionConfig && t.extensionConfig.ApplicationInsightsAnalytics && !0 === t.extensionConfig.ApplicationInsightsAnalytics.disableExceptionTracking || (e("_" + (s = "onerror")),
                    l = i[s],
                    i[s] = function(e, t, n, i, a) {
                        var o = l && l(e, t, n, i, a);
                        return !0 !== o && r["_" + s]({
                            message: e,
                            url: t,
                            lineNumber: n,
                            columnNumber: i,
                            error: a
                        }),
                        o
                    }
                    ,
                    t.autoExceptionInstrumented = !0),
                    r
                }({
                    instrumentationKey: e,
                    disableAjaxTracking: !0
                });
                window[t] = e
            }(e),
            !window.appInsights)
                return void n.warn("Application Insights failed to initialize.");
            setTimeout(o, i)
        }
    };
    function o() {
        jQuery.migrateWarnings && jQuery.migrateWarnings.length && (n.debug("Logging " + jQuery.migrateWarnings.length + " jquery-migrate warnings."),
        jQuery.migrateWarnings.forEach(function(e) {
            n.debug(e),
            appInsights.trackEvent({
                name: "jquery-migrate-warning",
                properties: {
                    host: window.location.hostname,
                    url: window.location.href,
                    warning: e
                }
            })
        }),
        jQuery.migrateReset()),
        ++a < e && setTimeout(o, i)
    }
}();
var SCM = SCM || {};
!function(e) {
    var n;
    e.bbq = {},
    e.bbq.getState = n = function(e) {
        var t = window.location.hash
          , n = t.indexOf(e);
        if (!(n < 0)) {
            n = n + e.length + 1;
            e = t.indexOf("&", n);
            return e < 0 ? decodeURI(t.substring(n)) : decodeURI(t.substring(n, e))
        }
    }
    ,
    e.bbq.removeState = function(e) {
        var t = n(e);
        t && location.replace(window.location.hash.replace(e + "=" + encodeURI(t), ""))
    }
    ,
    e.deparam = {},
    e.deparam.querystring = function() {
        for (var e = window.location.search.substring(1).split("&"), t = {}, n = 0; n < e.length; n++) {
            var i = e[n].split("=");
            2 === i.length && (t[i[0]] = decodeURI(i[1]))
        }
        return t
    }
}(jQuery);
var SCM = SCM || {};
SCM.Utilities = SCM.Utilities || {},
function(e, t) {
    e.init = function() {
        var e;
        0 !== t(".brightcove-wrapper video.video-js, .brightcove-player").length && (e = "https://players.brightcove.net/1611106596001/BkMnETZOZ_default/index.min.js",
        t.getScript(e, function() {})),
        0 !== t(".brightcove-wrapper-audio video.video-js").length && (e = "https://players.brightcove.net/1611106596001/ryQZHF29_default/index.min.js",
        t.getScript(e, function() {}))
    }
}(SCM.Utilities.Brightcove = SCM.Utilities.Brightcove || {}, jQuery);
var SCM = SCM || {};
!function(t, n) {
    function i(e) {
        var t = location.hostname
          , e = e.hostname;
        return 0 < e.length && e != t
    }
    t.trackOnPageEvent = function(e) {
        e = "ev=" + encodeURIComponent(e);
        "undefined" != typeof ntptEventTag && ntptEventTag(e)
    }
    ,
    t.trackRelatedLinkEvent = function(e) {
        "undefined" != typeof ntptEventTag && ntptEventTag("event_type=RELATEDLINKS")
    }
    ,
    t.trackSelfServePageEvents = function() {
        n(document).on("click", ".widget-SelfServeContent a", function() {
            i(n(this).get(0)) && t.trackOnPageEvent("self-serve-external-link-" + n(this).attr("href"))
        })
    }
    ,
    t.trackArticlePageEvents = function() {
        var e = n(document);
        e.on("click", "a.article-pdfLink", function() {
            t.trackOnPageEvent("article-pdf")
        }),
        e.on("click", ".st-split-view", function() {
            t.trackOnPageEvent("article-view-split-view")
        }),
        e.on("click", "a.standard-view", function() {
            t.trackOnPageEvent("article-view-standard-view")
        }),
        e.on("click", "li.article-content-filter", function() {
            t.trackOnPageEvent("article-view-" + n(this).attr("data-content-filter"))
        }),
        e.on("click", "#Toolbar .toolboxGetAlertsWidget", function() {
            t.trackOnPageEvent("article-alerts")
        }),
        e.on("click", "#Sidebar .widget-alerts .getAlertsLink", function() {
            t.trackOnPageEvent("article-email-alerts-" + n(this).text())
        }),
        e.on("click", "ul.addthis_toolbox > li > a", function() {
            t.trackOnPageEvent("article-share-" + n(this).attr("title"))
        }),
        e.on("click", "ul#ToolsDrop > li > div.widget", function() {
            var e = null;
            n(this).hasClass("widget-ToolboxGetCitation") ? e = "article-tools-GetCitation" : n(this).hasClass("widget-ToolboxPermissions") && (e = "article-tools-GetPermission"),
            t.trackOnPageEvent(e)
        }),
        e.on("click", "#getCitation.reveal-modal ul > li > a", function() {
            t.trackOnPageEvent("article-tools-GetCitation-" + n(this).text())
        }),
        e.on("click", ".info-card-author .info-card-search a", function() {
            t.trackOnPageEvent("article-author-search-" + n(this).text())
        }),
        e.on("click", ".widget-ArticleJumpLinks .section-jump-link .scrollTo", function() {
            t.trackOnPageEvent("article-section-link-" + n(this).text())
        }),
        e.on("click", ".fig-section .fig-link, .fig-section .fig-view-orig", function() {
            t.trackOnPageEvent("article-figure-view-" + n(this).closest(".fig-section").attr("data-id"))
        }),
        e.on("click", ".fig-section .download-slide", function() {
            t.trackOnPageEvent("article-figure-download-" + n(this).closest(".fig-section").attr("data-id"))
        }),
        e.on("click", ".st-download-images-ppt", function() {
            t.trackOnPageEvent("article-figure-download-all")
        }),
        e.on("click", ".widget-ArticleDataSupplements .dataSuppLink", function() {
            t.trackOnPageEvent("article-data-supplement-" + n(this).href)
        }),
        e.on("click", ".widget-ArticleTopInfo .citation-doi a, .widget-ArticleFulltext a, .widget-RelatedPubMed a", function() {
            i(n(this).get(0)) && (n(this).parents(".citation-links").length ? t.trackOnPageEvent("article-external-link-" + n(this).text()) : t.trackOnPageEvent("article-external-link-" + n(this).attr("href")))
        }),
        e.on("click", ".st-article-history", function() {
            t.trackOnPageEvent("article-history")
        }),
        e.on("click", "#Sidebar .widget-ArticleLevelMetrics .artmet-modal-trigger", function() {
            t.trackOnPageEvent("article-metrics")
        }),
        e.on("click", "#Sidebar .widget-ArticleCitedBy .article-cited-link-wrap a", function() {
            t.trackOnPageEvent("article-citation-" + n(this).text())
        })
    }
    ,
    t.trackBookPageEvents = function() {
        var e = n(document);
        e.on("click", ".widget-BookChapterMainView a.article-pdfLink", function() {
            NTPT_PGEXTRA = NTPT_PGEXTRA.replace("event_type=full-text", "event_type=full-text.pdf"),
            t.trackOnPageEvent("full-text.pdf")
        }),
        e.on("click", ".js-seeAlso-link", function() {
            t.trackRelatedLinkEvent()
        })
    }
    ,
    n(function() {
        n(".pg_article").length && t.trackArticlePageEvents(),
        n(".pg_ChapterStandard").length && t.trackBookPageEvents()
    })
}(SCM.ScholarlyiQ = SCM.ScholarlyiQ || {}, jQuery),
SCM.ArticleListNewAndPopular = {
    registerArticleListNewAndPopularCombinedMode: function() {
        $(".articleListNewAndPopular-mode").each(function() {
            var a = $(this);
            a.on("click", function(e) {
                e.preventDefault(),
                $(".articleListNewAndPopular-mode").removeClass("active");
                var t = a.data("mode");
                $('.articleListNewAndPopular-mode[data-mode="' + t + '"]').addClass("active");
                var n, i = $(".articleListNewAndPopular-ContentView-" + t);
                i.hasClass("hasContent") || (e = function(e) {
                    var t, e = $(e).attr("class");
                    0 <= e.indexOf("widget-instance-") && (t = e.substr(e.indexOf("widget-instance-")).split("-")[2]);
                    return t
                }(".widget-ArticleListNewAndPopular"),
                t = t,
                n = i,
                e = e,
                $.ajax({
                    url: (App.CurrentSubdomain.length ? "/" + App.CurrentSubdomain : "") + "/PlatformArticle/ArticleListNewAndPopularContent/" + (e.length ? "/" + e : ""),
                    cache: !1,
                    data: {
                        mode: t
                    },
                    dataType: "html",
                    success: function(e) {
                        n.html(e)
                    }
                }),
                i.addClass("hasContent")),
                $('section[class*="articleListNewAndPopular-ContentView-"]').hide(),
                i.removeClass("hide"),
                i.show()
            })
        })
    }
},
SCM.CitationModal = {
    registerCitationModalEvents: function(e) {
        var t = "#" + e;
        $(document.body).on("click", '[data-reveal-id="' + e + '"]', function(e) {
            $(t).foundation("reveal", "open")
        }),
        $(document.body).on("opened.fndtn.reveal", t, function() {
            $("select[class='citation-download-format']").prop("selectedIndex", 0),
            $(".citation-download-link").addClass("disabled"),
            $(".citation-download-format").focus()
        }),
        $(document.body).on("closed.fndtn.reveal", t, function() {
            $(".js-cite-button").focus()
        })
    },
    enableCitationDownloadOnFormatSelect: function() {
        $(document.body).on("change", ".citation-download-format", function(e) {
            $(".citation-download-link").removeClass("disabled")
        })
    }
};
var SCM = SCM || {};
SCM.NavDropdown = function() {
    const r = 930;
    return {
        registerNavDropdownEvents: function() {
            var i = !1
              , a = null
              , o = null;
            $(".js-nav-dropdown, .mobile-nav-arrow").on("click", function(e) {
                e.preventDefault(),
                e.stopPropagation(),
                SCM.Toolbar.closeHypothesis();
                var t = $(this);
                a = t.siblings(".site-menu"),
                o = t,
                $(window).width() > r ? ($(".site-menu-item .site-menu").not(a).css("display", "none"),
                $(".js-nav-dropdown").not(o).attr("aria-expanded", "false")) : ((t = (t = e = t).hasClass("mobile-nav-arrow") ? e : e.siblings(".mobile-nav-arrow")).toggleClass("icon-general_arrow-down"),
                t.toggleClass("icon-general_arrow-up")),
                a.slideToggle("fast", function() {
                    i = $(this).is(":visible") ? ($(this).css("display", "block"),
                    o.attr("aria-expanded", "true"),
                    !0) : (o.attr("aria-expanded", "false"),
                    !1)
                })
            }),
            $(document.body).on("click", function(e) {
                var t, n;
                i && (t = e,
                n = o,
                0 === (e = a).has(t.target).length && $(window).width() > r && ($(e).css("display", "none"),
                n.attr("aria-expanded", "false")))
            }),
            $(document.body).on("keyup", function(e) {
                var t;
                i && (t = o,
                "Escape" != (e = e).key && "Esc" != e.key || ($(".site-menu-item .site-menu").css("display", "none"),
                $(".js-nav-dropdown").attr("aria-expanded", "false"),
                t.focus()))
            })
        }
    }
}();
var SCM = SCM || {};
SCM.StickyToolbarHelper = (SCM.StickyToolbarHelper = SCM.StickyToolbarHelper || {},
{
    getStickyToolbarHeight: function() {
        return 0 < $(".js-mobile-nav:visible").length ? $(".js-mobile-nav-sticky").outerHeight() : 0 < $(".js-sticky-toolbar").length && 0 == $(".js-left-nav-col.mobile").length ? 55 : 0
    }
});
var SCM = SCM || {};
SCM.ElementManager = function() {
    return {
        elementContainsClass: n,
        elementComparator: function(e, t) {
            if (e === t)
                return 0;
            if (void 0 === e)
                return -1;
            if (void 0 === t)
                return 1;
            t = e.compareDocumentPosition(t);
            return t & Node.DOCUMENT_POSITION_FOLLOWING || t & Node.DOCUMENT_POSITION_CONTAINED_BY ? -1 : t & Node.DOCUMENT_POSITION_PRECEDING || t & Node.DOCUMENT_POSITION_CONTAINS ? 1 : 0
        },
        createElement: function(e, t, n) {
            var i = document.createElement(e);
            if (Array.isArray(t))
                n = t;
            else if (t)
                for (var a in t)
                    a.startsWith("on") ? i.addEventListener(a.substring(2), t[a]) : i.setAttribute(a, t[a]);
            if (n)
                for (var o = 0; o < n.length; o++) {
                    var r = n[o];
                    r && (r.nodeType ? i.appendChild(r) : i.appendChild(document.createTextNode(r.toString())))
                }
            return i
        },
        elementRemoveClass: function(e, t) {
            if (!n(e, t))
                return;
            e.className = (" " + e.className + " ").replace(" " + t + " ", " ").trim()
        },
        elementAddClass: function(e, t) {
            if (n(e, t))
                return;
            e.className = e.className + " " + t
        },
        getFirstElementByClassName: function(e, t) {
            t = e.getElementsByClassName(t);
            if (0 < t.length)
                return t[0]
        },
        getElementsByClass: a,
        getElementsByClassList: i,
        getElementAtTop: function(e) {
            var t = $(window);
            if (!e || !e.length)
                return;
            var n, i = t.scrollTop() + 60, a = 0, o = e.length - 1, r = $(e[0]), s = r.offset().top - parseInt(r.css("marginTop").replace("px", ""));
            if (i < s)
                return;
            for (; a <= o; ) {
                var l = Math.floor((a + o) / 2);
                if (r = $(e[l]),
                s = r.offset().top - parseInt(r.css("marginTop").replace("px", "")),
                n = r.offset().top + r.height(),
                a === o || s <= i && i <= n) {
                    for (var c = l; l != o && s <= i; )
                        l = c,
                        c += 1,
                        r = $(e[c]),
                        s = r.offset().top,
                        n = s + r.height();
                    return {
                        elem: e[l],
                        idx: l
                    }
                }
                if (i < s)
                    o = l - 1;
                else {
                    if (!(n < i))
                        return {
                            elem: r[0],
                            idx: l
                        };
                    a = l + 1
                }
            }
            return {
                elem: e[Math.min(o, e.length - 1)],
                idx: Math.min(o, e.length - 1)
            }
        },
        removeElements: o,
        removeElementsByClass: function(e, t) {
            o(a(e, t))
        },
        removeElementsByClassList: function(e, t) {
            o(i(e, t))
        }
    };
    function n(e, t) {
        return !!e && -1 < (" " + e.className + " ").indexOf(" " + t + " ")
    }
    function a(e, t) {
        t = e.getElementsByClassName(t);
        return 0 < t.length ? Array.prototype.slice.call(t, 0) : []
    }
    function i(e, t) {
        if (!t)
            return [];
        for (var n = [], i = 0; i < t.length; i++)
            n = n.concat(a(e, t[i]));
        return n
    }
    function o(e) {
        for (var t = 0; t < e.length; t++)
            null != e[t].parentNode && e[t].parentNode.removeChild(e[t])
    }
}();
var SCM = SCM || {};
SCM.SplitScreenHelper = function(r, i) {
    return {
        isArticlePage: a,
        positionSplitScreenBasedOnStandardView: function(e, t) {
            var n = $("#split-view-scroll-pane");
            e ? a() ? function(e, t, n) {
                r.elementContainsClass(e, "js-splitscreen-backreferences-title") || r.elementContainsClass(e, "js-splitview-ref-list") ? (n.scrollTop(0),
                $(".js-References-tab-trigger").click()) : r.elementContainsClass(e, "js-splitscreen-backnotes-title") || r.elementContainsClass(e, "js-splitscreen-footnotegroup-title") || r.elementContainsClass(e, "js-splitscreen-backfootnotegroup-title") || r.elementContainsClass(e, "footnote") ? (n.scrollTop(0),
                $(".js-Notes-tab-trigger").click()) : s(e) || l(e) || c(e) || d(e) ? (n.scrollTop(0),
                $(".js-FiguresTables-tab-trigger").click()) : (t = document.getElementById(t + "-sv").offsetTop,
                n.scrollTop(t))
            }(e, t, n) : function(e, t) {
                if (r.elementContainsClass(e, "section-type--references") || r.elementContainsClass(e, "js-splitview-ref-list") || u(e, "js-splitview-ref-list"))
                    t.scrollTop(0),
                    $(".js-References-tab-trigger").click();
                else if (r.elementContainsClass(e, "js-footnotes-target") || r.elementContainsClass(e, "js-end-notes-target") || r.elementContainsClass(e, "js-splitscreen-backnotes-title") || r.elementContainsClass(e, "js-splitscreen-footnotegroup-title"))
                    t.scrollTop(0),
                    $(".js-Notes-tab-trigger").click();
                else if (s(e) || u(e, "fig-section") || l(e) || u(e, "audio") || c(e) || u(e, "video") || d(e))
                    t.scrollTop(0),
                    $(".js-FiguresTables-tab-trigger").click();
                else if (r.elementContainsClass(e, "widget-ChapterAbstract")) {
                    var n = r.getElementsByClass(t[0], "widget-ChapterAbstract");
                    t.scrollTop(n[0].offsetTop)
                } else if (r.elementContainsClass(e, "content-section-header")) {
                    for (var i = r.getElementsByClass(t[0], "content-section-header"), a = 0; a < i.length; a++)
                        if (i[a].dataset.magellanDestination === e.dataset.magellanDestination)
                            return t.scrollTop(i[a].offsetTop)
                } else
                    for (var o = r.getElementsByClassList(t[0], ["js-content-section", "js-splitscreen-section-title"]), a = 0; a < o.length; a++)
                        if (o[a].dataset.statsid === e.dataset.statsid)
                            return t.scrollTop(o[a].offsetTop)
            }(e, n) : n.scrollTop(0)
        },
        positionStandardViewBasedOnSplitScreen: function(e, t) {
            e ? a() ? function(e) {
                var t = i.getStickyToolbarHeight();
                e ? $(window).scrollTop($("#" + e.slice(0, -3)).offset().top - t) : $(window).scrollTop(0)
            }(t) : function(e) {
                var t = $(".js-content-body")
                  , n = i.getStickyToolbarHeight();
                r.elementContainsClass(e, "widget-ChapterAbstract") ? (t = r.getElementsByClass(t[0], "widget-ChapterAbstract"),
                $(window).scrollTop(t[0].offsetTop)) : r.elementContainsClass(e, "content-section-header") ? $(window).scrollTop($("#" + e.dataset.magellanDestination).offset().top - n) : r.elementContainsClass(e, "content-section-header") || e ? $(window).scrollTop($("#" + e.dataset.statsid).offset().top - n) : $(window).scrollTop(0)
            }(e) : $(window).scrollTop(0)
        },
        removeDuplicateItemsBasedOnId: function(e) {
            for (var t = [], n = 0; n < e.length; n++) {
                var i = e[n].firstChild.id;
                t.indexOf(i) < 0 ? t.push(i) : (e.splice(n, 1),
                n--)
            }
        },
        getRightRailWithoutSpecifiedWidgets: function(e) {
            var t = $(".page-column--right").clone();
            return r.removeElementsByClassList(t[0], e),
            t.removeAttr("id"),
            t.removeClass("page-column page-column--right"),
            t[0]
        },
        scrollToNoteInSplitView: function(e, t) {
            if (null == e)
                return;
            var n = null;
            e = $(e).hasClass("js-xref-fn") ? $(e).attr("reveal-id") : $(e).attr("legacysectionid");
            e = $('.split-view-notes [content-id = "' + e + '"]');
            {
                if (!e.length)
                    return;
                n = e.find(".fn")
            }
            for (var i = r.getElementsByClassList(t, ["js-footnotes-target", "js-end-notes-target", "footnote"]), a = 0; a < i.length; a++) {
                var o = $(i[a]).find(n);
                if (o.length)
                    return t.switchTo(),
                    t.scrollTop = 0,
                    void (t.scrollTop = o.offset().top - 50)
            }
        },
        scrollToRefInSplitView: function(e, t) {
            for (var n = r.getElementsByClass(t, "js-splitview-ref-item"), i = 0; i < n.length; i++)
                if (n[i].attributes["content-id"].textContent === e)
                    return t.switchTo(),
                    void (t.scrollTop = n[i].offsetTop)
        },
        registerXrefClicks: function() {
            $(".location-right-pane").on("click", ".js-xref-sec", function(e) {
                e.stopPropagation();
                e = $(".location-left-panel");
                e.length && o(this, e[0])
            })
        },
        findXref: o,
        updatePageNumberCss: function() {
            var e = $(".dynamic-widget-inner-wrap:visible").find(".js-page-icon");
            e.length && ($(".js-sv-references").children().addClass("page-relative"),
            $(".js-sv-notes").children().addClass("page-relative"),
            e.each(function(e) {
                $(icon).parent().addClass("page-icon-adjust")
            }))
        },
        adjustToolbarMargins: function() {
            $(".js-sv-header .toolbar-item").css("margin-right", "1.25em")
        },
        registerMetricsClicks: function() {
            $(".location-right-pane").off("click", ".js-contentmet-modal-trigger, .js-contentmet-views, .js-contentmet-citations"),
            $(".location-right-pane").on("click", ".js-contentmet-modal-trigger, .js-contentmet-views, .js-contentmet-citations", function(e) {
                $("#sv_main:visible").length && (e.stopPropagation(),
                n(".js-contentmet-modal-trigger", !1))
            }),
            $(".location-right-pane").off("click", ".js-artmet-modal-trigger, .artmet-condensed-stats .artmet-views"),
            $(".location-right-pane").on("click", ".js-artmet-modal-trigger, .artmet-condensed-stats .artmet-views", function(e) {
                $("#sv_main:visible").length && (e.stopPropagation(),
                n(".js-artmet-modal-trigger", !0))
            }),
            $(".location-right-pane").off("click", ".js-contentmet-close-modal, .js-artmet-close-modal"),
            $(".location-right-pane").on("click", ".js-contentmet-close-modal, .js-artmet-close-modal", function(e) {
                t($(e.target) === $(".js-artmet-close-modal"))
            }),
            $(".location-right-pane .js-contentmet-modal").off("click"),
            $(".location-right-pane .js-contentmet-modal").on("click", function(e) {
                $(e.target).closest(".location-right-pane .artmet-modal-contents").length || t(!1)
            })
        }
    };
    function a() {
        return 0 < $(".widget-ArticleFulltext").length
    }
    function s(e) {
        return r.elementContainsClass(e, "table-wrap")
    }
    function l(e) {
        return r.elementContainsClass(e, "js-splitscreen-figure-title") || r.elementContainsClass(e, "fig-section")
    }
    function c(e) {
        return r.elementContainsClass(e, "js-splitscreen-audio-title") || r.elementContainsClass(e, "audio")
    }
    function d(e) {
        return r.elementContainsClass(e, "js-splitscreen-video-title") || r.elementContainsClass(e, "video")
    }
    function u(e, t) {
        return r.elementContainsClass(e.firstElementChild, t)
    }
    function t(e) {
        e ? ArtMetric.closeModal() : SCM.ContentMetric.closeModal($(".location-right-pane .artmet-modal-contents"))
    }
    function n(e, t) {
        var n, i = $(".location-right-pane " + e), e = $(".location-right-pane .artmet-modal-contents");
        t ? (n = i.attr("data-article-id"),
        ArtMetric.triggerModal(e, n)) : (n = i.attr("data-resource-id"),
        i = i.attr("data-resource-type"),
        SCM.ContentMetric.triggerModal(e, n, i))
    }
    function o(e, t) {
        var n = $(".content-panel");
        if (n.length) {
            for (var i = e.attributes.href.textContent.substring(1), a = t.querySelectorAll(".disp-formula, .statement"), o = 0; o < a.length; o++)
                if (a[o].attributes["content-id"].textContent === i) {
                    var r = a[o].attributes.class.textContent;
                    if ("disp-formula" === r)
                        return void (n[0].scrollTop = a[o].parentNode.offsetTop);
                    if ("statement" === r)
                        return void (n[0].scrollTop = a[o].offsetTop)
                }
            for (var s = t.querySelectorAll(".section-title[data-legacy-id]"), o = 0; o < s.length; o++)
                if (s[o].attributes["data-legacy-id"].textContent === i)
                    return void (n[0].scrollTop = s[o].offsetTop);
            t = t.querySelectorAll("[data-id=" + i + "]");
            t.length && (n[0].scrollTop = t[0].offsetTop)
        }
    }
}((SCM.SplitScreenHelper = SCM.SplitScreenHelper || {},
SCM.ElementManager), SCM.StickyToolbarHelper);
var SCM = SCM || {};
SCM.SplitScreenContentsToc = function(c, d) {
    return {
        handleJumpLinks: function(e, t) {
            var n = e.attributes.href.textContent.substring(1);
            if ("sectionType"in e.dataset) {
                if (-1 !== e.dataset.sectionType.indexOf("js-splitscreen-backreferences-title") || -1 !== e.dataset.sectionType.indexOf("js-splitscreen-reference-target"))
                    return void t.ReferencesTab.switchTo();
                if (-1 !== e.dataset.sectionType.indexOf("backnotes-title") || -1 !== e.dataset.sectionType.indexOf("js-splitscreen-backfootnotegroup-title") || -1 !== e.dataset.sectionType.indexOf("js-footnotes-target") || -1 !== e.dataset.sectionType.indexOf("js-end-notes-target")) {
                    e = e.dataset.sectionType.split(" "),
                    e = c.getElementsByClassList(t.NotesTab, e);
                    return t.NotesTab.switchTo(),
                    t.NotesTab.scrollTop = 0,
                    void (t.NotesTab.scrollTop = $(e).offset().top - 50)
                }
            }
            n = document.getElementById(n + "-sv");
            n && (t.Content.scrollTop = n.offsetTop)
        },
        setDataSectionTypeForJumpLinks: function(e, t) {
            var n = document.createDocumentFragment();
            n.appendChild(e);
            for (var i = t.getElementsByClassName("js-jumplink"), a = 0; a < i.length; a++) {
                var o, r = i[a], s = r.attributes.href.textContent.substring(1);
                "endNotesTargetLocation" == s && (o = c.getFirstElementByClassName(document, "js-end-notes-target"),
                r.dataset.sectionType = o.className);
                s = n.querySelector("[id='" + s + "-sv']");
                s && (r.dataset.sectionType = s.className)
            }
        },
        highlightSectionTitle: function(r) {
            var s, l;
            return function(e) {
                var t, n, i = r.Content.scrollTop;
                for (t in l = l || function(e) {
                    for (var t = {}, n = c.getElementsByClass(e, "js-jumplink"), i = 0; i < n.length; i++) {
                        var a = n[i].href;
                        a.indexOf("#") < 0 || (a = a.split("#").slice(-1) + "-sv",
                        t[a] = n[i])
                    }
                    return t
                }(r.ContentsTab),
                s = s || function(e, t) {
                    var n;
                    n = d.isArticlePage() ? Array.prototype.concat(Array.prototype.slice.call(e.getElementsByTagName("h2"), 0), Array.prototype.slice.call(e.getElementsByTagName("h3"), 0)).sort(c.elementComparator) : c.getElementsByClass(e, "jumpLoc-sectionId");
                    for (var i = 0; i < n.length; i++)
                        t[n[i].id] || (n.splice(i, 1),
                        i--);
                    return n
                }(r.Content, l),
                l)
                    c.elementRemoveClass(l[t], "active"),
                    c.elementRemoveClass(l[t], "at-highlighted-heading");
                n = r.ContentsTab,
                $(n).find(".js-notes-link-end-notes, .js-notes-link-chapter-footnotes").removeClass("active");
                for (var a = s.length - 1; 0 <= a; a--)
                    if (s[a].offsetTop <= i) {
                        var o = l[s[a].id];
                        return c.elementAddClass(o || l[s[0]], "active"),
                        void c.elementAddClass(o || l[s[0]], "at-highlighted-heading")
                    }
            }
        }
    }
}((SCM.SplitScreenContentsToc = SCM.SplitScreenContentsToc || {},
SCM.ElementManager), SCM.SplitScreenHelper);
var SCM = SCM || {};
SCM.SplitScreenFiguresAndTables = function(o, t) {
    return {
        runVideoJsFixups: function(e) {
            for (var t = e.getElementsByClassName("video-js"), n = 0; n < t.length; n++) {
                var i = t[n]
                  , a = o.createElement("video", {
                    "data-account": i.dataset.account,
                    "data-player": i.dataset.player,
                    "data-embed": i.dataset.embed,
                    class: "brightcove-player video-js",
                    controls: "",
                    "data-video-id": i.dataset.videoId
                });
                i.parentNode.replaceChild(a, i)
            }
            SCM.Utilities.Brightcove.init()
        },
        getFigures: function(e) {
            var t = o.getFirstElementByClassName(e, "graphicalAbstract")
              , e = o.getElementsByClassList(e, ["figure-title", "fig-section", "js-splitscreen-figure-title", "js-sec-fig-section", "js-p-fig-section"]);
            return function(e, t) {
                if (e) {
                    var n = o.getFirstElementByClassName(e, "fig-section");
                    if (n)
                        for (var i = n.dataset.id, a = 0; a < t.length; a++)
                            if (t[a].dataset.id === i) {
                                t[a] = e;
                                break
                            }
                }
            }(t, e),
            e
        },
        getTables: function(e) {
            e = o.getElementsByClassList(e, ["js-splitscreen-tablegroup-title", "table-wrap", "jumpLoc-legacySectionId"]);
            t.isArticlePage() && t.removeDuplicateItemsBasedOnId(e);
            return e
        },
        scrollInFiguresAndTablesSplitView: function(e, t) {
            for (var n = o.getElementsByClassList(t, ["figure-title", "fig-section", "table-wrap-title", "jumpLoc-legacySectionId", "video-section", "audio-section"]), i = 0; i < n.length; i++)
                if (n[i].dataset.id === e)
                    return t.switchTo(),
                    void (t.scrollTop = n[i].offsetTop)
        }
    }
}((SCM.SplitScreenFiguresAndTables = SCM.SplitScreenFiguresAndTables || {},
SCM.ElementManager), SCM.SplitScreenHelper);
var SCM = SCM || {};
SCM.SplitScreenLeftPane = function(s, l, c, d) {
    return {
        registerLeftPaneClickAndResizeEvents: function(a, o, n, e, t) {
            var i = $(o)
              , r = $(n)
              , t = $(t);
            i.on("click", ".xref-page", function(e) {
                e.stopPropagation();
                e = this.dataset.open;
                l.scrollToRefInSplitView(e, a.ReferencesTab)
            }),
            i.on("click", ".xref-bibr", function(e) {
                e.stopPropagation(),
                this.dataset.open && (e = this.dataset.open.split(" ")[0],
                l.scrollToRefInSplitView(e, a.ReferencesTab))
            }),
            i.on("click", ".xref-fig", function(e) {
                e.stopPropagation(),
                c.scrollInFiguresAndTablesSplitView(this.dataset.open, a.FiguresAndTablesTab)
            }),
            i.on("click", ".xref-default", function(e) {
                e.stopPropagation();
                e = this.dataset.open;
                l.scrollToRefInSplitView(e, a.ReferencesTab),
                c.scrollInFiguresAndTablesSplitView(e, a.FiguresAndTablesTab)
            }),
            r.on("click", '.js-related-object[object-type="end-note"], .js-xref-fn', function(e) {
                e.stopPropagation(),
                l.scrollToNoteInSplitView($(this), a.NotesTab)
            }),
            i.on("click", '.js-related-object[object-type="end-note"], .js-xref-fn', function(e) {
                e.stopPropagation(),
                l.scrollToNoteInSplitView($(this), a.NotesTab)
            }),
            i.on("click", ".js-citation-links", function(e) {
                e.stopPropagation(),
                open($(this), a.NotesTab)
            }),
            i.on("click", ".js-xref-sec", function(e) {
                e.stopPropagation(),
                l.findXref(this, o)
            }),
            i.on("click", ".js-jumplink", function(e) {
                e.stopPropagation();
                for (var t = this.attributes.href.textContent.substring(1), n = o.querySelectorAll(".appendix-title[data-legacy-id]"), i = 0; i < n.length; i++)
                    if (n[i].attributes["data-legacy-id"].textContent === t)
                        return void (a.Content.scrollTop = n[i].offsetTop)
            }),
            i.on("click", ".kwd-part", function(e) {
                var t;
                e.stopPropagation(),
                (t = e.target.dataset.keyword) && (t.startsWith('"') || (t = '"' + t),
                t.endsWith('"') || (t += '"'),
                e = 'search-results?page=1&qb={"Keywords1":' + encodeURIComponent(t) + "}&SearchSourceType=1",
                (t = document.getElementById("hfSiteURL")) && (e = "//" + t.value + "/" + e,
                window.location.href = e))
            }),
            $(window).resize(function() {
                $(".al-author-info-wrap.open:visible").length && $(".content-panel:visible").length && h($(".al-author-info-wrap.open"))
            }),
            d.registerCitationModalEvents("sv-getCitation"),
            function() {
                for (var e = n.getElementsByClassName("js-article-history"), t = 0; t < e.length; t++)
                    e[t].addEventListener("click", function(e) {
                        $(".js-history-entries-wrap").last().toggleClass("expanded")
                    })
            }(),
            function(e) {
                for (var t = 0; t < e.length; t++)
                    e[t].addEventListener("click", function(e) {
                        e.stopPropagation || (window.event.cancelBubble = !0),
                        e.stopPropagation(),
                        u();
                        e = $(e.target).parent(".js-flyout-wrap").find(".al-author-info-wrap");
                        $(".al-author-info-wrap").not(e).removeClass("open"),
                        e.toggleClass("open").attr("tabindex", "-1").focus(),
                        $(".al-author-info-wrap").not(e).removeClass("open"),
                        $(document.body).on("click", function(e) {
                            $(e.target).parents(".al-author-info-wrap").length || u()
                        }),
                        h(e)
                    })
            }(function(e, t, n) {
                e = s.getElementsByClassList(e, ["linked-name", "js-linked-footnotes"]);
                return l.isArticlePage() ? e.concat(s.getElementsByClass(t, "linked-name")) : e.concat(s.getElementsByClass(n, "linked-name"))
            }(n, o, e)),
            function(t) {
                var e = s.getFirstElementByClassName(t, "meta-authors--etal");
                e && e.addEventListener("click", function(e) {
                    e.target.attributes["aria-hidden"] = "true",
                    e.target.style.display = "none";
                    e = s.getFirstElementByClassName(t, "meta-authors--remaining");
                    e && (e.attributes["aria-hidden"] = "false",
                    e.style.display = "inline")
                })
            }(n),
            void t.on("click", ".js-version-info-more-link", function(e) {
                $(this).closest(".version-info-text").find(".js-version-info").toggleClass("hide")
            })
        }
    };
    function u() {
        $(".al-author-info-wrap").removeClass("open")
    }
    function h(e) {
        var t = $(".content-panel")
          , t = t.position().left + t.width();
        SCM.SiteJS.shiftOpenAuthorCards(e, t)
    }
}((SCM.SplitScreenLeftPane = SCM.SplitScreenLeftPane || {},
SCM.ElementManager), SCM.SplitScreenHelper, SCM.SplitScreenFiguresAndTables, SCM.CitationModal);
var SCM = SCM || {};
!function(e, f, p, g, o, d, u, m) {
    var v = new function() {
        this.StandardView = 0,
        this.SplitView = 1
    }
    ;
    function b(n, i) {
        this.getCurrentElement = function(e) {
            var t = e === v.StandardView ? n : i
              , e = p.getElementAtTop(t);
            if (e) {
                t = e.elem,
                e.idx;
                if (t)
                    return t
            }
        }
    }
    function t() {
        var n = {};
        this.getWidget = function(e) {
            if (n[e])
                return n[e];
            var t = document.getElementsByClassName(e)[0];
            return t ? n[e] = t : void 0
        }
    }
    var n, i, y = new function() {
        var c = new t
          , d = {};
        function u(e, t) {
            var n = d[e]
              , i = n.dependencies
              , a = [];
            if (i)
                for (var o = 0; o < i.length; o++) {
                    var r, s, l = i[o];
                    d[l] ? (s = u(l, t),
                    a.push(s)) : (s = c.getWidget("widget-instance-" + l) || c.getWidget("widget-" + l)) ? (r = s.cloneNode(!0),
                    function() {
                        for (var e = r.getElementsByTagName("*"), t = 0; t < e.length; t++) {
                            var n = e[t];
                            n.id && (n.id = n.id + "-sv")
                        }
                    }(),
                    a.push(r)) : a.push(document.createDocumentFragment())
                }
            n = n.render.apply(t, a);
            return t[e] = n
        }
        this.create = function(e) {
            var t = document.createDocumentFragment();
            return t.appendChild(u(e, {})),
            t
        }
        ,
        this.register = function(e) {
            d[e.name] = e
        }
    }
    ;
    e.WidgetStore = y,
    e = g.isArticlePage() ? (n = "ArticleFulltext",
    i = "ArticleTopInfo",
    "ArticleJumpLinks") : (n = "BookSectionsText",
    i = "ChapterTopInfo",
    "BookTocSlim"),
    SCM.SplitScreen.init = function() {
        var t = function() {
            for (var e, t = p.getElementsByClass(document, "article-content-filter"), n = 0; n < t.length; n++)
                "article-content" === t[n].dataset.contentFilter && (e = t[n]);
            return function() {
                e && e.click()
            }
        }();
        !function() {
            var r, s, l, c, d = !1;
            function u() {
                SCM.SplitScreen.toggleSplitView()
            }
            c = g.isArticlePage() ? (l = ".widget-ArticleFulltext",
            "pg_articlesplitview") : (l = ".widget-BookSectionsText",
            "pg_chaptersplitview");
            var h = p.createElement("div", {
                class: "math-jax-modal"
            }, [p.createElement("p", {
                class: "bold"
            }, ["Mathematical content on this page is still rendering"]), p.createElement("div", {
                class: "spinner"
            }), p.createElement("p", {}, ["Once the process is complete you will be taken to Split View"]), p.createElement("button", {
                onclick: function(e) {
                    f("#math-jax-modal").foundation("reveal", "close")
                },
                class: "btn"
            }, ["Cancel"])])
              , e = p.createElement("div", {
                "data-reveal": "math-jax-load",
                id: "math-jax-modal",
                class: "reveal-modal"
            });
            e.style.display = "none",
            document.body.appendChild(e),
            SCM.SplitScreen.toggleSplitView = function(e) {
                if (!1 === e) {
                    if (!r)
                        return;
                    d = !0
                } else
                    !0 === e && (d = !1);
                if (f(".close-reveal-modal").click(),
                (0 < f(".MathJax_Preview").length || 0 < f(".display-math").length) && !SCM.SplitScreen.IsMathJaxLoaded) {
                    e = f("#math-jax-modal");
                    return f(document).on("closed.fndtn.reveal", "[data-reveal]", function() {
                        window.removeEventListener("MathJax.complete", u)
                    }),
                    e.empty().prepend(h),
                    e.foundation("reveal", "open"),
                    void window.addEventListener("MathJax.complete", u)
                }
                var t, n, i, a, o;
                f("#math-jax-modal").foundation("reveal", "close"),
                SCM.SiteJS.isFinishedAdjustRelatedTagsDisplay() ? (r || (o = "p,section.abstract,blockquote,div.block-child-p,div.lay-summary",
                t = "h2,h3,h4,.js-footnotes-target,.footnote,.js-content-section",
                (i = f(a = l + " .widget-items")).children(o).each(function(e, t) {
                    t.id = t.id || "scroll-to-" + e
                }),
                n = f(".js-content-body"),
                i = i.children(o + "," + t).add(i.find(".table-wrap,.fig-section,.js-splitscreen-figure-title,.audio-section,.js-splitscreen-audio-title,.video-section,.js-splitscreen-video-title,.js-splitview-ref-list")).add(n.find(f(".js-end-notes-target"))).add(n.find(f(".widget-ChapterAbstract"))),
                document.body.appendChild(y.create("SplitView")),
                m.registerArticleListNewAndPopularCombinedMode(),
                n = f(".location-left-panel"),
                a = f("#sv_main " + a).children(o + "," + t).add(n.find(f(".widget-ChapterAbstract"))),
                s = new b(i,a),
                r = document.body.lastChild,
                window.addthis && window.addthis.toolbox(".addthis_toolbox"),
                SCM.Utilities.Brightcove.init(),
                SCM.SiteJS.articleUserComments(!0),
                (o = f("#hfEnableOupOnlineProductsFeatures")) && "true" === o.val().toLowerCase() && SCM.RefLinks.showParagraphCitations()),
                t = p.getFirstElementByClassName(document, "master-container"),
                n = p.getFirstElementByClassName(document, "widget-SitePageFooter"),
                i = p.getFirstElementByClassName(document, "oup-footer"),
                a = d ? v.SplitView : v.StandardView,
                o = null,
                void 0 !== (a = s.getCurrentElement(a)) && (o = a.id),
                "" === o && (o = f(a).next("span").attr("id")),
                d ? (document.body.className = document.body.className.replace(" " + c, ""),
                t.style.display = "",
                n.style.display = "",
                i.style.display = "",
                r.style.display = "none",
                g.positionStandardViewBasedOnSplitScreen(a, o)) : (t.style.display = "none",
                n.style.display = "none",
                i.style.display = "none",
                document.body.className.indexOf(c) < 0 && (document.body.className += " " + c),
                r.style.display = "",
                g.positionSplitScreenBasedOnStandardView(a, o),
                SCM.JumpLinks.registerFootNotesLink(),
                g.registerXrefClicks(),
                g.registerMetricsClicks(),
                SCM.Toolbar.registerAnnotateLink(),
                g.adjustToolbarMargins()),
                d = !d) : window.addEventListener("adjustRelatedTagsDisplay.complete", u)
            }
            ,
            SCM.SplitScreen.isSplitView = function() {
                return d
            }
        }();
        var e, n = p.getFirstElementByClassName(document, "js-split-view");
        n && ((e = f(n)).is(":visible") || e.parent().remove(),
        n = function(e) {
            e.matches ? SCM.SplitScreen.toggleSplitView(!1) : p.getFirstElementByClassName(document, "item-views") && t()
        }
        ,
        (e = window.matchMedia("(max-width: 930px)")).addListener(n),
        n(e),
        f(document).on("click", ".js-split-view", SCM.SplitScreen.toggleSplitView)),
        MathJax.Hub.Register.StartupHook("End", function() {
            SCM.SplitScreen.IsMathJaxLoaded = !0,
            window.dispatchEvent(new CustomEvent("MathJax.complete"))
        })
    }
    ,
    SCM.SplitScreen.WidgetStore.register({
        name: "ContentsTab",
        dependencies: [e, n],
        render: function(e, t) {
            var n = this;
            return p.removeElementsByClass(e, "contents-title"),
            f(e).on("click", ".js-jumplink", function(e) {
                d.handleJumpLinks(e.currentTarget, n)
            }),
            d.setDataSectionTypeForJumpLinks(t, e),
            p.createElement("div", {
                class: "dynamic-widget-inner-wrap split-view-contents at-split-view-contents",
                style: "display: block;"
            }, [e])
        }
    }),
    SCM.SplitScreen.WidgetStore.register({
        name: "FiguresAndTablesTab",
        dependencies: [n],
        render: function(e) {
            var t, n = o.getFigures(e), i = o.getTables(e), a = p.getElementsByClassList(e, ["js-splitscreen-video-title", "video-section"]), e = p.getElementsByClassList(e, ["js-splitscreen-audio-title", "audio-section"]), i = n.concat(i).sort(p.elementComparator);
            return i = (i = i.concat(a).sort(p.elementComparator)).concat(e).sort(p.elementComparator),
            0 < n.length && ((n = document.getElementsByClassName("js-download-all-images-link")).length && ((t = n[0].cloneNode(!0)).className = "js-download-all-images-link-sv",
            t.textContent = "Download all slides",
            p.elementAddClass(t, "btn")),
            i = [p.createElement("div", {
                class: "download-all-ppt"
            }, [t])].concat(i)),
            0 < i.length ? p.createElement("div", {
                class: "dynamic-widget-inner-wrap at-split-view-FiguresTables js-sv-figuresTables"
            }, i) : p.createElement("div", {
                class: "dynamic-widget-inner-wrap"
            })
        }
    }),
    SCM.SplitScreen.WidgetStore.register({
        name: "ReferencesTab",
        dependencies: [n],
        render: function(e) {
            e = p.getElementsByClassList(e, ["js-splitscreen-reference-target", "js-splitscreen-backreferences-title", "js-splitscreen-references-title", "section-type--references", "js-splitview-paragraph-ref", "js-splitview-ref-list"]);
            return (e = e.filter(function(e) {
                return null === e.closest(".fn")
            })).sort(p.elementComparator),
            p.createElement("div", {
                class: "dynamic-widget-inner-wrap split-view-references at-split-view-references js-sv-references"
            }, e)
        }
    }),
    SCM.SplitScreen.WidgetStore.register({
        name: "NotesTab",
        dependencies: [n, i],
        render: function(e) {
            var t = p.getElementsByClassList(e, ["js-splitscreen-backnotes-title", "js-splitscreen-backfootnotegroup-title", "js-splitscreen-footnotegroup-title", "footnote", "js-footnotes-target"])
              , e = p.getFirstElementByClassName(document, "js-end-notes-target");
            return e && (t = t.concat(e.cloneNode(!0))),
            0 < (t = t.filter(function(e) {
                var t = !0;
                return (!e.classList.contains("footnote") || null === e.parentElement.closest(".js-footnotes-target") && null === e.parentElement.closest(".js-end-notes-target")) && null == e.closest(".table-wrap-foot") || (t = !1),
                t
            })).length ? p.createElement("div", {
                class: "dynamic-widget-inner-wrap at-split-view-notes split-view-notes js-sv-notes"
            }, t) : p.createElement("div", {
                class: "dynamic-widget-inner-wrap"
            })
        }
    }),
    SCM.SplitScreen.WidgetStore.register({
        name: "CommentsTab",
        dependencies: ["UserCommentBody"],
        render: function(e) {
            return p.createElement("div", {
                class: "dynamic-widget-inner-wrap at-split-view-comments"
            }, [e])
        }
    }),
    SCM.SplitScreen.WidgetStore.register({
        name: "RelatedTab",
        dependencies: [],
        render: function() {
            return p.createElement("div", {
                class: "dynamic-widget-inner-wrap split-view-related at-Related-tab-content"
            }, [g.getRightRailWithoutSpecifiedWidgets(["widget-AdBlock"])])
        }
    }),
    SCM.SplitScreen.WidgetStore.register({
        name: "Tabs",
        dependencies: ["ContentsTab", "FiguresAndTablesTab", "ReferencesTab", "NotesTab", "CommentsTab", "RelatedTab"],
        render: function(e, t, n, i, a, o) {
            function r(e, t) {
                for (var n = 0; n < d.length; n++)
                    p.elementRemoveClass(d[n], "active");
                p.elementAddClass(e, "active");
                for (var i = 0; i < u.length; i++)
                    u[i].style.display = "none";
                t.style.display = "block",
                g.updatePageNumberCss()
            }
            function s(e) {
                e = e.target.parentNode;
                r(e, u[e.dataset.tab])
            }
            var l = 0;
            function c(e, t, n) {
                return p.createElement("a", {
                    class: "tab-nav-trigger tab-nav-" + t + "Css" + (n ? " active" : ""),
                    "data-tab": l++
                }, [p.createElement("i", {
                    class: "icon-" + t + "Css"
                }, [p.createElement("span", {
                    class: "sr-t"
                })]), p.createElement("div", {
                    class: "tab-nav-tab-name js-" + t + "-tab-trigger at-" + t + "-tab-trigger",
                    onclick: s
                }, [e])])
            }
            for (var d = [c("Contents", "Content", !0), c("Figures & Tables", "FiguresTables"), c("References", "References"), c("Notes", "Notes"), c("Comments", "Comments"), c("Related", "Related")], u = [e, t, n, i, a, o], h = 0; h < u.length; h++)
                "" === u[h].textContent.trim() ? (d[h].style.display = "none",
                u[h].switchTo = function() {}
                ) : u[h].switchTo = function() {
                    r(this.tab, this.panel)
                }
                .bind({
                    panel: u[h],
                    tab: d[h]
                });
            return p.createElement("div", {
                class: "resources-panel"
            }, [p.createElement("div", {
                class: "location-right-pane"
            }, [p.createElement("div", {
                class: "dynamic-widget-module"
            }, [p.createElement("div", {
                class: "tab-nav",
                style: "visibility: visible;"
            }, d), p.createElement("div", {
                class: "resource-tabs at-splitView-resourceTabs"
            }, u)])])])
        }
    }),
    SCM.SplitScreen.WidgetStore.register({
        name: "Content",
        dependencies: [n, i, "ArticleLinks", "ArticleDataSupplements", "ChapterAbstract", "SolrResourceMetadata", "ChapterVersionInformation", "DrugDisclaimer", "CopyrightStatement"],
        render: function(e, t, n, i, a, o, r, s, l) {
            var c = p.getFirstElementByClassName(e, "graphicalAbstract");
            null != c && p.removeElements([c]),
            p.removeElementsByClassList(e, ["fig-section", "js-sec-fig-section", "js-p-fig-section", "figure-title", "js-splitscreen-figure-title", "js-splitscreen-tablegroup-title", "table-wrap", "js-splitscreen-backnotes-title", "js-splitscreen-backfootnotegroup-title", "js-splitscreen-footnotegroup-title", "footnote", "js-footnotes-target", "js-splitscreen-video-title", "video-section", "js-splitscreen-audio-title", "audio-section", "js-splitscreen-reference-target", "js-splitscreen-backreferences-title", "js-splitscreen-references-title", "section-type--references", "js-splitview-ref-list", "js-splitview-paragraph-ref"]),
            u.registerLeftPaneClickAndResizeEvents(this, e, t, o, r);
            l = [t, n, a, o, r, s, e, l];
            return i && l.push(i),
            p.createElement("div", {
                class: "content-panel",
                onscroll: debounce(d.highlightSectionTitle(this), 16),
                id: "split-view-scroll-pane"
            }, [p.createElement("div", {
                class: "location-left-panel"
            }, [p.createElement("div", {
                class: "content-inner-wrap"
            }, [p.createElement("div", {
                class: "article-body"
            }, [p.createElement("div", {
                class: "content active"
            }, l)])])])])
        }
    }),
    SCM.SplitScreen.WidgetStore.register({
        name: "SwitchView",
        render: function() {
            return p.createElement("li", {
                class: "toolbar-item item-link"
            }, [p.createElement("a", {
                class: "standard-view at-standard-view",
                href: "javascript:;",
                onclick: SCM.SplitScreen.toggleSplitView
            }, [p.createElement("i", {
                class: "icon-menu_standard"
            }), "Standard view"])])
        }
    }),
    SCM.SplitScreen.WidgetStore.register({
        name: "PdfLink",
        render: function() {
            var e = p.getFirstElementByClassName(document, "js-item-pdf");
            if (e)
                return e.cloneNode(!0)
        }
    }),
    SCM.SplitScreen.WidgetStore.register({
        name: "Annotate",
        render: function() {
            var e = p.getFirstElementByClassName(document, "js-item-annotate");
            if (e)
                return e.cloneNode(!0)
        }
    }),
    SCM.SplitScreen.WidgetStore.register({
        name: "ShareThis",
        render: function() {
            var e = p.getFirstElementByClassName(document, "item-share");
            if (e) {
                e = e.cloneNode(!0);
                var t = p.getFirstElementByClassName(e, "drop-trigger");
                return t && t.addEventListener("click", function(e) {
                    e.preventDefault(),
                    f(this).siblings("ul").slideToggle()
                }),
                e
            }
        }
    }),
    SCM.SplitScreen.WidgetStore.register({
        name: "ToolbarCitation",
        render: function() {
            var e = p.getFirstElementByClassName(document, "js-item-cite")
              , t = p.getFirstElementByClassName(e, "js-cite-button");
            if (e && t) {
                e = e.cloneNode(!0);
                return p.getFirstElementByClassName(e, "js-cite-button").setAttribute("data-reveal-id", "sv-" + t.getAttribute("data-reveal-id")),
                p.removeElementsByClass(e, "js-citation-modal"),
                e
            }
        }
    }),
    SCM.SplitScreen.WidgetStore.register({
        name: "CitationModal",
        render: function() {
            var e = p.getFirstElementByClassName(document, "js-citation-modal");
            if (e) {
                var t = e.cloneNode(!0);
                return t.id = "sv-" + e.id,
                t
            }
        }
    }),
    SCM.SplitScreen.WidgetStore.register({
        name: "ToolbarPermissions",
        dependencies: ["ToolboxPermissions"],
        render: function(e) {
            return p.createElement("li", {
                class: "toolbar-item"
            }, [e])
        }
    }),
    SCM.SplitScreen.WidgetStore.register({
        name: "Toolbar",
        dependencies: ["ToolbarCitation", "CitationModal", "ToolbarPermissions", "PdfLink", "ShareThis", "SwitchView", "Annotate"],
        render: function(e, t, n, i, a, o, r) {
            return p.createElement("div", {
                class: "toolbar-wrap"
            }, [p.createElement("div", {
                class: "toolbar-inner-wrap"
            }, [p.createElement("ul", {
                id: "Toolbar",
                role: "navigation"
            }, [i, o, r, e, t, n, a])])])
        }
    }),
    SCM.SplitScreen.WidgetStore.register({
        name: "SplitView",
        dependencies: ["Content", "Tabs", "Toolbar"],
        render: function(e, t, n) {
            return o.runVideoJsFixups(e),
            o.runVideoJsFixups(t),
            p.createElement("div", {
                class: "master-container"
            }, [p.createElement("main", {
                id: "sv_main"
            }, [p.createElement("section", {
                class: "master-main row"
            }, [p.createElement("div", {
                class: "center-inner-row no-overflow"
            }, [p.createElement("div", {
                class: "widget widget-SplitView widget-instance-SplitView_Article"
            }, [p.createElement("div", {
                class: "pseudo-splitview-header js-sv-header"
            }, [p.createElement("div", {
                class: "pseudo-inner-wrap"
            }, [n])]), p.createElement("div", {
                class: "index-inner-wrap"
            }, [t, e])])])])])])
        }
    })
}(SCM.SplitScreen = SCM.SplitScreen || {}, jQuery, SCM.ElementManager, SCM.SplitScreenHelper, SCM.SplitScreenFiguresAndTables, SCM.SplitScreenContentsToc, SCM.SplitScreenLeftPane, SCM.ArticleListNewAndPopular);
var SCM = SCM || {};
!function(e, o) {
    e.ChapterEndNotes = function() {
        o('.js-related-object[object-type="end-note"]').on("click", function() {
            var e = o(this).attr("legacysectionid")
              , t = o('div[content-id = "' + e + '"]:visible');
            null != t && function(e, t) {
                var n = o('#ContentTab .js-footnote-modal[legacysectionid= "' + e + '"]');
                n.off("opened.fndtn.reveal"),
                n.on("opened.fndtn.reveal", function() {
                    o(".js-footnote-modal.open").focus()
                });
                var i, a = o(":focus");
                n.on("closed.fndtn.reveal", function() {
                    a.focus(),
                    o(this).find("[id^='revealContent']").html("")
                }),
                null != t && (i = n.find("#revealContent-" + e)).length && "" === i.html() && i.append(t.clone()),
                n.foundation("reveal", "open"),
                null != n && n.length && o(window).scrollTop(n.offset().top - 50)
            }(e, t.find(".fn"))
        })
    }
    ,
    e.init = function() {
        e.ChapterEndNotes()
    }
}(SCM.ChapterEndNotes = SCM.ChapterEndNotes || {}, jQuery),
function(d, l, i, a) {
    "use strict";
    var t, n, e, o, r;
    function s(e, t) {
        if ("string" != typeof e)
            return d(e, t);
        if (t) {
            var n;
            if (t.jquery) {
                if (!(n = t[0]))
                    return t
            } else
                n = t;
            return d(n.querySelectorAll(e))
        }
        return d(i.querySelectorAll(e))
    }
    function c(e) {
        var t = [];
        return e || t.push("data"),
        0 < this.namespace.length && t.push(this.namespace),
        t.push(this.name),
        t.join("-")
    }
    function u(e) {
        for (var t = e.split("-"), n = t.length, i = []; n--; )
            0 === n && 0 < this.namespace.length ? i.push(this.namespace, t[n]) : i.push(t[n]);
        return i.reverse().join("-")
    }
    function h(n, i) {
        function e() {
            var e = s(this)
              , t = !e.data(a.attr_name(!0) + "-init");
            e.data(a.attr_name(!0) + "-init", d.extend({}, a.settings, i || n, a.data_options(e))),
            t && a.events(this)
        }
        var a = this;
        if (s(this.scope).is("[" + this.attr_name() + "]") ? e.call(this.scope) : s("[" + this.attr_name() + "]", this.scope).each(e),
        "string" == typeof n)
            return this[n].call(this, i)
    }
    function f(e, t) {
        function n() {
            t(e[0])
        }
        !e.attr("src") || e[0].complete || 4 === e[0].readyState ? n() : function() {
            var e, t;
            this.one("load", n),
            /MSIE (\d+\.\d+);/.test(navigator.userAgent) && (t = (e = this.attr("src")).match(/\?/) ? "&" : "?",
            t += "random=" + (new Date).getTime(),
            this.attr("src", e + t))
        }
        .call(e)
    }
    function p(e) {
        this.selector = e,
        this.query = ""
    }
    e = ["foundation-mq-small", "foundation-mq-small-only", "foundation-mq-medium", "foundation-mq-medium-only", "foundation-mq-large", "foundation-mq-large-only", "foundation-mq-xlarge", "foundation-mq-xlarge-only", "foundation-mq-xxlarge", "foundation-data-attribute-namespace"],
    (t = d("head")).prepend(d.map(e, function(e) {
        if (0 === t.has("." + e).length)
            return '<meta class="' + e + '" />'
    })),
    d(function() {
        "undefined" != typeof FastClick && void 0 !== i.body && FastClick.attach(i.body)
    }),
    l.matchMedia || (l.matchMedia = ((r = l.styleMedia || l.media) || (n = i.createElement("style"),
    e = i.getElementsByTagName("script")[0],
    o = null,
    n.type = "text/css",
    n.id = "matchmediajs-test",
    e.parentNode.insertBefore(n, e),
    o = "getComputedStyle"in l && l.getComputedStyle(n, null) || n.currentStyle,
    r = {
        matchMedium: function(e) {
            e = "@media " + e + "{ #matchmediajs-test { width: 1px; } }";
            return n.styleSheet ? n.styleSheet.cssText = e : n.textContent = e,
            "1px" === o.width
        }
    }),
    function(e) {
        return {
            matches: r.matchMedium(e || "all"),
            media: e || "all"
        }
    }
    )),
    function(t) {
        for (var n, a = 0, e = ["webkit", "moz"], i = l.requestAnimationFrame, o = l.cancelAnimationFrame, r = void 0 !== t.fx; a < e.length && !i; a++)
            i = l[e[a] + "RequestAnimationFrame"],
            o = o || l[e[a] + "CancelAnimationFrame"] || l[e[a] + "CancelRequestAnimationFrame"];
        function s() {
            n && (i(s),
            r && t.fx.tick())
        }
        i ? (l.requestAnimationFrame = i,
        l.cancelAnimationFrame = o,
        r && (t.fx.timer = function(e) {
            e() && t.timers.push(e) && !n && (n = !0,
            s())
        }
        ,
        t.fx.stop = function() {
            n = !1
        }
        )) : (l.requestAnimationFrame = function(e) {
            var t = (new Date).getTime()
              , n = Math.max(0, 16 - (t - a))
              , i = l.setTimeout(function() {
                e(t + n)
            }, n);
            return a = t + n,
            i
        }
        ,
        l.cancelAnimationFrame = function(e) {
            clearTimeout(e)
        }
        )
    }(d),
    p.prototype.toString = function() {
        return this.query || (this.query = s(this.selector).css("font-family").replace(/^[\/\\'"]+|(;\s?})+|[\/\\'"]+$/g, ""))
    }
    ,
    l.Foundation = {
        name: "Foundation",
        version: "5.5.3",
        media_queries: {
            small: new p(".foundation-mq-small"),
            "small-only": new p(".foundation-mq-small-only"),
            medium: new p(".foundation-mq-medium"),
            "medium-only": new p(".foundation-mq-medium-only"),
            large: new p(".foundation-mq-large"),
            "large-only": new p(".foundation-mq-large-only"),
            xlarge: new p(".foundation-mq-xlarge"),
            "xlarge-only": new p(".foundation-mq-xlarge-only"),
            xxlarge: new p(".foundation-mq-xxlarge")
        },
        stylesheet: d("<style></style>").appendTo("head")[0].sheet,
        global: {
            namespace: a
        },
        init: function(e, t, n, i, a) {
            var a = [e, n, i, a]
              , o = [];
            if (this.rtl = /rtl/i.test(s("html").attr("dir")),
            this.scope = e || this.scope,
            this.set_namespace(),
            t && "string" == typeof t && !/reflow/i.test(t))
                this.libs.hasOwnProperty(t) && o.push(this.init_lib(t, a));
            else
                for (var r in this.libs)
                    o.push(this.init_lib(r, t));
            return s(l).load(function() {
                s(l).trigger("resize.fndtn.clearing").trigger("resize.fndtn.dropdown").trigger("resize.fndtn.equalizer").trigger("resize.fndtn.interchange").trigger("resize.fndtn.joyride").trigger("resize.fndtn.magellan").trigger("resize.fndtn.topbar").trigger("resize.fndtn.slider")
            }),
            e
        },
        init_lib: function(e, t) {
            return this.libs.hasOwnProperty(e) ? (this.patch(this.libs[e]),
            t && t.hasOwnProperty(e) ? (void 0 !== this.libs[e].settings ? d.extend(!0, this.libs[e].settings, t[e]) : void 0 !== this.libs[e].defaults && d.extend(!0, this.libs[e].defaults, t[e]),
            this.libs[e].init.apply(this.libs[e], [this.scope, t[e]])) : (t = t instanceof Array ? t : new Array(t),
            this.libs[e].init.apply(this.libs[e], t))) : function() {}
        },
        patch: function(e) {
            e.scope = this.scope,
            e.namespace = this.global.namespace,
            e.rtl = this.rtl,
            e.data_options = this.utils.data_options,
            e.attr_name = c,
            e.add_namespace = u,
            e.bindings = h,
            e.S = this.utils.S
        },
        inherit: function(e, t) {
            for (var n = t.split(" "), i = n.length; i--; )
                this.utils.hasOwnProperty(n[i]) && (e[n[i]] = this.utils[n[i]])
        },
        set_namespace: function() {
            var e = this.global.namespace === a ? d(".foundation-data-attribute-namespace").css("font-family") : this.global.namespace;
            this.global.namespace = e === a || /false/i.test(e) ? "" : e
        },
        libs: {},
        utils: {
            S: s,
            throttle: function(n, i) {
                var a = null;
                return function() {
                    var e = this
                      , t = arguments;
                    null == a && (a = setTimeout(function() {
                        n.apply(e, t),
                        a = null
                    }, i))
                }
            },
            debounce: function(i, a, o) {
                var r, s;
                return function() {
                    var e = this
                      , t = arguments
                      , n = o && !r;
                    return clearTimeout(r),
                    r = setTimeout(function() {
                        r = null,
                        o || (s = i.apply(e, t))
                    }, a),
                    n && (s = i.apply(e, t)),
                    s
                }
            },
            data_options: function(e, t) {
                t = t || "options";
                var n, i, a, o, r, s, l = {}, e = (o = e,
                0 < (r = Foundation.global.namespace).length ? o.data(r + "-" + t) : o.data(t));
                if ("object" == typeof e)
                    return e;
                function c(e) {
                    return "string" == typeof e ? d.trim(e) : e
                }
                for (n = (a = (e || ":").split(";")).length; n--; )
                    i = [(i = a[n].split(":"))[0], i.slice(1).join(":")],
                    /true/i.test(i[1]) && (i[1] = !0),
                    /false/i.test(i[1]) && (i[1] = !1),
                    s = i[1],
                    isNaN(+s) || null === s || "" === s || !1 === s || !0 === s || (-1 === i[1].indexOf(".") ? i[1] = parseInt(i[1], 10) : i[1] = parseFloat(i[1])),
                    2 === i.length && 0 < i[0].length && (l[c(i[0])] = c(i[1]));
                return l
            },
            register_media: function(e, t) {
                Foundation.media_queries[e] === a && (d("head").append('<meta class="' + t + '"/>'),
                Foundation.media_queries[e] = (("string" == typeof (t = d("." + t).css("font-family")) || t instanceof String) && (t = t.replace(/^['\\/"]+|(;\s?})+|['\\/"]+$/g, "")),
                t))
            },
            add_custom_rule: function(e, t) {
                t === a && Foundation.stylesheet ? Foundation.stylesheet.insertRule(e, Foundation.stylesheet.cssRules.length) : Foundation.media_queries[t] !== a && Foundation.stylesheet.insertRule("@media " + Foundation.media_queries[t] + "{ " + e + " }", Foundation.stylesheet.cssRules.length)
            },
            image_loaded: function(e, t) {
                var n = this
                  , i = e.length;
                0 !== i && !function(e) {
                    for (var t = e.length - 1; 0 <= t; t--)
                        if (e.attr("height") === a)
                            return;
                    return 1
                }(e) || t(e),
                e.each(function() {
                    f(n.S(this), function() {
                        0 === --i && t(e)
                    })
                })
            },
            random_str: function() {
                return this.fidx || (this.fidx = 0),
                this.prefix = this.prefix || [this.name || "F", (+new Date).toString(36)].join("-"),
                this.prefix + (this.fidx++).toString(36)
            },
            match: function(e) {
                return l.matchMedia(e).matches
            },
            is_small_up: function() {
                return this.match(Foundation.media_queries.small)
            },
            is_medium_up: function() {
                return this.match(Foundation.media_queries.medium)
            },
            is_large_up: function() {
                return this.match(Foundation.media_queries.large)
            },
            is_xlarge_up: function() {
                return this.match(Foundation.media_queries.xlarge)
            },
            is_xxlarge_up: function() {
                return this.match(Foundation.media_queries.xxlarge)
            },
            is_small_only: function() {
                return !(this.is_medium_up() || this.is_large_up() || this.is_xlarge_up() || this.is_xxlarge_up())
            },
            is_medium_only: function() {
                return this.is_medium_up() && !this.is_large_up() && !this.is_xlarge_up() && !this.is_xxlarge_up()
            },
            is_large_only: function() {
                return this.is_medium_up() && this.is_large_up() && !this.is_xlarge_up() && !this.is_xxlarge_up()
            },
            is_xlarge_only: function() {
                return this.is_medium_up() && this.is_large_up() && this.is_xlarge_up() && !this.is_xxlarge_up()
            },
            is_xxlarge_only: function() {
                return this.is_medium_up() && this.is_large_up() && this.is_xlarge_up() && this.is_xxlarge_up()
            }
        }
    },
    d.fn.foundation = function() {
        var e = Array.prototype.slice.call(arguments, 0);
        return this.each(function() {
            return Foundation.init.apply(Foundation, [this].concat(e)),
            this
        })
    }
}(jQuery, window, window.document),
function(l, c, t, d) {
    "use strict";
    var u = [];
    function s(e) {
        var t = /fade/i.test(e)
          , e = /pop/i.test(e);
        return {
            animate: t || e,
            pop: e,
            fade: t
        }
    }
    Foundation.libs.reveal = {
        name: "reveal",
        version: "5.5.3",
        locked: !1,
        settings: {
            animation: "fadeAndPop",
            animation_speed: 250,
            close_on_background_click: !0,
            close_on_esc: !0,
            dismiss_modal_class: "close-reveal-modal",
            multiple_opened: !1,
            bg_class: "reveal-modal-bg",
            root_element: "body",
            open: function() {},
            opened: function() {},
            close: function() {},
            closed: function() {},
            on_ajax_error: l.noop,
            bg: l(".reveal-modal-bg"),
            css: {
                open: {
                    opacity: 0,
                    visibility: "visible",
                    display: "block"
                },
                close: {
                    opacity: 1,
                    visibility: "hidden",
                    display: "none"
                }
            }
        },
        init: function(e, t, n) {
            l.extend(!0, this.settings, t, n),
            this.bindings(t, n)
        },
        events: function(e) {
            var i = this
              , a = i.S;
            return a(this.scope).off(".reveal").on("click.fndtn.reveal", "[" + this.add_namespace("data-reveal-id") + "]:not([disabled])", function(e) {
                var t, n;
                e.preventDefault(),
                i.locked || (n = (t = a(this)).data(i.data_attr("reveal-ajax")),
                e = t.data(i.data_attr("reveal-replace-content")),
                i.locked = !0,
                void 0 === n ? i.open.call(i, t) : (n = !0 === n ? t.attr("href") : n,
                i.open.call(i, t, {
                    url: n
                }, {
                    replaceContentSel: e
                })))
            }),
            a(t).on("click.fndtn.reveal", this.close_targets(), function(e) {
                if (e.preventDefault(),
                !i.locked) {
                    var t = a("[" + i.attr_name() + "].open").data(i.attr_name(!0) + "-init") || i.settings
                      , n = a(e.target)[0] === a("." + t.bg_class)[0];
                    if (n) {
                        if (!t.close_on_background_click)
                            return;
                        e.stopPropagation()
                    }
                    i.locked = !0,
                    i.close.call(i, n ? a("[" + i.attr_name() + "].open:not(.toback)") : a(this).closest("[" + i.attr_name() + "]"))
                }
            }),
            0 < a("[" + i.attr_name() + "]", this.scope).length ? a(this.scope).on("open.fndtn.reveal", this.settings.open).on("opened.fndtn.reveal", this.settings.opened).on("opened.fndtn.reveal", this.open_video).on("close.fndtn.reveal", this.settings.close).on("closed.fndtn.reveal", this.settings.closed).on("closed.fndtn.reveal", this.close_video) : a(this.scope).on("open.fndtn.reveal", "[" + i.attr_name() + "]", this.settings.open).on("opened.fndtn.reveal", "[" + i.attr_name() + "]", this.settings.opened).on("opened.fndtn.reveal", "[" + i.attr_name() + "]", this.open_video).on("close.fndtn.reveal", "[" + i.attr_name() + "]", this.settings.close).on("closed.fndtn.reveal", "[" + i.attr_name() + "]", this.settings.closed).on("closed.fndtn.reveal", "[" + i.attr_name() + "]", this.close_video),
            !0
        },
        key_up_on: function(e) {
            var i = this;
            return i.S("body").off("keyup.fndtn.reveal").on("keyup.fndtn.reveal", function(e) {
                var t = i.S("[" + i.attr_name() + "].open")
                  , n = t.data(i.attr_name(!0) + "-init") || i.settings;
                n && 27 === e.which && n.close_on_esc && !i.locked && i.close.call(i, t)
            }),
            !0
        },
        key_up_off: function(e) {
            return this.S("body").off("keyup.fndtn.reveal"),
            !0
        },
        open: function(e, t) {
            var i, a = this;
            e ? void 0 !== e.selector ? i = a.S("#" + e.data(a.data_attr("reveal-id"))).first() : (i = a.S(this.scope),
            t = e) : i = a.S(this.scope);
            var n, o, r, s = (s = i.data(a.attr_name(!0) + "-init")) || this.settings;
            if (i.hasClass("open") && e !== d && e.attr("data-reveal-id") == i.attr("id"))
                return a.close(i);
            i.hasClass("open") || (n = a.S("[" + a.attr_name() + "].open"),
            void 0 === i.data("css-top") && i.data("css-top", parseInt(i.css("top"), 10)).data("offset", this.cache_offset(i)),
            i.attr("tabindex", "0").attr("aria-hidden", "false"),
            this.key_up_on(i),
            i.on("open.fndtn.reveal", function(e) {
                e.namespace
            }),
            i.on("open.fndtn.reveal").trigger("open.fndtn.reveal"),
            n.length < 1 && this.toggle_bg(i, !0),
            "string" == typeof t && (t = {
                url: t
            }),
            o = function() {
                0 < n.length && (s.multiple_opened ? a.to_back(n) : a.hide(n, s.css.close)),
                s.multiple_opened && u.push(i),
                a.show(i, s.css.open)
            }
            ,
            void 0 !== t && t.url ? (r = void 0 !== t.success ? t.success : null,
            l.extend(t, {
                success: function(e, t, n) {
                    !l.isFunction(r) || "string" == typeof (n = r(e, t, n)) && (e = n),
                    ("undefined" != typeof options && void 0 !== options.replaceContentSel ? i.find(options.replaceContentSel) : i).html(e),
                    a.S(i).foundation("section", "reflow"),
                    a.S(i).children().foundation(),
                    o()
                }
            }),
            s.on_ajax_error !== l.noop && l.extend(t, {
                error: s.on_ajax_error
            }),
            l.ajax(t)) : o()),
            a.S(c).trigger("resize")
        },
        close: function(t) {
            var e, t = t && t.length ? t : this.S(this.scope), n = this.S("[" + this.attr_name() + "].open"), i = t.data(this.attr_name(!0) + "-init") || this.settings, a = this;
            0 < n.length && (t.removeAttr("tabindex", "0").attr("aria-hidden", "true"),
            this.locked = !0,
            this.key_up_off(t),
            t.trigger("close.fndtn.reveal"),
            (i.multiple_opened && 1 === n.length || !i.multiple_opened || 1 < t.length) && (a.toggle_bg(t, !1),
            a.to_front(t)),
            i.multiple_opened ? (e = t.is(":not(.toback)"),
            a.hide(t, i.css.close, i),
            e ? u.pop() : u = l.grep(u, function(e) {
                e = e[0] === t[0];
                return e && a.to_front(t),
                !e
            }),
            0 < u.length && a.to_front(u[u.length - 1])) : a.hide(n, i.css.close, i))
        },
        close_targets: function() {
            var e = "." + this.settings.dismiss_modal_class;
            return this.settings.close_on_background_click ? e + ", ." + this.settings.bg_class : e
        },
        toggle_bg: function(e, t) {
            0 === this.S("." + this.settings.bg_class).length && (this.settings.bg = l("<div />", {
                class: this.settings.bg_class
            }).appendTo("body").hide());
            var n = 0 < this.settings.bg.filter(":visible").length;
            t != n && ((t == d ? n : !t) ? this.hide(this.settings.bg) : this.show(this.settings.bg))
        },
        show: function(e, t) {
            if (t) {
                var n, i = (r = e.data(this.attr_name(!0) + "-init") || this.settings).root_element, a = this;
                0 === e.parent(i).length && (n = e.wrap('<div style="display: none;" />').parent(),
                e.on("closed.fndtn.reveal.wrapped", function() {
                    e.detach().appendTo(n),
                    e.unwrap().unbind("closed.fndtn.reveal.wrapped")
                }),
                e.detach().appendTo(i));
                i = s(r.animation);
                if (i.animate || (this.locked = !1),
                i.pop) {
                    t.top = l(c).scrollTop() - e.data("offset") + "px";
                    var o = {
                        top: l(c).scrollTop() + e.data("css-top") + "px",
                        opacity: 1
                    };
                    return setTimeout(function() {
                        return e.css(t).animate(o, r.animation_speed, "linear", function() {
                            a.locked = !1,
                            e.trigger("opened.fndtn.reveal")
                        }).addClass("open")
                    }, r.animation_speed / 2)
                }
                if (t.top = l(c).scrollTop() + e.data("css-top") + "px",
                i.fade) {
                    o = {
                        opacity: 1
                    };
                    return setTimeout(function() {
                        return e.css(t).animate(o, r.animation_speed, "linear", function() {
                            a.locked = !1,
                            e.trigger("opened.fndtn.reveal")
                        }).addClass("open")
                    }, r.animation_speed / 2)
                }
                return e.css(t).show().css({
                    opacity: 1
                }).addClass("open").trigger("opened.fndtn.reveal")
            }
            var r;
            return s((r = this.settings).animation).fade ? e.fadeIn(r.animation_speed / 2) : (this.locked = !1,
            e.show())
        },
        to_back: function(e) {
            e.addClass("toback")
        },
        to_front: function(e) {
            e.removeClass("toback")
        },
        hide: function(e, t) {
            if (t) {
                var n = e.data(this.attr_name(!0) + "-init")
                  , i = this
                  , a = s((n = n || this.settings).animation);
                if (a.animate || (this.locked = !1),
                a.pop) {
                    var o = {
                        top: -l(c).scrollTop() - e.data("offset") + "px",
                        opacity: 0
                    };
                    return setTimeout(function() {
                        return e.animate(o, n.animation_speed, "linear", function() {
                            i.locked = !1,
                            e.css(t).trigger("closed.fndtn.reveal")
                        }).removeClass("open")
                    }, n.animation_speed / 2)
                }
                if (a.fade) {
                    o = {
                        opacity: 0
                    };
                    return setTimeout(function() {
                        return e.animate(o, n.animation_speed, "linear", function() {
                            i.locked = !1,
                            e.css(t).trigger("closed.fndtn.reveal")
                        }).removeClass("open")
                    }, n.animation_speed / 2)
                }
                return e.hide().css(t).removeClass("open").trigger("closed.fndtn.reveal")
            }
            return s((n = this.settings).animation).fade ? e.fadeOut(n.animation_speed / 2) : e.hide()
        },
        close_video: function(e) {
            var t = l(".flex-video", e.target)
              , e = l("iframe", t);
            0 < e.length && (e.attr("data-src", e[0].src),
            e.attr("src", e.attr("src")),
            t.hide())
        },
        open_video: function(e) {
            var t = l(".flex-video", e.target)
              , n = t.find("iframe");
            0 < n.length && ("string" == typeof n.attr("data-src") ? n[0].src = n.attr("data-src") : (e = n[0].src,
            n[0].src = d,
            n[0].src = e),
            t.show())
        },
        data_attr: function(e) {
            return 0 < this.namespace.length ? this.namespace + "-" + e : e
        },
        cache_offset: function(e) {
            var t = e.show().height() + parseInt(e.css("top"), 10) + e.scrollY;
            return e.hide(),
            t
        },
        off: function() {
            l(this.scope).off(".fndtn.reveal")
        },
        reflow: function() {}
    }
}(jQuery, window, window.document),
function() {
    for (var o = 0, e = ["ms", "moz", "webkit", "o"], t = 0; t < e.length && !window.requestAnimationFrame; ++t)
        window.requestAnimationFrame = window[e[t] + "RequestAnimationFrame"],
        window.cancelAnimationFrame = window[e[t] + "CancelAnimationFrame"] || window[e[t] + "CancelRequestAnimationFrame"];
    window.requestAnimationFrame || (window.requestAnimationFrame = function(e, t) {
        var n = (new Date).getTime()
          , i = Math.max(0, 16 - (n - o))
          , a = window.setTimeout(function() {
            e(n + i)
        }, i);
        return o = n + i,
        a
    }
    ),
    window.cancelAnimationFrame || (window.cancelAnimationFrame = function(e) {
        clearTimeout(e)
    }
    )
}(),
function(s) {
    var a = "unobtrusiveAjaxClick"
      , o = "unobtrusiveAjaxClickTarget";
    function l(e, t) {
        for (var n = window, i = (e || "").split("."); n && i.length; )
            n = n[i.shift()];
        return "function" == typeof n ? n : (t.push(e),
        Function.constructor.apply(null, t))
    }
    function c(e) {
        return "GET" === e || "POST" === e
    }
    function i(r, e) {
        var i, a, o, t = r.getAttribute("data-ajax-confirm");
        t && !window.confirm(t) || (i = s(r.getAttribute("data-ajax-loading")),
        o = parseInt(r.getAttribute("data-ajax-loading-duration"), 10) || 0,
        s.extend(e, {
            type: r.getAttribute("data-ajax-method") || void 0,
            url: r.getAttribute("data-ajax-url") || void 0,
            cache: "true" === (r.getAttribute("data-ajax-cache") || "").toLowerCase(),
            beforeSend: function(e) {
                var t, n;
                return t = e,
                c(n = a) || t.setRequestHeader("X-HTTP-Method-Override", n),
                !1 !== (n = l(r.getAttribute("data-ajax-begin"), ["xhr"]).apply(r, arguments)) && i.show(o),
                n
            },
            complete: function() {
                i.hide(o),
                l(r.getAttribute("data-ajax-complete"), ["xhr", "status"]).apply(r, arguments)
            },
            success: function(e, t, n) {
                var i, a, o;
                i = r,
                a = e,
                -1 === (n.getResponseHeader("Content-Type") || "text/html").indexOf("application/x-javascript") && (o = (i.getAttribute("data-ajax-mode") || "").toUpperCase(),
                s(i.getAttribute("data-ajax-update")).each(function(e, t) {
                    switch (o) {
                    case "BEFORE":
                        s(t).prepend(a);
                        break;
                    case "AFTER":
                        s(t).append(a);
                        break;
                    case "REPLACE-WITH":
                        s(t).replaceWith(a);
                        break;
                    default:
                        s(t).html(a)
                    }
                })),
                l(r.getAttribute("data-ajax-success"), ["data", "status", "xhr"]).apply(r, arguments)
            },
            error: function() {
                l(r.getAttribute("data-ajax-failure"), ["xhr", "status", "error"]).apply(r, arguments)
            }
        }),
        e.data.push({
            name: "X-Requested-With",
            value: "XMLHttpRequest"
        }),
        c(a = e.type.toUpperCase()) || (e.type = "POST",
        e.data.push({
            name: "X-HTTP-Method-Override",
            value: a
        })),
        s.ajax(e))
    }
    s(document).on("click", "a[data-ajax=true]", function(e) {
        e.preventDefault(),
        i(this, {
            url: this.href,
            type: "GET",
            data: []
        })
    }),
    s(document).on("click", "form[data-ajax=true] input[type=image]", function(e) {
        var t = e.target.name
          , n = s(e.target)
          , i = s(n.parents("form")[0])
          , n = n.offset();
        i.data(a, [{
            name: t + ".x",
            value: Math.round(e.pageX - n.left)
        }, {
            name: t + ".y",
            value: Math.round(e.pageY - n.top)
        }]),
        setTimeout(function() {
            i.removeData(a)
        }, 0)
    }),
    s(document).on("click", "form[data-ajax=true] :submit", function(e) {
        var t = e.currentTarget.name
          , n = s(e.target)
          , i = s(n.parents("form")[0]);
        i.data(a, t ? [{
            name: t,
            value: e.currentTarget.value
        }] : []),
        i.data(o, n),
        setTimeout(function() {
            i.removeData(a),
            i.removeData(o)
        }, 0)
    }),
    s(document).on("submit", "form[data-ajax=true]", function(e) {
        var t = s(this).data(a) || []
          , n = s(this).data(o)
          , n = n && (n.hasClass("cancel") || void 0 !== n.attr("formnovalidate"));
        e.preventDefault(),
        !n && ((n = s(n = this).data("unobtrusiveValidation")) && n.validate && !n.validate()) || i(this, {
            url: this.action,
            type: this.method || "GET",
            data: t.concat(s(this).serializeArray())
        })
    })
}(jQuery),
function(e) {
    "function" == typeof define && define.amd ? define(["jquery"], e) : "object" == typeof module && module.exports ? module.exports = e(require("jquery")) : e(jQuery)
}(function(d) {
    d.extend(d.fn, {
        validate: function(e) {
            if (this.length) {
                var i = d.data(this[0], "validator");
                return i ? i : (this.attr("novalidate", "novalidate"),
                i = new d.validator(e,this[0]),
                d.data(this[0], "validator", i),
                i.settings.onsubmit && (this.on("click.validate", ":submit", function(e) {
                    i.submitButton = e.currentTarget,
                    d(this).hasClass("cancel") && (i.cancelSubmit = !0),
                    void 0 !== d(this).attr("formnovalidate") && (i.cancelSubmit = !0)
                }),
                this.on("submit.validate", function(n) {
                    function e() {
                        var e, t;
                        return i.submitButton && (i.settings.submitHandler || i.formSubmitted) && (e = d("<input type='hidden'/>").attr("name", i.submitButton.name).val(d(i.submitButton).val()).appendTo(i.currentForm)),
                        !i.settings.submitHandler || (t = i.settings.submitHandler.call(i, i.currentForm, n),
                        e && e.remove(),
                        void 0 !== t && t)
                    }
                    return i.settings.debug && n.preventDefault(),
                    i.cancelSubmit ? (i.cancelSubmit = !1,
                    e()) : i.form() ? i.pendingRequest ? !(i.formSubmitted = !0) : e() : (i.focusInvalid(),
                    !1)
                })),
                i)
            }
            e && e.debug && window.console && console.warn("Nothing selected, can't validate, returning nothing.")
        },
        valid: function() {
            var e, t, n;
            return d(this[0]).is("form") ? e = this.validate().form() : (n = [],
            e = !0,
            t = d(this[0].form).validate(),
            this.each(function() {
                (e = t.element(this) && e) || (n = n.concat(t.errorList))
            }),
            t.errorList = n),
            e
        },
        rules: function(e, t) {
            var n, i, a, o, r, s = this[0];
            if (null != s && (!s.form && s.hasAttribute("contenteditable") && (s.form = this.closest("form")[0],
            s.name = this.attr("name")),
            null != s.form)) {
                if (e)
                    switch (i = (n = d.data(s.form, "validator").settings).rules,
                    a = d.validator.staticRules(s),
                    e) {
                    case "add":
                        d.extend(a, d.validator.normalizeRule(t)),
                        delete a.messages,
                        i[s.name] = a,
                        t.messages && (n.messages[s.name] = d.extend(n.messages[s.name], t.messages));
                        break;
                    case "remove":
                        return t ? (r = {},
                        d.each(t.split(/\s/), function(e, t) {
                            r[t] = a[t],
                            delete a[t]
                        }),
                        r) : (delete i[s.name],
                        a)
                    }
                return (e = d.validator.normalizeRules(d.extend({}, d.validator.classRules(s), d.validator.attributeRules(s), d.validator.dataRules(s), d.validator.staticRules(s)), s)).required && (o = e.required,
                delete e.required,
                e = d.extend({
                    required: o
                }, e)),
                e.remote && (o = e.remote,
                delete e.remote,
                e = d.extend(e, {
                    remote: o
                })),
                e
            }
        }
    }),
    d.extend(d.expr.pseudos || d.expr[":"], {
        blank: function(e) {
            return !d.trim("" + d(e).val())
        },
        filled: function(e) {
            e = d(e).val();
            return null !== e && !!d.trim("" + e)
        },
        unchecked: function(e) {
            return !d(e).prop("checked")
        }
    }),
    d.validator = function(e, t) {
        this.settings = d.extend(!0, {}, d.validator.defaults, e),
        this.currentForm = t,
        this.init()
    }
    ,
    d.validator.format = function(n, e) {
        return 1 === arguments.length ? function() {
            var e = d.makeArray(arguments);
            return e.unshift(n),
            d.validator.format.apply(this, e)
        }
        : (void 0 === e || (2 < arguments.length && e.constructor !== Array && (e = d.makeArray(arguments).slice(1)),
        e.constructor !== Array && (e = [e]),
        d.each(e, function(e, t) {
            n = n.replace(new RegExp("\\{" + e + "\\}","g"), function() {
                return t
            })
        })),
        n)
    }
    ,
    d.extend(d.validator, {
        defaults: {
            messages: {},
            groups: {},
            rules: {},
            errorClass: "error",
            pendingClass: "pending",
            validClass: "valid",
            errorElement: "label",
            focusCleanup: !1,
            focusInvalid: !0,
            errorContainer: d([]),
            errorLabelContainer: d([]),
            onsubmit: !0,
            ignore: ":hidden",
            ignoreTitle: !1,
            onfocusin: function(e) {
                this.lastActive = e,
                this.settings.focusCleanup && (this.settings.unhighlight && this.settings.unhighlight.call(this, e, this.settings.errorClass, this.settings.validClass),
                this.hideThese(this.errorsFor(e)))
            },
            onfocusout: function(e) {
                this.checkable(e) || !(e.name in this.submitted) && this.optional(e) || this.element(e)
            },
            onkeyup: function(e, t) {
                9 === t.which && "" === this.elementValue(e) || -1 !== d.inArray(t.keyCode, [16, 17, 18, 20, 35, 36, 37, 38, 39, 40, 45, 144, 225]) || (e.name in this.submitted || e.name in this.invalid) && this.element(e)
            },
            onclick: function(e) {
                e.name in this.submitted ? this.element(e) : e.parentNode.name in this.submitted && this.element(e.parentNode)
            },
            highlight: function(e, t, n) {
                ("radio" === e.type ? this.findByName(e.name) : d(e)).addClass(t).removeClass(n)
            },
            unhighlight: function(e, t, n) {
                ("radio" === e.type ? this.findByName(e.name) : d(e)).removeClass(t).addClass(n)
            }
        },
        setDefaults: function(e) {
            d.extend(d.validator.defaults, e)
        },
        messages: {
            required: "This field is required.",
            remote: "Please fix this field.",
            email: "Please enter a valid email address.",
            url: "Please enter a valid URL.",
            date: "Please enter a valid date.",
            dateISO: "Please enter a valid date (ISO).",
            number: "Please enter a valid number.",
            digits: "Please enter only digits.",
            equalTo: "Please enter the same value again.",
            maxlength: d.validator.format("Please enter no more than {0} characters."),
            minlength: d.validator.format("Please enter at least {0} characters."),
            rangelength: d.validator.format("Please enter a value between {0} and {1} characters long."),
            range: d.validator.format("Please enter a value between {0} and {1}."),
            max: d.validator.format("Please enter a value less than or equal to {0}."),
            min: d.validator.format("Please enter a value greater than or equal to {0}."),
            step: d.validator.format("Please enter a multiple of {0}.")
        },
        autoCreateRanges: !1,
        prototype: {
            init: function() {
                this.labelContainer = d(this.settings.errorLabelContainer),
                this.errorContext = this.labelContainer.length && this.labelContainer || d(this.currentForm),
                this.containers = d(this.settings.errorContainer).add(this.settings.errorLabelContainer),
                this.submitted = {},
                this.valueCache = {},
                this.pendingRequest = 0,
                this.pending = {},
                this.invalid = {},
                this.reset();
                var n, i = this.groups = {};
                function e(e) {
                    !this.form && this.hasAttribute("contenteditable") && (this.form = d(this).closest("form")[0],
                    this.name = d(this).attr("name"));
                    var t = d.data(this.form, "validator")
                      , n = "on" + e.type.replace(/^validate/, "")
                      , i = t.settings;
                    i[n] && !d(this).is(i.ignore) && i[n].call(t, this, e)
                }
                d.each(this.settings.groups, function(n, e) {
                    "string" == typeof e && (e = e.split(/\s/)),
                    d.each(e, function(e, t) {
                        i[t] = n
                    })
                }),
                n = this.settings.rules,
                d.each(n, function(e, t) {
                    n[e] = d.validator.normalizeRule(t)
                }),
                d(this.currentForm).on("focusin.validate focusout.validate keyup.validate", ":text, [type='password'], [type='file'], select, textarea, [type='number'], [type='search'], [type='tel'], [type='url'], [type='email'], [type='datetime'], [type='date'], [type='month'], [type='week'], [type='time'], [type='datetime-local'], [type='range'], [type='color'], [type='radio'], [type='checkbox'], [contenteditable], [type='button']", e).on("click.validate", "select, option, [type='radio'], [type='checkbox']", e),
                this.settings.invalidHandler && d(this.currentForm).on("invalid-form.validate", this.settings.invalidHandler)
            },
            form: function() {
                return this.checkForm(),
                d.extend(this.submitted, this.errorMap),
                this.invalid = d.extend({}, this.errorMap),
                this.valid() || d(this.currentForm).triggerHandler("invalid-form", [this]),
                this.showErrors(),
                this.valid()
            },
            checkForm: function() {
                this.prepareForm();
                for (var e = 0, t = this.currentElements = this.elements(); t[e]; e++)
                    this.check(t[e]);
                return this.valid()
            },
            element: function(e) {
                var t, n, i = this.clean(e), a = this.validationTargetFor(i), o = this, r = !0;
                return void 0 === a ? delete this.invalid[i.name] : (this.prepareElement(a),
                this.currentElements = d(a),
                (n = this.groups[a.name]) && d.each(this.groups, function(e, t) {
                    t === n && e !== a.name && (i = o.validationTargetFor(o.clean(o.findByName(e)))) && i.name in o.invalid && (o.currentElements.push(i),
                    r = o.check(i) && r)
                }),
                t = !1 !== this.check(a),
                r = r && t,
                this.invalid[a.name] = !t,
                this.numberOfInvalids() || (this.toHide = this.toHide.add(this.containers)),
                this.showErrors(),
                d(e).attr("aria-invalid", !t)),
                r
            },
            showErrors: function(t) {
                var n;
                t && (n = this,
                d.extend(this.errorMap, t),
                this.errorList = d.map(this.errorMap, function(e, t) {
                    return {
                        message: e,
                        element: n.findByName(t)[0]
                    }
                }),
                this.successList = d.grep(this.successList, function(e) {
                    return !(e.name in t)
                })),
                this.settings.showErrors ? this.settings.showErrors.call(this, this.errorMap, this.errorList) : this.defaultShowErrors()
            },
            resetForm: function() {
                d.fn.resetForm && d(this.currentForm).resetForm(),
                this.invalid = {},
                this.submitted = {},
                this.prepareForm(),
                this.hideErrors();
                var e = this.elements().removeData("previousValue").removeAttr("aria-invalid");
                this.resetElements(e)
            },
            resetElements: function(e) {
                var t;
                if (this.settings.unhighlight)
                    for (t = 0; e[t]; t++)
                        this.settings.unhighlight.call(this, e[t], this.settings.errorClass, ""),
                        this.findByName(e[t].name).removeClass(this.settings.validClass);
                else
                    e.removeClass(this.settings.errorClass).removeClass(this.settings.validClass)
            },
            numberOfInvalids: function() {
                return this.objectLength(this.invalid)
            },
            objectLength: function(e) {
                var t, n = 0;
                for (t in e)
                    void 0 !== e[t] && null !== e[t] && !1 !== e[t] && n++;
                return n
            },
            hideErrors: function() {
                this.hideThese(this.toHide)
            },
            hideThese: function(e) {
                e.not(this.containers).text(""),
                this.addWrapper(e).hide()
            },
            valid: function() {
                return 0 === this.size()
            },
            size: function() {
                return this.errorList.length
            },
            focusInvalid: function() {
                if (this.settings.focusInvalid)
                    try {
                        d(this.findLastActive() || this.errorList.length && this.errorList[0].element || []).filter(":visible").focus().trigger("focusin")
                    } catch (e) {}
            },
            findLastActive: function() {
                var t = this.lastActive;
                return t && 1 === d.grep(this.errorList, function(e) {
                    return e.element.name === t.name
                }).length && t
            },
            elements: function() {
                var t = this
                  , n = {};
                return d(this.currentForm).find("input, select, textarea, [contenteditable]").not(":submit, :reset, :image, :disabled").not(this.settings.ignore).filter(function() {
                    var e = this.name || d(this).attr("name");
                    return !e && t.settings.debug && window.console && console.error("%o has no name assigned", this),
                    this.hasAttribute("contenteditable") && (this.form = d(this).closest("form")[0],
                    this.name = e),
                    !(e in n || !t.objectLength(d(this).rules())) && (n[e] = !0)
                })
            },
            clean: function(e) {
                return d(e)[0]
            },
            errors: function() {
                var e = this.settings.errorClass.split(" ").join(".");
                return d(this.settings.errorElement + "." + e, this.errorContext)
            },
            resetInternals: function() {
                this.successList = [],
                this.errorList = [],
                this.errorMap = {},
                this.toShow = d([]),
                this.toHide = d([])
            },
            reset: function() {
                this.resetInternals(),
                this.currentElements = d([])
            },
            prepareForm: function() {
                this.reset(),
                this.toHide = this.errors().add(this.containers)
            },
            prepareElement: function(e) {
                this.reset(),
                this.toHide = this.errorsFor(e)
            },
            elementValue: function(e) {
                var t = d(e)
                  , n = e.type;
                return "radio" === n || "checkbox" === n ? this.findByName(e.name).filter(":checked").val() : "number" === n && void 0 !== e.validity ? e.validity.badInput ? "NaN" : t.val() : (t = e.hasAttribute("contenteditable") ? t.text() : t.val(),
                "file" === n ? "C:\\fakepath\\" === t.substr(0, 12) ? t.substr(12) : 0 <= (n = t.lastIndexOf("/")) || 0 <= (n = t.lastIndexOf("\\")) ? t.substr(n + 1) : t : "string" == typeof t ? t.replace(/\r/g, "") : t)
            },
            check: function(t) {
                t = this.validationTargetFor(this.clean(t));
                var e, n, i, a, o = d(t).rules(), r = d.map(o, function(e, t) {
                    return t
                }).length, s = !1, l = this.elementValue(t);
                if ("function" == typeof o.normalizer ? a = o.normalizer : "function" == typeof this.settings.normalizer && (a = this.settings.normalizer),
                a) {
                    if ("string" != typeof (l = a.call(t, l)))
                        throw new TypeError("The normalizer should return a string value.");
                    delete o.normalizer
                }
                for (n in o) {
                    i = {
                        method: n,
                        parameters: o[n]
                    };
                    try {
                        if ("dependency-mismatch" === (e = d.validator.methods[n].call(this, l, t, i.parameters)) && 1 === r) {
                            s = !0;
                            continue
                        }
                        if (s = !1,
                        "pending" === e)
                            return void (this.toHide = this.toHide.not(this.errorsFor(t)));
                        if (!e)
                            return this.formatAndAdd(t, i),
                            !1
                    } catch (e) {
                        throw this.settings.debug && window.console && console.log("Exception occurred when checking element " + t.id + ", check the '" + i.method + "' method.", e),
                        e instanceof TypeError && (e.message += ".  Exception occurred when checking element " + t.id + ", check the '" + i.method + "' method."),
                        e
                    }
                }
                if (!s)
                    return this.objectLength(o) && this.successList.push(t),
                    !0
            },
            customDataMessage: function(e, t) {
                return d(e).data("msg" + t.charAt(0).toUpperCase() + t.substring(1).toLowerCase()) || d(e).data("msg")
            },
            customMessage: function(e, t) {
                e = this.settings.messages[e];
                return e && (e.constructor === String ? e : e[t])
            },
            findDefined: function() {
                for (var e = 0; e < arguments.length; e++)
                    if (void 0 !== arguments[e])
                        return arguments[e]
            },
            defaultMessage: function(e, t) {
                "string" == typeof t && (t = {
                    method: t
                });
                var n = this.findDefined(this.customMessage(e.name, t.method), this.customDataMessage(e, t.method), !this.settings.ignoreTitle && e.title || void 0, d.validator.messages[t.method], "<strong>Warning: No message defined for " + e.name + "</strong>")
                  , i = /\$?\{(\d+)\}/g;
                return "function" == typeof n ? n = n.call(this, t.parameters, e) : i.test(n) && (n = d.validator.format(n.replace(i, "{$1}"), t.parameters)),
                n
            },
            formatAndAdd: function(e, t) {
                var n = this.defaultMessage(e, t);
                this.errorList.push({
                    message: n,
                    element: e,
                    method: t.method
                }),
                this.errorMap[e.name] = n,
                this.submitted[e.name] = n
            },
            addWrapper: function(e) {
                return this.settings.wrapper && (e = e.add(e.parent(this.settings.wrapper))),
                e
            },
            defaultShowErrors: function() {
                for (var e, t, n = 0; this.errorList[n]; n++)
                    t = this.errorList[n],
                    this.settings.highlight && this.settings.highlight.call(this, t.element, this.settings.errorClass, this.settings.validClass),
                    this.showLabel(t.element, t.message);
                if (this.errorList.length && (this.toShow = this.toShow.add(this.containers)),
                this.settings.success)
                    for (n = 0; this.successList[n]; n++)
                        this.showLabel(this.successList[n]);
                if (this.settings.unhighlight)
                    for (n = 0,
                    e = this.validElements(); e[n]; n++)
                        this.settings.unhighlight.call(this, e[n], this.settings.errorClass, this.settings.validClass);
                this.toHide = this.toHide.not(this.toShow),
                this.hideErrors(),
                this.addWrapper(this.toShow).show()
            },
            validElements: function() {
                return this.currentElements.not(this.invalidElements())
            },
            invalidElements: function() {
                return d(this.errorList).map(function() {
                    return this.element
                })
            },
            showLabel: function(e, t) {
                var n, i, a, o = this.errorsFor(e), r = this.idOrName(e), s = d(e).attr("aria-describedby");
                o.length ? (o.removeClass(this.settings.validClass).addClass(this.settings.errorClass),
                o.html(t)) : (n = o = d("<" + this.settings.errorElement + ">").attr("id", r + "-error").addClass(this.settings.errorClass).html(t || ""),
                this.settings.wrapper && (n = o.hide().show().wrap("<" + this.settings.wrapper + "/>").parent()),
                this.labelContainer.length ? this.labelContainer.append(n) : this.settings.errorPlacement ? this.settings.errorPlacement.call(this, n, d(e)) : n.insertAfter(e),
                o.is("label") ? o.attr("for", r) : 0 === o.parents("label[for='" + this.escapeCssMeta(r) + "']").length && (r = o.attr("id"),
                s ? s.match(new RegExp("\\b" + this.escapeCssMeta(r) + "\\b")) || (s += " " + r) : s = r,
                d(e).attr("aria-describedby", s),
                (i = this.groups[e.name]) && (a = this,
                d.each(a.groups, function(e, t) {
                    t === i && d("[name='" + a.escapeCssMeta(e) + "']", a.currentForm).attr("aria-describedby", o.attr("id"))
                })))),
                !t && this.settings.success && (o.text(""),
                "string" == typeof this.settings.success ? o.addClass(this.settings.success) : this.settings.success(o, e)),
                this.toShow = this.toShow.add(o)
            },
            errorsFor: function(e) {
                var t = this.escapeCssMeta(this.idOrName(e))
                  , e = d(e).attr("aria-describedby")
                  , t = "label[for='" + t + "'], label[for='" + t + "'] *";
                return e && (t = t + ", #" + this.escapeCssMeta(e).replace(/\s+/g, ", #")),
                this.errors().filter(t)
            },
            escapeCssMeta: function(e) {
                return e.replace(/([\\!"#$%&'()*+,./:;<=>?@\[\]^`{|}~])/g, "\\$1")
            },
            idOrName: function(e) {
                return this.groups[e.name] || !this.checkable(e) && e.id || e.name
            },
            validationTargetFor: function(e) {
                return this.checkable(e) && (e = this.findByName(e.name)),
                d(e).not(this.settings.ignore)[0]
            },
            checkable: function(e) {
                return /radio|checkbox/i.test(e.type)
            },
            findByName: function(e) {
                return d(this.currentForm).find("[name='" + this.escapeCssMeta(e) + "']")
            },
            getLength: function(e, t) {
                switch (t.nodeName.toLowerCase()) {
                case "select":
                    return d("option:selected", t).length;
                case "input":
                    if (this.checkable(t))
                        return this.findByName(t.name).filter(":checked").length
                }
                return e.length
            },
            depend: function(e, t) {
                return !this.dependTypes[typeof e] || this.dependTypes[typeof e](e, t)
            },
            dependTypes: {
                boolean: function(e) {
                    return e
                },
                string: function(e, t) {
                    return !!d(e, t.form).length
                },
                function: function(e, t) {
                    return e(t)
                }
            },
            optional: function(e) {
                var t = this.elementValue(e);
                return !d.validator.methods.required.call(this, t, e) && "dependency-mismatch"
            },
            startRequest: function(e) {
                this.pending[e.name] || (this.pendingRequest++,
                d(e).addClass(this.settings.pendingClass),
                this.pending[e.name] = !0)
            },
            stopRequest: function(e, t) {
                this.pendingRequest--,
                this.pendingRequest < 0 && (this.pendingRequest = 0),
                delete this.pending[e.name],
                d(e).removeClass(this.settings.pendingClass),
                t && 0 === this.pendingRequest && this.formSubmitted && this.form() ? (d(this.currentForm).submit(),
                this.submitButton && d("input:hidden[name='" + this.submitButton.name + "']", this.currentForm).remove(),
                this.formSubmitted = !1) : !t && 0 === this.pendingRequest && this.formSubmitted && (d(this.currentForm).triggerHandler("invalid-form", [this]),
                this.formSubmitted = !1)
            },
            previousValue: function(e, t) {
                return t = "string" == typeof t && t || "remote",
                d.data(e, "previousValue") || d.data(e, "previousValue", {
                    old: null,
                    valid: !0,
                    message: this.defaultMessage(e, {
                        method: t
                    })
                })
            },
            destroy: function() {
                this.resetForm(),
                d(this.currentForm).off(".validate").removeData("validator").find(".validate-equalTo-blur").off(".validate-equalTo").removeClass("validate-equalTo-blur")
            }
        },
        classRuleSettings: {
            required: {
                required: !0
            },
            email: {
                email: !0
            },
            url: {
                url: !0
            },
            date: {
                date: !0
            },
            dateISO: {
                dateISO: !0
            },
            number: {
                number: !0
            },
            digits: {
                digits: !0
            },
            creditcard: {
                creditcard: !0
            }
        },
        addClassRules: function(e, t) {
            e.constructor === String ? this.classRuleSettings[e] = t : d.extend(this.classRuleSettings, e)
        },
        classRules: function(e) {
            var t = {}
              , e = d(e).attr("class");
            return e && d.each(e.split(" "), function() {
                this in d.validator.classRuleSettings && d.extend(t, d.validator.classRuleSettings[this])
            }),
            t
        },
        normalizeAttributeRule: function(e, t, n, i) {
            /min|max|step/.test(n) && (null === t || /number|range|text/.test(t)) && (i = Number(i),
            isNaN(i) && (i = void 0)),
            i || 0 === i ? e[n] = i : t === n && "range" !== t && (e[n] = !0)
        },
        attributeRules: function(e) {
            var t, n, i = {}, a = d(e), o = e.getAttribute("type");
            for (t in d.validator.methods)
                n = "required" === t ? ("" === (n = e.getAttribute(t)) && (n = !0),
                !!n) : a.attr(t),
                this.normalizeAttributeRule(i, o, t, n);
            return i.maxlength && /-1|2147483647|524288/.test(i.maxlength) && delete i.maxlength,
            i
        },
        dataRules: function(e) {
            var t, n, i = {}, a = d(e), o = e.getAttribute("type");
            for (t in d.validator.methods)
                n = a.data("rule" + t.charAt(0).toUpperCase() + t.substring(1).toLowerCase()),
                this.normalizeAttributeRule(i, o, t, n);
            return i
        },
        staticRules: function(e) {
            var t = {}
              , n = d.data(e.form, "validator");
            return n.settings.rules && (t = d.validator.normalizeRule(n.settings.rules[e.name]) || {}),
            t
        },
        normalizeRules: function(i, a) {
            return d.each(i, function(e, t) {
                if (!1 !== t) {
                    if (t.param || t.depends) {
                        var n = !0;
                        switch (typeof t.depends) {
                        case "string":
                            n = !!d(t.depends, a.form).length;
                            break;
                        case "function":
                            n = t.depends.call(a, a)
                        }
                        n ? i[e] = void 0 === t.param || t.param : (d.data(a.form, "validator").resetElements(d(a)),
                        delete i[e])
                    }
                } else
                    delete i[e]
            }),
            d.each(i, function(e, t) {
                i[e] = d.isFunction(t) && "normalizer" !== e ? t(a) : t
            }),
            d.each(["minlength", "maxlength"], function() {
                i[this] && (i[this] = Number(i[this]))
            }),
            d.each(["rangelength", "range"], function() {
                var e;
                i[this] && (d.isArray(i[this]) ? i[this] = [Number(i[this][0]), Number(i[this][1])] : "string" == typeof i[this] && (e = i[this].replace(/[\[\]]/g, "").split(/[\s,]+/),
                i[this] = [Number(e[0]), Number(e[1])]))
            }),
            d.validator.autoCreateRanges && (null != i.min && null != i.max && (i.range = [i.min, i.max],
            delete i.min,
            delete i.max),
            null != i.minlength && null != i.maxlength && (i.rangelength = [i.minlength, i.maxlength],
            delete i.minlength,
            delete i.maxlength)),
            i
        },
        normalizeRule: function(e) {
            var t;
            return "string" == typeof e && (t = {},
            d.each(e.split(/\s/), function() {
                t[this] = !0
            }),
            e = t),
            e
        },
        addMethod: function(e, t, n) {
            d.validator.methods[e] = t,
            d.validator.messages[e] = void 0 !== n ? n : d.validator.messages[e],
            t.length < 3 && d.validator.addClassRules(e, d.validator.normalizeRule(e))
        },
        methods: {
            required: function(e, t, n) {
                if (!this.depend(n, t))
                    return "dependency-mismatch";
                if ("select" !== t.nodeName.toLowerCase())
                    return this.checkable(t) ? 0 < this.getLength(e, t) : 0 < e.length;
                t = d(t).val();
                return t && 0 < t.length
            },
            email: function(e, t) {
                return this.optional(t) || /^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/.test(e)
            },
            url: function(e, t) {
                return this.optional(t) || /^(?:(?:(?:https?|ftp):)?\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})).?)(?::\d{2,5})?(?:[/?#]\S*)?$/i.test(e)
            },
            date: function(e, t) {
                return this.optional(t) || !/Invalid|NaN/.test(new Date(e).toString())
            },
            dateISO: function(e, t) {
                return this.optional(t) || /^\d{4}[\/\-](0?[1-9]|1[012])[\/\-](0?[1-9]|[12][0-9]|3[01])$/.test(e)
            },
            number: function(e, t) {
                return this.optional(t) || /^(?:-?\d+|-?\d{1,3}(?:,\d{3})+)?(?:\.\d+)?$/.test(e)
            },
            digits: function(e, t) {
                return this.optional(t) || /^\d+$/.test(e)
            },
            minlength: function(e, t, n) {
                e = d.isArray(e) ? e.length : this.getLength(e, t);
                return this.optional(t) || n <= e
            },
            maxlength: function(e, t, n) {
                e = d.isArray(e) ? e.length : this.getLength(e, t);
                return this.optional(t) || e <= n
            },
            rangelength: function(e, t, n) {
                e = d.isArray(e) ? e.length : this.getLength(e, t);
                return this.optional(t) || e >= n[0] && e <= n[1]
            },
            min: function(e, t, n) {
                return this.optional(t) || n <= e
            },
            max: function(e, t, n) {
                return this.optional(t) || e <= n
            },
            range: function(e, t, n) {
                return this.optional(t) || e >= n[0] && e <= n[1]
            },
            step: function(e, t, n) {
                function i(e) {
                    return (e = ("" + e).match(/(?:\.(\d+))?$/)) && e[1] ? e[1].length : 0
                }
                function a(e) {
                    return Math.round(e * Math.pow(10, o))
                }
                var o, r = d(t).attr("type"), s = "Step attribute on input type " + r + " is not supported.", l = new RegExp("\\b" + r + "\\b"), c = !0;
                if (r && !l.test(["text", "number", "range"].join()))
                    throw new Error(s);
                return o = i(n),
                (i(e) > o || a(e) % a(n) != 0) && (c = !1),
                this.optional(t) || c
            },
            equalTo: function(e, t, n) {
                n = d(n);
                return this.settings.onfocusout && n.not(".validate-equalTo-blur").length && n.addClass("validate-equalTo-blur").on("blur.validate-equalTo", function() {
                    d(t).valid()
                }),
                e === n.val()
            },
            remote: function(i, a, e, o) {
                if (this.optional(a))
                    return "dependency-mismatch";
                o = "string" == typeof o && o || "remote";
                var r, t, s = this.previousValue(a, o);
                return this.settings.messages[a.name] || (this.settings.messages[a.name] = {}),
                s.originalMessage = s.originalMessage || this.settings.messages[a.name][o],
                this.settings.messages[a.name][o] = s.message,
                e = "string" == typeof e ? {
                    url: e
                } : e,
                t = d.param(d.extend({
                    data: i
                }, e.data)),
                s.old === t ? s.valid : (s.old = t,
                (r = this).startRequest(a),
                (t = {})[a.name] = i,
                d.ajax(d.extend(!0, {
                    mode: "abort",
                    port: "validate" + a.name,
                    dataType: "json",
                    data: t,
                    context: r.currentForm,
                    success: function(e) {
                        var t, n = !0 === e || "true" === e;
                        r.settings.messages[a.name][o] = s.originalMessage,
                        n ? (t = r.formSubmitted,
                        r.resetInternals(),
                        r.toHide = r.errorsFor(a),
                        r.formSubmitted = t,
                        r.successList.push(a),
                        r.invalid[a.name] = !1,
                        r.showErrors()) : (t = {},
                        e = e || r.defaultMessage(a, {
                            method: o,
                            parameters: i
                        }),
                        t[a.name] = s.message = e,
                        r.invalid[a.name] = !0,
                        r.showErrors(t)),
                        s.valid = n,
                        r.stopRequest(a, n)
                    }
                }, e)),
                "pending")
            }
        }
    });
    var i, a = {};
    return d.ajaxPrefilter ? d.ajaxPrefilter(function(e, t, n) {
        var i = e.port;
        "abort" === e.mode && (a[i] && a[i].abort(),
        a[i] = n)
    }) : (i = d.ajax,
    d.ajax = function(e) {
        var t = ("mode"in e ? e : d.ajaxSettings).mode
          , n = ("port"in e ? e : d.ajaxSettings).port;
        return "abort" === t ? (a[n] && a[n].abort(),
        a[n] = i.apply(this, arguments),
        a[n]) : i.apply(this, arguments)
    }
    ),
    d
}),
function(e) {
    "function" == typeof define && define.amd ? define("jquery.validate.unobtrusive", ["jquery-validation"], e) : "object" == typeof module && module.exports ? module.exports = e(require("jquery-validation")) : jQuery.validator.unobtrusive = e(jQuery)
}(function(l) {
    var e, r = l.validator, s = "unobtrusiveValidation";
    function c(e, t, n) {
        e.rules[t] = n,
        e.message && (e.messages[t] = e.message)
    }
    function d(e) {
        return e.replace(/([!"#$%&'()*+,./:;<=>?@\[\\\]^`{|}~])/g, "\\$1")
    }
    function n(e) {
        return e.substr(0, e.lastIndexOf(".") + 1)
    }
    function u(e, t) {
        return 0 === e.indexOf("*.") && (e = e.replace("*.", t)),
        e
    }
    function h(e) {
        var t = l(this)
          , n = "__jquery_unobtrusive_validation_form_reset";
        if (!t.data(n)) {
            t.data(n, !0);
            try {
                t.data("validator").resetForm()
            } finally {
                t.removeData(n)
            }
            t.find(".validation-summary-errors").addClass("validation-summary-valid").removeClass("validation-summary-errors"),
            t.find(".field-validation-error").addClass("field-validation-valid").removeClass("field-validation-error").removeData("unobtrusiveContainer").find(">*").removeData("unobtrusiveContainer")
        }
    }
    function f(n) {
        function e(e, t) {
            (e = o[e]) && l.isFunction(e) && e.apply(n, t)
        }
        var t = l(n)
          , i = t.data(s)
          , a = l.proxy(h, n)
          , o = r.unobtrusive.options || {};
        return i || (i = {
            options: {
                errorClass: o.errorClass || "input-validation-error",
                errorElement: o.errorElement || "span",
                errorPlacement: function() {
                    (function(e, t) {
                        var n = l(this).find("[data-valmsg-for='" + d(t[0].name) + "']")
                          , t = (t = n.attr("data-valmsg-replace")) ? !1 !== l.parseJSON(t) : null;
                        n.removeClass("field-validation-valid").addClass("field-validation-error"),
                        e.data("unobtrusiveContainer", n),
                        t ? (n.empty(),
                        e.removeClass("input-validation-error").appendTo(n)) : e.hide()
                    }
                    ).apply(n, arguments),
                    e("errorPlacement", arguments)
                },
                invalidHandler: function() {
                    (function(e, t) {
                        var n = l(this).find("[data-valmsg-summary=true]")
                          , i = n.find("ul");
                        i && i.length && t.errorList.length && (i.empty(),
                        n.addClass("validation-summary-errors").removeClass("validation-summary-valid"),
                        l.each(t.errorList, function() {
                            l("<li />").html(this.message).appendTo(i)
                        }))
                    }
                    ).apply(n, arguments),
                    e("invalidHandler", arguments)
                },
                messages: {},
                rules: {},
                success: function() {
                    (function(e) {
                        var t, n = e.data("unobtrusiveContainer");
                        n && (t = (t = n.attr("data-valmsg-replace")) ? l.parseJSON(t) : null,
                        n.addClass("field-validation-valid").removeClass("field-validation-error"),
                        e.removeData("unobtrusiveContainer"),
                        t && n.empty())
                    }
                    ).apply(n, arguments),
                    e("success", arguments)
                }
            },
            attachValidation: function() {
                t.off("reset." + s, a).on("reset." + s, a).validate(this.options)
            },
            validate: function() {
                return t.validate(),
                t.valid()
            }
        },
        t.data(s, i)),
        i
    }
    return r.unobtrusive = {
        adapters: [],
        parseElement: function(i, e) {
            var t, a, o, r = l(i), s = r.parents("form")[0];
            s && ((t = f(s)).options.rules[i.name] = a = {},
            t.options.messages[i.name] = o = {},
            l.each(this.adapters, function() {
                var e = "data-val-" + this.name
                  , t = r.attr(e)
                  , n = {};
                void 0 !== t && (e += "-",
                l.each(this.params, function() {
                    n[this] = r.attr(e + this)
                }),
                this.adapt({
                    element: i,
                    form: s,
                    message: t,
                    params: n,
                    rules: a,
                    messages: o
                }))
            }),
            l.extend(a, {
                __dummy__: !0
            }),
            e || t.attachValidation())
        },
        parse: function(e) {
            var t = l(e)
              , e = t.parents().addBack().filter("form").add(t.find("form")).has("[data-val=true]");
            t.find("[data-val=true]").each(function() {
                r.unobtrusive.parseElement(this, !0)
            }),
            e.each(function() {
                var e = f(this);
                e && e.attachValidation()
            })
        }
    },
    (e = r.unobtrusive.adapters).add = function(e, t, n) {
        return n || (n = t,
        t = []),
        this.push({
            name: e,
            params: t,
            adapt: n
        }),
        this
    }
    ,
    e.addBool = function(t, n) {
        return this.add(t, function(e) {
            c(e, n || t, !0)
        })
    }
    ,
    e.addMinMax = function(e, i, a, o, t, n) {
        return this.add(e, [t || "min", n || "max"], function(e) {
            var t = e.params.min
              , n = e.params.max;
            t && n ? c(e, o, [t, n]) : t ? c(e, i, t) : n && c(e, a, n)
        })
    }
    ,
    e.addSingleVal = function(t, n, i) {
        return this.add(t, [n || "val"], function(e) {
            c(e, i || t, e.params[n])
        })
    }
    ,
    r.addMethod("__dummy__", function(e, t, n) {
        return !0
    }),
    r.addMethod("regex", function(e, t, n) {
        return !!this.optional(t) || (n = new RegExp(n).exec(e)) && 0 === n.index && n[0].length === e.length
    }),
    r.addMethod("nonalphamin", function(e, t, n) {
        var i;
        return n && (i = (i = e.match(/\W/g)) && i.length >= n),
        i
    }),
    r.methods.extension ? (e.addSingleVal("accept", "mimtype"),
    e.addSingleVal("extension", "extension")) : e.addSingleVal("extension", "extension", "accept"),
    e.addSingleVal("regex", "pattern"),
    e.addBool("creditcard").addBool("date").addBool("digits").addBool("email").addBool("number").addBool("url"),
    e.addMinMax("length", "minlength", "maxlength", "rangelength").addMinMax("range", "min", "max", "range"),
    e.addMinMax("minlength", "minlength").addMinMax("maxlength", "minlength", "maxlength"),
    e.add("equalto", ["other"], function(e) {
        var t = n(e.element.name)
          , t = u(e.params.other, t);
        c(e, "equalTo", l(e.form).find(":input").filter("[name='" + d(t) + "']")[0])
    }),
    e.add("required", function(e) {
        "INPUT" === e.element.tagName.toUpperCase() && "CHECKBOX" === e.element.type.toUpperCase() || c(e, "required", !0)
    }),
    e.add("remote", ["url", "type", "additionalfields"], function(i) {
        var a = {
            url: i.params.url,
            type: i.params.type || "GET",
            data: {}
        }
          , o = n(i.element.name);
        l.each((i.params.additionalfields || i.element.name).replace(/^\s+|\s+$/g, "").split(/\s*,\s*/g), function(e, t) {
            var n = u(t, o);
            a.data[n] = function() {
                var e = l(i.form).find(":input").filter("[name='" + d(n) + "']");
                return e.is(":checkbox") ? e.filter(":checked").val() || e.filter(":hidden").val() || "" : e.is(":radio") ? e.filter(":checked").val() || "" : e.val()
            }
        }),
        c(i, "remote", a)
    }),
    e.add("password", ["min", "nonalphamin", "regex"], function(e) {
        e.params.min && c(e, "minlength", e.params.min),
        e.params.nonalphamin && c(e, "nonalphamin", e.params.nonalphamin),
        e.params.regex && c(e, "regex", e.params.regex)
    }),
    e.add("fileextensions", ["extensions"], function(e) {
        c(e, "extension", e.params.extensions)
    }),
    l(function() {
        r.unobtrusive.parse(document)
    }),
    r.unobtrusive
}),
function(u) {
    function a(e, t, n) {
        var i = [];
        return (e.reduction || e).filter(u.validity.settings.elementSupport).each(function() {
            t(this) ? i.push(this) : o(this, r(n, {
                field: s(this)
            }))
        }),
        e.reduction = u(i),
        e
    }
    function n() {
        u.validity.isValidating() && (u.validity.report.errors++,
        u.validity.report.valid = !1)
    }
    function o(e, t) {
        n(),
        u.validity.out.raise(u(e), t)
    }
    function h(e, t) {
        n(),
        u.validity.out.raiseAggregate(e, t)
    }
    function i(e) {
        var t = 0;
        return e.each(function() {
            var e = parseFloat(this.value);
            t += isNaN(e) ? 0 : e
        }),
        t
    }
    function r(e, t) {
        for (var n in t)
            t.hasOwnProperty(n) && (e = e.replace(RegExp("#\\{" + n + "\\}", "g"), t[n]));
        return l(e)
    }
    function s(e) {
        var t = (e = u(e)).prop("id")
          , n = u.validity.settings.defaultFieldName;
        if (e.prop("title").length)
            n = e.prop("title");
        else if (/^([A-Z0-9][a-z]*)+$/.test(t))
            n = t.replace(/([A-Z0-9])[a-z]*/g, " $&");
        else if (/^[a-z0-9]+(_[a-z0-9]+)*$/.test(t)) {
            for (e = t.split("_"),
            t = 0; t < e.length; ++t)
                e[t] = l(e[t]);
            n = e.join(" ")
        }
        return u.trim(n)
    }
    function l(e) {
        return e.substring ? e.substring(0, 1).toUpperCase() + e.substring(1, e.length) : e
    }
    var t;
    u.validity = {
        settings: u.extend({
            outputMode: "tooltip",
            scrollTo: !1,
            modalErrorsClickable: !0,
            defaultFieldName: "This field",
            elementSupport: ":text, :password, textarea, select, :radio, :checkbox, input[type='hidden'], input[type='tel'], input[type='email']",
            argToString: function(e) {
                return e.getDate ? [e.getMonth() + 1, e.getDate(), e.getFullYear()].join("/") : e + ""
            },
            debugPrivates: !1
        }, {}),
        patterns: {
            integer: /^\d+$/,
            date: /^((0?\d)|(1[012]))[\/-]([012]?\d|30|31)[\/-]\d{1,4}$/,
            email: /^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i,
            usd: /^\$?((\d{1,3}(,\d{3})*)|\d+)(\.(\d{2})?)?$/,
            url: /^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i,
            number: /^[+-]?(\d+(\.\d*)?|\.\d+)([Ee]-?\d+)?$/,
            zip: /^\d{5}(-\d{4})?$/,
            phone: /^[2-9]\d{2}-\d{3}-\d{4}$/,
            guid: /^(\{?([0-9a-fA-F]){8}-(([0-9a-fA-F]){4}-){3}([0-9a-fA-F]){12}\}?)$/,
            time12: /^((0?\d)|(1[012])):[0-5]\d?\s?[aApP]\.?[mM]\.?$/,
            time24: /^(20|21|22|23|[01]\d|\d)(([:][0-5]\d){1,2})$/,
            nonHtml: /^[^<>]*$/
        },
        messages: {
            require: "#{field} is required.",
            match: "#{field} is in an invalid format.",
            integer: "#{field} must be a positive, whole number.",
            date: "#{field} must be formatted as a date. (mm/dd/yyyy)",
            email: "#{field} must be formatted as an email.",
            usd: "#{field} must be formatted as a US Dollar amount.",
            url: "#{field} must be formatted as a URL.",
            number: "#{field} must be formatted as a number.",
            zip: "#{field} must be formatted as a zipcode ##### or #####-####.",
            phone: "#{field} must be formatted as a phone number ###-###-####.",
            guid: "#{field} must be formatted as a guid like {3F2504E0-4F89-11D3-9A0C-0305E82C3301}.",
            time24: "#{field} must be formatted as a 24 hour time: 23:00.",
            time12: "#{field} must be formatted as a 12 hour time: 12:00 AM/PM",
            lessThan: "#{field} must be less than #{max}.",
            lessThanOrEqualTo: "#{field} must be less than or equal to #{max}.",
            greaterThan: "#{field} must be greater than #{min}.",
            greaterThanOrEqualTo: "#{field} must be greater than or equal to #{min}.",
            range: "#{field} must be between #{min} and #{max}.",
            tooLong: "#{field} cannot be longer than #{max} characters.",
            tooShort: "#{field} cannot be shorter than #{min} characters.",
            nonHtml: "#{field} cannot contain HTML characters.",
            alphabet: "#{field} contains disallowed characters.",
            minCharClass: "#{field} cannot have more than #{min} #{charClass} characters.",
            maxCharClass: "#{field} cannot have less than #{min} #{charClass} characters.",
            equal: "Values don't match.",
            distinct: "A value was repeated.",
            sum: "Values don't add to #{sum}.",
            sumMax: "The sum of the values must be less than #{max}.",
            sumMin: "The sum of the values must be greater than #{min}.",
            radioChecked: "The selected value is not valid.",
            generic: "Invalid."
        },
        out: {
            start: function() {
                this.defer("start")
            },
            end: function(e) {
                this.defer("end", e)
            },
            raise: function(e, t) {
                this.defer("raise", e, t)
            },
            raiseAggregate: function(e, t) {
                this.defer("raiseAggregate", e, t)
            },
            defer: function(e) {
                var t = u.validity;
                (t = t.outputs[t.settings.outputMode])[e].apply(t, Array.prototype.slice.call(arguments, 1))
            }
        },
        charClasses: {
            alphabetical: /\w/g,
            numeric: /\d/g,
            alphanumeric: /[A-Za-z0-9]/g,
            symbol: /[^A-Za-z0-9]/g
        },
        outputs: {},
        __private: void 0,
        setup: function(e) {
            this.settings = u.extend(this.settings, e),
            this.__private = this.settings.debugPrivates ? t : void 0
        },
        report: null,
        isValidating: function() {
            return !!this.report
        },
        start: function() {
            this.out.start(),
            this.report = {
                errors: 0,
                valid: !0
            }
        },
        end: function() {
            var e = this.report || {
                errors: 0,
                valid: !0
            };
            return this.report = null,
            this.out.end(e),
            e
        },
        clear: function() {
            this.start(),
            this.end()
        }
    },
    u.fn.extend({
        validity: function(n) {
            return this.each(function() {
                var e, t = this;
                "form" == this.tagName.toLowerCase() && (e = null,
                "string" == typeof n ? e = function() {
                    u(n).require()
                }
                : u.isFunction(n) && (e = n),
                n && u(this).bind("submit", function() {
                    return u.validity.start(),
                    e.apply(t),
                    u.validity.end().valid
                }))
            })
        },
        require: function(e) {
            return a(this, function(e) {
                return u(e).val() && (null != u(e).val() && u(e).val().length)
            }, e || u.validity.messages.require)
        },
        match: function(t, e) {
            return e || (e = u.validity.messages.match,
            "string" == typeof t && u.validity.messages[t] && (e = u.validity.messages[t])),
            "string" == typeof t && (t = u.validity.patterns[t]),
            a(this, u.isFunction(t) ? function(e) {
                return !e.value.length || t(e.value)
            }
            : function(e) {
                return t.global && (t.lastIndex = 0),
                !e.value.length || t.test(e.value)
            }
            , e)
        },
        range: function(t, n, e) {
            return a(this, t.getTime && n.getTime ? function(e) {
                return (e = new Date(e.value)) >= new Date(t) && e <= new Date(n)
            }
            : t.substring && n.substring && Big ? function(e) {
                return (e = new Big(e.value)).greaterThanOrEqualTo(new Big(t)) && e.lessThanOrEqualTo(new Big(n))
            }
            : function(e) {
                return e = parseFloat(e.value),
                t <= e && e <= n
            }
            , e || r(u.validity.messages.range, {
                min: u.validity.settings.argToString(t),
                max: u.validity.settings.argToString(n)
            }))
        },
        greaterThan: function(t, e) {
            return a(this, t.getTime ? function(e) {
                return new Date(e.value) > t
            }
            : t.substring && Big ? function(e) {
                return new Big(e.value).greaterThan(new Big(t))
            }
            : function(e) {
                return parseFloat(e.value) > t
            }
            , e || r(u.validity.messages.greaterThan, {
                min: u.validity.settings.argToString(t)
            }))
        },
        greaterThanOrEqualTo: function(t, e) {
            return a(this, t.getTime ? function(e) {
                return new Date(e.value) >= t
            }
            : t.substring && Big ? function(e) {
                return new Big(e.value).greaterThanOrEqualTo(new Big(t))
            }
            : function(e) {
                return parseFloat(e.value) >= t
            }
            , e || r(u.validity.messages.greaterThanOrEqualTo, {
                min: u.validity.settings.argToString(t)
            }))
        },
        lessThan: function(t, e) {
            return a(this, t.getTime ? function(e) {
                return new Date(e.value) < t
            }
            : t.substring && Big ? function(e) {
                return new Big(e.value).lessThan(new Big(t))
            }
            : function(e) {
                return parseFloat(e.value) < t
            }
            , e || r(u.validity.messages.lessThan, {
                max: u.validity.settings.argToString(t)
            }))
        },
        lessThanOrEqualTo: function(t, e) {
            return a(this, t.getTime ? function(e) {
                return new Date(e.value) <= t
            }
            : t.substring && Big ? function(e) {
                return new Big(e.value).lessThanOrEqualTo(new Big(t))
            }
            : function(e) {
                return parseFloat(e.value) <= t
            }
            , e || r(u.validity.messages.lessThanOrEqualTo, {
                max: u.validity.settings.argToString(t)
            }))
        },
        maxLength: function(t, e) {
            return a(this, function(e) {
                return e.value.length <= t
            }, e || r(u.validity.messages.tooLong, {
                max: t
            }))
        },
        minLength: function(t, e) {
            return a(this, function(e) {
                return e.value.length >= t
            }, e || r(u.validity.messages.tooShort, {
                min: t
            }))
        },
        alphabet: function(n, e) {
            var i = [];
            return a(this, function(e) {
                for (var t = 0; t < e.value.length; ++t)
                    if (-1 == n.indexOf(e.value.charAt(t)))
                        return i.push(e.value.charAt(t)),
                        0;
                return 1
            }, e || r(u.validity.messages.alphabet, {
                chars: i.join(", ")
            }))
        },
        minCharClass: function(t, n, e) {
            return "string" == typeof t && (t = t.toLowerCase(),
            u.validity.charClasses[t] && (t = u.validity.charClasses[t])),
            a(this, function(e) {
                return (e.value.match(t) || []).length >= n
            }, e || r(u.validity.messages.minCharClass, {
                min: n,
                charClass: t
            }))
        },
        maxCharClass: function(t, n, e) {
            return "string" == typeof t && (t = t.toLowerCase(),
            u.validity.charClasses[t] && (t = u.validity.charClasses[t])),
            a(this, function(e) {
                return (e.value.match(t) || []).length <= n
            }, e || r(u.validity.messages.maxCharClass, {
                max: n,
                charClass: t
            }))
        },
        nonHtml: function(e) {
            return a(this, function(e) {
                return u.validity.patterns.nonHtml.test(e.value)
            }, e || u.validity.messages.nonHtml)
        },
        equal: function(e, t) {
            var n = (this.reduction || this).filter(u.validity.settings.elementSupport)
              , i = function(e) {
                return e
            }
              , a = u.validity.messages.equal;
            if (n.length) {
                u.isFunction(e) ? (i = e,
                "string" == typeof t && (a = t)) : "string" == typeof e && (a = e);
                var o, r = u.map(n, function(e) {
                    return i(e.value)
                }), s = r[0], l = !0;
                for (o in r)
                    r[o] != s && (l = !1);
                l || (h(n, a),
                this.reduction = u([]))
            }
            return this
        },
        distinct: function(e, t) {
            var n = (this.reduction || this).filter(u.validity.settings.elementSupport)
              , i = function(e) {
                return e
            }
              , a = u.validity.messages.distinct
              , o = []
              , r = []
              , s = !0;
            if (n.length) {
                u.isFunction(e) ? (i = e,
                "string" == typeof t && (a = t)) : "string" == typeof e && (a = e);
                for (var l = u.map(n, function(e) {
                    return i(e.value)
                }), c = 0; c < l.length; ++c)
                    if (l[c].length) {
                        for (var d = 0; d < o.length; ++d)
                            o[d] == l[c] && (s = !1,
                            r.push(l[c]));
                        o.push(l[c])
                    }
                if (!s) {
                    for (o = 0,
                    s = (r = u.unique(r)).length; o < s; ++o)
                        h(n.filter("[value='" + r[o] + "']"), a);
                    this.reduction = u([])
                }
            }
            return this
        },
        sum: function(e, t) {
            var n = (this.reduction || this).filter(u.validity.settings.elementSupport);
            return n.length && e != i(n) && (h(n, t || r(u.validity.messages.sum, {
                sum: e
            })),
            this.reduction = u([])),
            this
        },
        sumMax: function(e, t) {
            var n = (this.reduction || this).filter(u.validity.settings.elementSupport);
            return n.length && e < i(n) && (h(n, t || r(u.validity.messages.sumMax, {
                max: e
            })),
            this.reduction = u([])),
            this
        },
        sumMin: function(e, t) {
            var n = (this.reduction || this).filter(u.validity.settings.elementSupport);
            return n.length && e > i(n) && (h(n, t || r(u.validity.messages.sumMin, {
                min: e
            })),
            this.reduction = u([])),
            this
        },
        radioChecked: function(e, t) {
            var n = (this.reduction || this).filter(u.validity.settings.elementSupport);
            n.is(":radio") && n.find(":checked").val() != e && h(n, t || u.validity.messages.radioChecked)
        },
        radioNotChecked: function(e, t) {
            var n = (this.reduction || this).filter(u.validity.settings.elementSupport);
            n.is(":radio") && n.filter(":checked").val() == e && h(n, t || u.validity.messages.radioChecked)
        },
        checkboxChecked: function(e) {
            return a(this, function(e) {
                return !u(e).is(":checkbox") || u(e).is(":checked")
            }, e || u.validity.messages.nonHtml)
        },
        assert: function(e, t) {
            var n = this.reduction || this;
            if (n.length) {
                if (u.isFunction(e))
                    return a(this, e, t || u.validity.messages.generic);
                e || (h(n, t || u.validity.messages.generic),
                this.reduction = u([]))
            }
            return this
        },
        fail: function(e) {
            return this.assert(!1, e)
        }
    }),
    t = {
        validate: a,
        addToReport: n,
        raiseError: o,
        raiseAggregateError: h,
        numericSum: i,
        format: r,
        infer: s,
        capitalize: l
    }
}(jQuery),
function(a) {
    a.validity.outputs.tooltip = {
        tooltipClass: "validity-tooltip",
        start: function() {
            a("." + a.validity.outputs.tooltip.tooltipClass).remove()
        },
        end: function(e) {
            !e.valid && a.validity.settings.scrollTo && a(document).scrollTop(a("." + a.validity.outputs.tooltip.tooltipClass).offset().top)
        },
        raise: function(e, t) {
            var n = e.offset();
            n.left += e.width() + 18,
            n.top += 8;
            var i = a('<div class="validity-tooltip">' + t + '<div class="validity-tooltip-outer"><div class="validity-tooltip-inner"></div></div></div>').click(function() {
                e.focus(),
                a(this).fadeOut()
            }).css(n).hide().appendTo("body").fadeIn();
            a.validity.settings.fadeOutTooltipsOnFocus && e.on("focus", function() {
                i.fadeOut()
            })
        },
        raiseAggregate: function(e, t) {
            e.length && this.raise(e.filter(":last"), t)
        }
    }
}(jQuery),
function(i) {
    function a(e) {
        return e.attr("id").length ? e.attr("id") : e.attr("name")
    }
    i.validity.outputs.label = {
        cssClass: "error",
        start: function() {
            i("." + i.validity.outputs.label.cssClass).remove()
        },
        end: function(e) {
            !e.valid && i.validity.settings.scrollTo && (location.hash = i("." + i.validity.outputs.label.cssClass + ":eq(0)").attr("for"))
        },
        raise: function(e, t) {
            var n = "." + i.validity.outputs.label.cssClass + "[for='" + a(e) + "']";
            i(n).length ? i(n).text(t) : i("<label/>").attr("for", a(e)).addClass(i.validity.outputs.label.cssClass).text(t).click(function() {
                e.length && e[0].select()
            }).insertAfter(e)
        },
        raiseAggregate: function(e, t) {
            e.length && this.raise(i(e.get(e.length - 1)), t)
        }
    }
}(jQuery),
function(i) {
    i.validity.outputs.modal = {
        start: function() {
            i(".validity-modal-msg").remove()
        },
        end: function(e) {
            !e.valid && i.validity.settings.scrollTo && (location.hash = i(".validity-modal-msg:eq(0)").attr("id"))
        },
        raise: function(e, t) {
            var n;
            e.length && (n = e.offset(),
            e.get(0),
            n = {
                left: parseInt(n.left + e.width() + 4, 10) + "px",
                top: parseInt(n.top - 10, 10) + "px"
            },
            i("<div/>").addClass("validity-modal-msg").css(n).text(t).click(i.validity.settings.modalErrorsClickable ? function() {
                i(this).remove()
            }
            : null).appendTo("body"))
        },
        raiseAggregate: function(e, t) {
            e.length && this.raise(i(e.get(e.length - 1)), t)
        }
    }
}(jQuery),
function(t) {
    var n = [];
    t.validity.outputs.summary = {
        start: function() {
            t(".validity-erroneous").removeClass("validity-erroneous"),
            n = []
        },
        end: function() {
            if (t(".validity-summary-container").stop().hide().find("ul").html(""),
            n.length) {
                for (var e = 0; e < n.length; ++e)
                    t("<li/>").text(n[e]).appendTo(".validity-summary-container ul");
                t(".validity-summary-container").show(),
                t.validity.settings.scrollTo && (location.hash = t(".validity-erroneous:eq(0)").attr("id"))
            }
        },
        raise: function(e, t) {
            n.push(t),
            e.addClass("validity-erroneous")
        },
        raiseAggregate: function(e, t) {
            this.raise(e, t)
        },
        container: function() {
            document.write('<div class="validity-summary-container">The form didn\'t submit for the following reason(s):<ul></ul></div>')
        }
    }
}(jQuery),
function(o, r, n, s) {
    var l = o(r);
    o.fn.lazyload = function(e) {
        var i = this
          , a = {
            threshold: 0,
            failure_limit: 0,
            event: "scroll",
            effect: "show",
            container: r,
            data_attribute: "original",
            skip_invisible: !0,
            appear: null,
            load: null
        };
        function t() {
            var t = 0;
            i.each(function() {
                var e = o(this);
                if ((!a.skip_invisible || e.is(":visible")) && !o.abovethetop(this, a) && !o.leftofbegin(this, a))
                    if (o.belowthefold(this, a) || o.rightoffold(this, a)) {
                        if (++t > a.failure_limit)
                            return !1
                    } else
                        e.trigger("appear"),
                        t = 0
            })
        }
        return e && (s !== e.failurelimit && (e.failure_limit = e.failurelimit,
        delete e.failurelimit),
        s !== e.effectspeed && (e.effect_speed = e.effectspeed,
        delete e.effectspeed),
        o.extend(a, e)),
        e = a.container === s || a.container === r ? l : o(a.container),
        0 === a.event.indexOf("scroll") && e.bind(a.event, t),
        this.each(function() {
            var t = this
              , n = o(t);
            t.loaded = !1,
            n.one("appear", function() {
                var e;
                this.loaded || (a.appear && (e = i.length,
                a.appear.call(t, e, a)),
                o("<img />").bind("load", function() {
                    n.hide().attr("src", n.data(a.data_attribute))[a.effect](a.effect_speed),
                    t.loaded = !0;
                    var e = o.grep(i, function(e) {
                        return !e.loaded
                    });
                    i = o(e),
                    a.load && (e = i.length,
                    a.load.call(t, e, a))
                }).attr("src", n.data(a.data_attribute)))
            }),
            0 !== a.event.indexOf("scroll") && n.bind(a.event, function(e) {
                t.loaded || n.trigger("appear")
            })
        }),
        l.bind("resize", function(e) {
            t()
        }),
        /iphone|ipod|ipad.*os 5/gi.test(navigator.appVersion) && l.bind("pageshow", function(e) {
            e.originalEvent && e.originalEvent.persisted && i.each(function() {
                o(this).trigger("appear")
            })
        }),
        o(n).ready(function() {
            t()
        }),
        this
    }
    ,
    o.belowthefold = function(e, t) {
        var n = t.container === s || t.container === r ? l.height() + l.scrollTop() : o(t.container).offset().top + o(t.container).height();
        return n <= o(e).offset().top - t.threshold
    }
    ,
    o.rightoffold = function(e, t) {
        var n = t.container === s || t.container === r ? l.width() + l.scrollLeft() : o(t.container).offset().left + o(t.container).width();
        return n <= o(e).offset().left - t.threshold
    }
    ,
    o.abovethetop = function(e, t) {
        var n = t.container === s || t.container === r ? l.scrollTop() : o(t.container).offset().top;
        return n >= o(e).offset().top + t.threshold + o(e).height()
    }
    ,
    o.leftofbegin = function(e, t) {
        var n = t.container === s || t.container === r ? l.scrollLeft() : o(t.container).offset().left;
        return n >= o(e).offset().left + t.threshold + o(e).width()
    }
    ,
    o.inviewport = function(e, t) {
        return !(o.rightoffold(e, t) || o.leftofbegin(e, t) || o.belowthefold(e, t) || o.abovethetop(e, t))
    }
    ,
    o.extend(o.expr[":"], {
        "below-the-fold": function(e) {
            return o.belowthefold(e, {
                threshold: 0
            })
        },
        "above-the-top": function(e) {
            return !o.belowthefold(e, {
                threshold: 0
            })
        },
        "right-of-screen": function(e) {
            return o.rightoffold(e, {
                threshold: 0
            })
        },
        "left-of-screen": function(e) {
            return !o.rightoffold(e, {
                threshold: 0
            })
        },
        "in-viewport": function(e) {
            return o.inviewport(e, {
                threshold: 0
            })
        },
        "above-the-fold": function(e) {
            return !o.belowthefold(e, {
                threshold: 0
            })
        },
        "right-of-fold": function(e) {
            return o.rightoffold(e, {
                threshold: 0
            })
        },
        "left-of-fold": function(e) {
            return !o.rightoffold(e, {
                threshold: 0
            })
        }
    })
}(jQuery, window, document),
function(T) {
    T.extend({
        tablesorter: new function() {
            function w() {
                var e = arguments[0]
                  , t = 1 < arguments.length ? Array.prototype.slice.call(arguments) : e;
                "undefined" != typeof console && void 0 !== console.log ? console[/error/i.test(e) ? "error" : /warn/i.test(e) ? "warn" : "log"](t) : alert(t)
            }
            function C(e, t) {
                w(e + " (" + ((new Date).getTime() - t.getTime()) + "ms)")
            }
            function m(e) {
                for (var t in e)
                    return;
                return 1
            }
            function k(e, t, n) {
                if (!t)
                    return "";
                var i = e.config
                  , a = i.textExtraction || ""
                  , o = "basic" === a ? T(t).attr(i.textAttribute) || t.textContent || t.innerText || T(t).text() || "" : "function" == typeof a ? a(t, e, n) : "function" == typeof (a = j.getColumnData(e, a, n)) ? a(t, e, n) : t.textContent || t.innerText || T(t).text() || "";
                return T.trim(o)
            }
            function p(e) {
                var t, n, i, a, o, r, s, l, c, d, u, h = e.config, f = h.$tbodies = h.$table.children("tbody:not(." + h.cssInfoBlock + ")"), p = 0, g = "", m = f.length;
                if (0 === m)
                    return h.debug && w("Warning: *Empty table!* Not building a parser cache");
                for (h.debug && (u = new Date,
                w("Detecting parsers for each column")),
                t = [],
                n = []; p < m; ) {
                    if ((i = f[p].rows)[p])
                        for (a = h.columns,
                        o = 0; o < a; o++) {
                            if (r = h.$headers.filter('[data-column="' + o + '"]:last'),
                            s = j.getColumnData(e, h.headers, o),
                            d = j.getParserById(j.getData(r, s, "extractor")),
                            c = j.getParserById(j.getData(r, s, "sorter")),
                            l = "false" === j.getData(r, s, "parser"),
                            h.empties[o] = (j.getData(r, s, "empty") || h.emptyTo || (h.emptyToBottom ? "bottom" : "top")).toLowerCase(),
                            h.strings[o] = (j.getData(r, s, "string") || h.stringTo || "max").toLowerCase(),
                            l && (c = j.getParserById("no-parser")),
                            d = d || !1,
                            !c)
                                e: {
                                    r = e,
                                    s = i,
                                    l = -1,
                                    c = o;
                                    for (var v = void 0, b = j.parsers.length, y = !1, S = "", v = !0; "" === S && v; )
                                        s[++l] ? (S = k(r, y = s[l].cells[c], c),
                                        r.config.debug && w("Checking if value was empty on row " + l + ", column: " + c + ': "' + S + '"')) : v = !1;
                                    for (; 0 <= --b; )
                                        if ((v = j.parsers[b]) && "text" !== v.id && v.is && v.is(S, r, y)) {
                                            c = v;
                                            break e
                                        }
                                    c = j.getParserById("text")
                                }
                            h.debug && (g += "column:" + o + "; extractor:" + d.id + "; parser:" + c.id + "; string:" + h.strings[o] + "; empty: " + h.empties[o] + "\n"),
                            n[o] = c,
                            t[o] = d
                        }
                    p += n.length ? m : 1
                }
                h.debug && (w(g || "No parsers detected"),
                C("Completed detecting parsers", u)),
                h.parsers = n,
                h.extractors = t
            }
            function g(e) {
                var t, n, i, a, o, r, s, l, c, d, u, h = e.config, f = h.$table.children("tbody"), p = h.extractors, g = h.parsers;
                if (h.cache = {},
                h.totalRows = 0,
                !g)
                    return h.debug && w("Warning: *Empty table!* Not building a cache");
                for (h.debug && (l = new Date),
                h.showProcessing && j.isProcessing(e, !0),
                o = 0; o < f.length; o++)
                    if (u = [],
                    t = h.cache[o] = {
                        normalized: []
                    },
                    !f.eq(o).hasClass(h.cssInfoBlock)) {
                        for (c = f[o] && f[o].rows.length || 0,
                        i = 0; i < c; ++i)
                            if (d = {
                                child: []
                            },
                            s = [],
                            (r = T(f[o].rows[i])).hasClass(h.cssChildRow) && 0 !== i)
                                n = t.normalized.length - 1,
                                t.normalized[n][h.columns].$row = t.normalized[n][h.columns].$row.add(r),
                                r.prev().hasClass(h.cssChildRow) || r.prev().addClass(j.css.cssHasChild),
                                d.child[n] = T.trim(r[0].textContent || r[0].innerText || r.text() || "");
                            else {
                                for (d.$row = r,
                                d.order = i,
                                a = 0; a < h.columns; ++a)
                                    void 0 === g[a] ? h.debug && w("No parser found for cell:", r[0].cells[a], "does it have a header?") : (n = k(e, r[0].cells[a], a),
                                    n = void 0 === p[a].id ? n : p[a].format(n, e, r[0].cells[a], a),
                                    n = "no-parser" === g[a].id ? "" : g[a].format(n, e, r[0].cells[a], a),
                                    s.push(h.ignoreCase && "string" == typeof n ? n.toLowerCase() : n),
                                    "numeric" === (g[a].type || "").toLowerCase() && (u[a] = Math.max(Math.abs(n) || 0, u[a] || 0)));
                                s[h.columns] = d,
                                t.normalized.push(s)
                            }
                        t.colMax = u,
                        h.totalRows += t.normalized.length
                    }
                h.showProcessing && j.isProcessing(e),
                h.debug && C("Building cache for " + c + " rows", l)
            }
            function v(e, t) {
                var n, i, a, o, r, s, l = e.config, c = l.widgetOptions, d = e.tBodies, u = [], h = l.cache;
                if (m(h))
                    return l.appender ? l.appender(e, u) : e.isUpdating && l.$table.trigger("updateComplete", e);
                for (l.debug && (s = new Date),
                r = 0; r < d.length; r++)
                    if ((n = T(d[r])).length && !n.hasClass(l.cssInfoBlock)) {
                        for (a = j.processTbody(e, n, !0),
                        i = (n = h[r].normalized).length,
                        o = 0; o < i; o++)
                            u.push(n[o][l.columns].$row),
                            l.appender && (!l.pager || l.pager.removeRows && c.pager_removeRows || l.pager.ajax) || a.append(n[o][l.columns].$row);
                        j.processTbody(e, a, !1)
                    }
                l.appender && l.appender(e, u),
                l.debug && C("Rebuilt table", s),
                t || l.appender || j.applyWidget(e),
                e.isUpdating && l.$table.trigger("updateComplete", e)
            }
            function l(e) {
                return /^d/i.test(e) || 1 === e
            }
            function c(t) {
                var n, i, a, o, r, e, s = t.config;
                s.headerList = [],
                s.headerContent = [],
                s.debug && (e = new Date),
                s.columns = j.computeColumnIndex(s.$table.children("thead, tfoot").children("tr")),
                a = s.cssIcon ? '<i class="' + (s.cssIcon === j.css.icon ? j.css.icon : s.cssIcon + " " + j.css.icon) + '"></i>' : "",
                s.$headers = T(t).find(s.selectorHeaders).each(function(e) {
                    n = T(this),
                    r = j.getColumnData(t, s.headers, e, !0),
                    s.headerContent[e] = T(this).html(),
                    "" !== s.headerTemplate && (o = s.headerTemplate.replace(/\{content\}/g, T(this).html()).replace(/\{icon\}/g, a),
                    s.onRenderTemplate && (i = s.onRenderTemplate.apply(n, [e, o])) && "string" == typeof i && (o = i),
                    T(this).html('<div class="' + j.css.headerIn + '">' + o + "</div>")),
                    s.onRenderHeader && s.onRenderHeader.apply(n, [e]),
                    this.column = parseInt(T(this).attr("data-column"), 10),
                    this.order = l(j.getData(n, r, "sortInitialOrder") || s.sortInitialOrder) ? [1, 0, 2] : [0, 1, 2],
                    this.count = -1,
                    this.lockedOrder = !1,
                    void 0 !== (r = j.getData(n, r, "lockedOrder") || !1) && !1 !== r && (this.order = this.lockedOrder = l(r) ? [1, 1, 1] : [0, 0, 0]),
                    n.addClass(j.css.header + " " + s.cssHeader),
                    s.headerList[e] = this,
                    n.parent().addClass(j.css.headerRow + " " + s.cssHeaderRow).attr("role", "row"),
                    s.tabIndex && n.attr("tabindex", 0)
                }).attr({
                    scope: "col",
                    role: "columnheader"
                }),
                y(t),
                s.debug && (C("Built headers:", e),
                w(s.$headers))
            }
            function b(e, t, n) {
                var i = e.config;
                i.$table.find(i.selectorRemove).remove(),
                p(e),
                g(e),
                M(i.$table, t, n)
            }
            function y(n) {
                var i, a, o = n.config;
                o.$headers.each(function(e, t) {
                    i = T(t),
                    a = j.getColumnData(n, o.headers, e, !0),
                    a = "false" === j.getData(t, a, "sorter") || "false" === j.getData(t, a, "parser"),
                    t.sortDisabled = a,
                    i[a ? "addClass" : "removeClass"]("sorter-false").attr("aria-disabled", "" + a),
                    n.id && (a ? i.removeAttr("aria-controls") : i.attr("aria-controls", n.id))
                })
            }
            function S(e) {
                var t, n, i = e.config, a = i.sortList, o = a.length, r = j.css.sortNone + " " + i.cssNone, s = [j.css.sortAsc + " " + i.cssAsc, j.css.sortDesc + " " + i.cssDesc], l = ["ascending", "descending"], c = T(e).find("tfoot tr").children().add(i.$extraHeaders).removeClass(s.join(" "));
                for (i.$headers.removeClass(s.join(" ")).addClass(r).attr("aria-sort", "none"),
                t = 0; t < o; t++)
                    if (2 !== a[t][1] && (e = i.$headers.not(".sorter-false").filter('[data-column="' + a[t][0] + '"]' + (1 === o ? ":last" : ""))).length) {
                        for (n = 0; n < e.length; n++)
                            e[n].sortDisabled || e.eq(n).removeClass(r).addClass(s[a[t][1]]).attr("aria-sort", l[a[t][1]]);
                        c.length && c.filter('[data-column="' + a[t][0] + '"]').removeClass(r).addClass(s[a[t][1]])
                    }
                i.$headers.not(".sorter-false").each(function() {
                    var e = T(this)
                      , t = this.order[(this.count + 1) % (i.sortReset ? 3 : 2)]
                      , t = e.text() + ": " + j.language[e.hasClass(j.css.sortAsc) ? "sortAsc" : e.hasClass(j.css.sortDesc) ? "sortDesc" : "sortNone"] + j.language[0 === t ? "nextAsc" : 1 === t ? "nextDesc" : "nextNone"];
                    e.attr("aria-label", t)
                })
            }
            function x(a) {
                var o, e, r, t, s, l, c, d, u, h = a.config, f = h.textSorter || "", p = h.sortList, g = p.length, n = a.tBodies.length;
                if (!h.serverSideSorting && !m(h.cache)) {
                    for (h.debug && (t = new Date),
                    e = 0; e < n; e++)
                        s = h.cache[e].colMax,
                        h.cache[e].normalized.sort(function(e, t) {
                            for (o = 0; o < g && (r = p[o][0],
                            l = p[o][1],
                            u = 0 === l,
                            !h.sortStable || e[r] !== t[r] || 1 !== g); o++)
                                if (d = /n/i.test((n = h.parsers,
                                i = r,
                                n && n[i] && n[i].type || "")) && h.strings[r] ? (c = "boolean" == typeof h.string[h.strings[r]] ? (u ? 1 : -1) * (h.string[h.strings[r]] ? -1 : 1) : h.strings[r] && h.string[h.strings[r]] || 0,
                                h.numberSorter ? h.numberSorter(e[r], t[r], u, s[r], a) : j["sortNumeric" + (u ? "Asc" : "Desc")](e[r], t[r], c, s[r], r, a)) : (c = u ? e : t,
                                d = u ? t : e,
                                "function" == typeof f ? f(c[r], d[r], u, r, a) : "object" == typeof f && f.hasOwnProperty(r) ? f[r](c[r], d[r], u, r, a) : j["sortNatural" + (u ? "Asc" : "Desc")](e[r], t[r], r, a, h)))
                                    return d;
                            var n, i;
                            return e[h.columns].order - t[h.columns].order
                        });
                    h.debug && C("Sorting on " + p.toString() + " and dir " + l + " time", t)
                }
            }
            function a(e, t) {
                var n = e[0];
                n.isUpdating && e.trigger("updateComplete", n),
                T.isFunction(t) && t(e[0])
            }
            function M(e, t, n) {
                var i = e[0].config.sortList;
                !1 !== t && !e[0].isProcessing && i.length ? e.trigger("sorton", [i, function() {
                    a(e, n)
                }
                , !0]) : (a(e, n),
                j.applyWidget(e[0], !1))
            }
            function d(u) {
                var h = u.config
                  , f = h.$table;
                f.unbind("sortReset update updateRows updateCell updateAll addRows updateComplete sorton appendCache updateCache applyWidgetId applyWidgets refreshWidgets destroy mouseup mouseleave ".split(" ").join(h.namespace + " ")).bind("sortReset" + h.namespace, function(e, t) {
                    e.stopPropagation(),
                    h.sortList = [],
                    S(u),
                    x(u),
                    v(u),
                    T.isFunction(t) && t(u)
                }).bind("updateAll" + h.namespace, function(e, t, n) {
                    e.stopPropagation(),
                    u.isUpdating = !0,
                    j.refreshWidgets(u, !0, !0),
                    j.restoreHeaders(u),
                    c(u),
                    j.bindEvents(u, h.$headers, !0),
                    d(u),
                    b(u, t, n)
                }).bind("update" + h.namespace + " updateRows" + h.namespace, function(e, t, n) {
                    e.stopPropagation(),
                    u.isUpdating = !0,
                    y(u),
                    b(u, t, n)
                }).bind("updateCell" + h.namespace, function(e, t, n, i) {
                    var a, o, r;
                    e.stopPropagation(),
                    u.isUpdating = !0,
                    f.find(h.selectorRemove).remove(),
                    o = f.find("tbody"),
                    r = T(t),
                    e = o.index(T.fn.closest ? r.closest("tbody") : r.parents("tbody").filter(":first")),
                    a = T.fn.closest ? r.closest("tr") : r.parents("tr").filter(":first"),
                    t = r[0],
                    o.length && 0 <= e && (o = o.eq(e).find("tr").index(a),
                    r = r.index(),
                    h.cache[e].normalized[o][h.columns].$row = a,
                    a = void 0 === h.extractors[r].id ? k(u, t, r) : h.extractors[r].format(k(u, t, r), u, t, r),
                    t = "no-parser" === h.parsers[r].id ? "" : h.parsers[r].format(a, u, t, r),
                    h.cache[e].normalized[o][r] = h.ignoreCase && "string" == typeof t ? t.toLowerCase() : t,
                    "numeric" === (h.parsers[r].type || "").toLowerCase() && (h.cache[e].colMax[r] = Math.max(Math.abs(t) || 0, h.cache[e].colMax[r] || 0)),
                    M(f, n, i))
                }).bind("addRows" + h.namespace, function(e, t, n, i) {
                    if (e.stopPropagation(),
                    u.isUpdating = !0,
                    m(h.cache))
                        y(u),
                        b(u, n, i);
                    else {
                        var a, o, r, s, l, c = (t = T(t).attr("role", "row")).filter("tr").length, d = f.find("tbody").index(t.parents("tbody").filter(":first"));
                        for (h.parsers && h.parsers.length || p(u),
                        e = 0; e < c; e++) {
                            for (o = t[e].cells.length,
                            l = [],
                            s = {
                                child: [],
                                $row: t.eq(e),
                                order: h.cache[d].normalized.length
                            },
                            a = 0; a < o; a++)
                                r = void 0 === h.extractors[a].id ? k(u, t[e].cells[a], a) : h.extractors[a].format(k(u, t[e].cells[a], a), u, t[e].cells[a], a),
                                r = "no-parser" === h.parsers[a].id ? "" : h.parsers[a].format(r, u, t[e].cells[a], a),
                                l[a] = h.ignoreCase && "string" == typeof r ? r.toLowerCase() : r,
                                "numeric" === (h.parsers[a].type || "").toLowerCase() && (h.cache[d].colMax[a] = Math.max(Math.abs(l[a]) || 0, h.cache[d].colMax[a] || 0));
                            l.push(s),
                            h.cache[d].normalized.push(l)
                        }
                        M(f, n, i)
                    }
                }).bind("updateComplete" + h.namespace, function() {
                    u.isUpdating = !1
                }).bind("sorton" + h.namespace, function(e, t, n, i) {
                    var a, o, r, s, l, c, d = u.config;
                    e.stopPropagation(),
                    f.trigger("sortStart", this),
                    t = t,
                    c = u.config,
                    t = t || c.sortList,
                    c.sortList = [],
                    T.each(t, function(e, t) {
                        if (s = parseInt(t[0], 10),
                        r = c.$headers.filter('[data-column="' + s + '"]:last')[0]) {
                            switch (o = (o = ("" + t[1]).match(/^(1|d|s|o|n)/)) ? o[0] : "") {
                            case "1":
                            case "d":
                                o = 1;
                                break;
                            case "s":
                                o = l || 0;
                                break;
                            case "o":
                                a = r.order[(l || 0) % (c.sortReset ? 3 : 2)],
                                o = 0 === a ? 1 : 1 === a ? 0 : 2;
                                break;
                            case "n":
                                r.count += 1,
                                o = r.order[r.count % (c.sortReset ? 3 : 2)];
                                break;
                            default:
                                o = 0
                            }
                            l = 0 === e ? o : l,
                            a = [s, parseInt(o, 10) || 0],
                            c.sortList.push(a),
                            o = T.inArray(a[1], r.order),
                            r.count = 0 <= o ? o : a[1] % (c.sortReset ? 3 : 2)
                        }
                    }),
                    S(u),
                    d.delayInit && m(d.cache) && g(u),
                    f.trigger("sortBegin", this),
                    x(u),
                    v(u, i),
                    f.trigger("sortEnd", this),
                    j.applyWidget(u),
                    T.isFunction(n) && n(u)
                }).bind("appendCache" + h.namespace, function(e, t, n) {
                    e.stopPropagation(),
                    v(u, n),
                    T.isFunction(t) && t(u)
                }).bind("updateCache" + h.namespace, function(e, t) {
                    h.parsers && h.parsers.length || p(u),
                    g(u),
                    T.isFunction(t) && t(u)
                }).bind("applyWidgetId" + h.namespace, function(e, t) {
                    e.stopPropagation(),
                    j.getWidgetById(t).format(u, h, h.widgetOptions)
                }).bind("applyWidgets" + h.namespace, function(e, t) {
                    e.stopPropagation(),
                    j.applyWidget(u, t)
                }).bind("refreshWidgets" + h.namespace, function(e, t, n) {
                    e.stopPropagation(),
                    j.refreshWidgets(u, t, n)
                }).bind("destroy" + h.namespace, function(e, t, n) {
                    e.stopPropagation(),
                    j.destroy(u, t, n)
                }).bind("resetToLoadState" + h.namespace, function() {
                    j.refreshWidgets(u, !0, !0),
                    h = T.extend(!0, j.defaults, h.originalSettings),
                    u.hasInitialized = !1,
                    j.setup(u, h)
                })
            }
            var j = this;
            j.version = "2.17.8",
            j.parsers = [],
            j.widgets = [],
            j.defaults = {
                theme: "default",
                widthFixed: !1,
                showProcessing: !1,
                headerTemplate: "{content}",
                onRenderTemplate: null,
                onRenderHeader: null,
                cancelSelection: !0,
                tabIndex: !0,
                dateFormat: "mmddyyyy",
                sortMultiSortKey: "shiftKey",
                sortResetKey: "ctrlKey",
                usNumberFormat: !0,
                delayInit: !1,
                serverSideSorting: !1,
                headers: {},
                ignoreCase: !0,
                sortForce: null,
                sortList: [],
                sortAppend: null,
                sortStable: !1,
                sortInitialOrder: "asc",
                sortLocaleCompare: !1,
                sortReset: !1,
                sortRestart: !1,
                emptyTo: "bottom",
                stringTo: "max",
                textExtraction: "basic",
                textAttribute: "data-text",
                textSorter: null,
                numberSorter: null,
                widgets: [],
                widgetOptions: {
                    zebra: ["even", "odd"]
                },
                initWidgets: !0,
                initialized: null,
                tableClass: "",
                cssAsc: "",
                cssDesc: "",
                cssNone: "",
                cssHeader: "",
                cssHeaderRow: "",
                cssProcessing: "",
                cssChildRow: "tablesorter-childRow",
                cssIcon: "tablesorter-icon",
                cssInfoBlock: "tablesorter-infoOnly",
                selectorHeaders: "> thead th, > thead td",
                selectorSort: "th, td",
                selectorRemove: ".remove-me",
                debug: !1,
                headerList: [],
                empties: {},
                strings: {},
                parsers: []
            },
            j.css = {
                table: "tablesorter",
                cssHasChild: "tablesorter-hasChildRow",
                childRow: "tablesorter-childRow",
                header: "tablesorter-header",
                headerRow: "tablesorter-headerRow",
                headerIn: "tablesorter-header-inner",
                icon: "tablesorter-icon",
                info: "tablesorter-infoOnly",
                processing: "tablesorter-processing",
                sortAsc: "tablesorter-headerAsc",
                sortDesc: "tablesorter-headerDesc",
                sortNone: "tablesorter-headerUnSorted"
            },
            j.language = {
                sortAsc: "Ascending sort applied, ",
                sortDesc: "Descending sort applied, ",
                sortNone: "No sort applied, ",
                nextAsc: "activate to apply an ascending sort",
                nextDesc: "activate to apply a descending sort",
                nextNone: "activate to remove the sort"
            },
            j.log = w,
            j.benchmark = C,
            j.construct = function(t) {
                return this.each(function() {
                    var e = T.extend(!0, {}, j.defaults, t);
                    e.originalSettings = t,
                    !this.hasInitialized && j.buildTable && "TABLE" !== this.tagName ? j.buildTable(this, e) : j.setup(this, e)
                })
            }
            ,
            j.setup = function(t, n) {
                if (!t || !t.tHead || 0 === t.tBodies.length || !0 === t.hasInitialized)
                    return n.debug ? w("ERROR: stopping initialization! No table, thead, tbody or tablesorter has already been initialized") : "";
                var e, i, a, o = "", r = T(t), s = T.metadata;
                t.hasInitialized = !1,
                t.isProcessing = !0,
                t.config = n,
                T.data(t, "tablesorter", n),
                n.debug && T.data(t, "startoveralltimer", new Date),
                n.supportsDataObject = ((e = T.fn.jquery.split("."))[0] = parseInt(e[0], 10),
                1 < e[0] || 1 === e[0] && 4 <= parseInt(e[1], 10)),
                n.string = {
                    max: 1,
                    min: -1,
                    emptymin: 1,
                    emptymax: -1,
                    zero: 0,
                    none: 0,
                    null: 0,
                    top: !0,
                    bottom: !1
                },
                n.emptyTo = n.emptyTo.toLowerCase(),
                n.stringTo = n.stringTo.toLowerCase(),
                /tablesorter\-/.test(r.attr("class")) || (o = "" !== n.theme ? " tablesorter-" + n.theme : ""),
                n.table = t,
                n.$table = r.addClass(j.css.table + " " + n.tableClass + o).attr("role", "grid"),
                n.$headers = r.find(n.selectorHeaders),
                n.namespace = n.namespace ? "." + n.namespace.replace(/\W/g, "") : ".tablesorter" + Math.random().toString(16).slice(2),
                n.$table.children().children("tr").attr("role", "row"),
                n.$tbodies = r.children("tbody:not(." + n.cssInfoBlock + ")").attr({
                    "aria-live": "polite",
                    "aria-relevant": "all"
                }),
                n.$table.find("caption").length && n.$table.attr("aria-labelledby", "theCaption"),
                n.widgetInit = {},
                n.textExtraction = n.$table.attr("data-text-extraction") || n.textExtraction || "basic",
                c(t),
                (o = (e = t).config).widthFixed && 0 === o.$table.find("colgroup").length && (i = T("<colgroup>"),
                a = T(e).width(),
                T(e.tBodies).not("." + o.cssInfoBlock).find("tr:first").children(":visible").each(function() {
                    i.append(T("<col>").css("width", parseInt(T(this).width() / a * 1e3, 10) / 10 + "%"))
                }),
                o.$table.prepend(i)),
                p(t),
                n.totalRows = 0,
                n.delayInit || g(t),
                j.bindEvents(t, n.$headers, !0),
                d(t),
                n.supportsDataObject && void 0 !== r.data().sortlist ? n.sortList = r.data().sortlist : s && r.metadata() && r.metadata().sortlist && (n.sortList = r.metadata().sortlist),
                j.applyWidget(t, !0),
                0 < n.sortList.length ? r.trigger("sorton", [n.sortList, {}, !n.initWidgets, !0]) : (S(t),
                n.initWidgets && j.applyWidget(t, !1)),
                n.showProcessing && r.unbind("sortBegin" + n.namespace + " sortEnd" + n.namespace).bind("sortBegin" + n.namespace + " sortEnd" + n.namespace, function(e) {
                    clearTimeout(n.processTimer),
                    j.isProcessing(t),
                    "sortBegin" === e.type && (n.processTimer = setTimeout(function() {
                        j.isProcessing(t, !0)
                    }, 500))
                }),
                t.hasInitialized = !0,
                t.isProcessing = !1,
                n.debug && j.benchmark("Overall initialization time", T.data(t, "startoveralltimer")),
                r.trigger("tablesorter-initialized", t),
                "function" == typeof n.initialized && n.initialized(t)
            }
            ,
            j.getColumnData = function(e, t, n, i) {
                if (null != t) {
                    var a, o = (e = T(e)[0]).config;
                    if (t[n])
                        return i ? t[n] : t[o.$headers.index(o.$headers.filter('[data-column="' + n + '"]:last'))];
                    for (a in t)
                        if ("string" == typeof a && (e = (i ? o.$headers.eq(n) : o.$headers.filter('[data-column="' + n + '"]:last')).filter(a),
                        e.length))
                            return t[a]
                }
            }
            ,
            j.computeColumnIndex = function(e) {
                for (var t, n, i, a, o, r, s, l, c, d = [], u = 0, h = 0; h < e.length; h++)
                    for (a = e[h].cells,
                    t = 0; t < a.length; t++) {
                        for (n = a[t],
                        i = T(n),
                        o = n.parentNode.rowIndex,
                        i.index(),
                        r = n.rowSpan || 1,
                        s = n.colSpan || 1,
                        void 0 === d[o] && (d[o] = []),
                        n = 0; n < d[o].length + 1; n++)
                            if (void 0 === d[o][n]) {
                                l = n;
                                break
                            }
                        for (u = Math.max(l, u),
                        i.attr({
                            "data-column": l
                        }),
                        n = o; n < o + r; n++)
                            for (void 0 === d[n] && (d[n] = []),
                            c = d[n],
                            i = l; i < l + s; i++)
                                c[i] = "x"
                    }
                return u + 1
            }
            ,
            j.isProcessing = function(e, t, n) {
                var i = (e = T(e))[0].config
                  , a = n || e.find("." + j.css.header);
                t ? (void 0 !== n && 0 < i.sortList.length && (a = a.filter(function() {
                    return !this.sortDisabled && 0 <= j.isValueInArray(parseFloat(T(this).attr("data-column")), i.sortList)
                })),
                e.add(a).addClass(j.css.processing + " " + i.cssProcessing)) : e.add(a).removeClass(j.css.processing + " " + i.cssProcessing)
            }
            ,
            j.processTbody = function(e, t, n) {
                if (e = T(e)[0],
                n)
                    return e.isProcessing = !0,
                    t.before('<span class="tablesorter-savemyplace"/>'),
                    T.fn.detach ? t.detach() : t.remove();
                n = T(e).find("span.tablesorter-savemyplace"),
                t.insertAfter(n),
                n.remove(),
                e.isProcessing = !1
            }
            ,
            j.clearTableBody = function(e) {
                T(e)[0].config.$tbodies.children().detach()
            }
            ,
            j.bindEvents = function(i, a, e) {
                var o, r = (i = T(i)[0]).config;
                !0 !== e && (r.$extraHeaders = r.$extraHeaders ? r.$extraHeaders.add(a) : a),
                a.find(r.selectorSort).add(a.filter(r.selectorSort)).unbind(["mousedown", "mouseup", "sort", "keyup", ""].join(r.namespace + " ")).bind(["mousedown", "mouseup", "sort", "keyup", ""].join(r.namespace + " "), function(e, t) {
                    var n = e.type;
                    if (!(1 !== (e.which || e.button) && !/sort|keyup/.test(n) || "keyup" === n && 13 !== e.which || "mouseup" === n && !0 !== t && 250 < (new Date).getTime() - o)) {
                        if ("mousedown" === n)
                            return o = (new Date).getTime(),
                            /(input|select|button|textarea)/i.test(e.target.tagName) ? "" : !r.cancelSelection;
                        r.delayInit && m(r.cache) && g(i),
                        n = T.fn.closest ? T(this).closest("th, td")[0] : /TH|TD/.test(this.tagName) ? this : T(this).parents("th, td")[0],
                        (n = r.$headers[a.index(n)]).sortDisabled || function e(t, n, i) {
                            if (t.isUpdating)
                                return setTimeout(function() {
                                    e(t, n, i)
                                }, 50);
                            var a, o, r, s, l = t.config, c = !i[l.sortMultiSortKey], d = l.$table;
                            if (d.trigger("sortStart", t),
                            n.count = i[l.sortResetKey] ? 2 : (n.count + 1) % (l.sortReset ? 3 : 2),
                            l.sortRestart && (o = n,
                            l.$headers.each(function() {
                                this === o || !c && T(this).is("." + j.css.sortDesc + ",." + j.css.sortAsc) || (this.count = -1)
                            })),
                            o = n.column,
                            c) {
                                if (l.sortList = [],
                                null !== l.sortForce)
                                    for (a = l.sortForce,
                                    r = 0; r < a.length; r++)
                                        a[r][0] !== o && l.sortList.push(a[r]);
                                if ((a = n.order[n.count]) < 2 && (l.sortList.push([o, a]),
                                1 < n.colSpan))
                                    for (r = 1; r < n.colSpan; r++)
                                        l.sortList.push([o + r, a])
                            } else {
                                if (l.sortAppend && 1 < l.sortList.length)
                                    for (r = 0; r < l.sortAppend.length; r++)
                                        0 <= (s = j.isValueInArray(l.sortAppend[r][0], l.sortList)) && l.sortList.splice(s, 1);
                                if (0 <= j.isValueInArray(o, l.sortList))
                                    for (r = 0; r < l.sortList.length; r++)
                                        s = l.sortList[r],
                                        a = l.$headers.filter('[data-column="' + s[0] + '"]:last')[0],
                                        s[0] === o && (s[1] = a.order[n.count],
                                        2 === s[1] && (l.sortList.splice(r, 1),
                                        a.count = -1));
                                else if ((a = n.order[n.count]) < 2 && (l.sortList.push([o, a]),
                                1 < n.colSpan))
                                    for (r = 1; r < n.colSpan; r++)
                                        l.sortList.push([o + r, a])
                            }
                            if (null !== l.sortAppend)
                                for (a = l.sortAppend,
                                r = 0; r < a.length; r++)
                                    a[r][0] !== o && l.sortList.push(a[r]);
                            d.trigger("sortBegin", t),
                            setTimeout(function() {
                                S(t),
                                x(t),
                                v(t),
                                d.trigger("sortEnd", t)
                            }, 1)
                        }(i, n, e)
                    }
                }),
                r.cancelSelection && a.attr("unselectable", "on").bind("selectstart", !1).css({
                    "user-select": "none",
                    MozUserSelect: "none"
                })
            }
            ,
            j.restoreHeaders = function(e) {
                var t = T(e)[0].config;
                t.$table.find(t.selectorHeaders).each(function(e) {
                    T(this).find("." + j.css.headerIn).length && T(this).html(t.headerContent[e])
                })
            }
            ,
            j.destroy = function(e, t, n) {
                var i, a, o, r, s;
                (e = T(e)[0]).hasInitialized && (j.refreshWidgets(e, !0, !0),
                i = T(e),
                a = e.config,
                r = (o = i.find("thead:first")).find("tr." + j.css.headerRow).removeClass(j.css.headerRow + " " + a.cssHeaderRow),
                s = i.find("tfoot:first > tr").children("th, td"),
                !1 === t && 0 <= T.inArray("uitheme", a.widgets) && (i.trigger("applyWidgetId", ["uitheme"]),
                i.trigger("applyWidgetId", ["zebra"])),
                o.find("tr").not(r).remove(),
                i.removeData("tablesorter").unbind("sortReset update updateAll updateRows updateCell addRows updateComplete sorton appendCache updateCache applyWidgetId applyWidgets refreshWidgets destroy mouseup mouseleave keypress sortBegin sortEnd resetToLoadState ".split(" ").join(a.namespace + " ")),
                a.$headers.add(s).removeClass([j.css.header, a.cssHeader, a.cssAsc, a.cssDesc, j.css.sortAsc, j.css.sortDesc, j.css.sortNone].join(" ")).removeAttr("data-column").removeAttr("aria-label").attr("aria-disabled", "true"),
                r.find(a.selectorSort).unbind(["mousedown", "mouseup", "keypress", ""].join(a.namespace + " ")),
                j.restoreHeaders(e),
                i.toggleClass(j.css.table + " " + a.tableClass + " tablesorter-" + a.theme, !1 === t),
                e.hasInitialized = !1,
                delete e.config.cache,
                "function" == typeof n && n(e))
            }
            ,
            j.regex = {
                chunk: /(^([+\-]?(?:0|[1-9]\d*)(?:\.\d*)?(?:[eE][+\-]?\d+)?)?$|^0x[0-9a-f]+$|\d+)/gi,
                chunks: /(^\\0|\\0$)/,
                hex: /^0x[0-9a-f]+$/i
            },
            j.sortNatural = function(e, t) {
                if (e === t)
                    return 0;
                var n, i, a, o, r, s = j.regex;
                if (s.hex.test(t)) {
                    if ((n = parseInt(e.match(s.hex), 16)) < (i = parseInt(t.match(s.hex), 16)))
                        return -1;
                    if (i < n)
                        return 1
                }
                for (n = e.replace(s.chunk, "\\0$1\\0").replace(s.chunks, "").split("\\0"),
                s = t.replace(s.chunk, "\\0$1\\0").replace(s.chunks, "").split("\\0"),
                r = Math.max(n.length, s.length),
                o = 0; o < r; o++) {
                    if (i = isNaN(n[o]) ? n[o] || 0 : parseFloat(n[o]) || 0,
                    a = isNaN(s[o]) ? s[o] || 0 : parseFloat(s[o]) || 0,
                    isNaN(i) !== isNaN(a))
                        return isNaN(i) ? 1 : -1;
                    if (typeof i != typeof a && (i += "",
                    a += ""),
                    i < a)
                        return -1;
                    if (a < i)
                        return 1
                }
                return 0
            }
            ,
            j.sortNaturalAsc = function(e, t, n, i, a) {
                return e === t ? 0 : (n = a.string[a.empties[n] || a.emptyTo],
                "" === e && 0 !== n ? "boolean" == typeof n ? n ? -1 : 1 : -n || -1 : "" === t && 0 !== n ? "boolean" == typeof n ? n ? 1 : -1 : n || 1 : j.sortNatural(e, t))
            }
            ,
            j.sortNaturalDesc = function(e, t, n, i, a) {
                return e === t ? 0 : (n = a.string[a.empties[n] || a.emptyTo],
                "" === e && 0 !== n ? "boolean" == typeof n ? n ? -1 : 1 : n || 1 : "" === t && 0 !== n ? "boolean" == typeof n ? n ? 1 : -1 : -n || -1 : j.sortNatural(t, e))
            }
            ,
            j.sortText = function(e, t) {
                return t < e ? 1 : e < t ? -1 : 0
            }
            ,
            j.getTextValue = function(e, t, n) {
                if (n) {
                    var i = e ? e.length : 0
                      , a = n + t;
                    for (n = 0; n < i; n++)
                        a += e.charCodeAt(n);
                    return t * a
                }
                return 0
            }
            ,
            j.sortNumericAsc = function(e, t, n, i, a, o) {
                return e === t ? 0 : (a = (o = o.config).string[o.empties[a] || o.emptyTo],
                "" === e && 0 !== a ? "boolean" == typeof a ? a ? -1 : 1 : -a || -1 : "" === t && 0 !== a ? "boolean" == typeof a ? a ? 1 : -1 : a || 1 : (isNaN(e) && (e = j.getTextValue(e, n, i)),
                isNaN(t) && (t = j.getTextValue(t, n, i)),
                e - t))
            }
            ,
            j.sortNumericDesc = function(e, t, n, i, a, o) {
                return e === t ? 0 : (a = (o = o.config).string[o.empties[a] || o.emptyTo],
                "" === e && 0 !== a ? "boolean" == typeof a ? a ? -1 : 1 : a || 1 : "" === t && 0 !== a ? "boolean" == typeof a ? a ? 1 : -1 : -a || -1 : (isNaN(e) && (e = j.getTextValue(e, n, i)),
                isNaN(t) && (t = j.getTextValue(t, n, i)),
                t - e))
            }
            ,
            j.sortNumeric = function(e, t) {
                return e - t
            }
            ,
            j.characterEquivalents = {
                a: "",
                A: "",
                c: "",
                C: "",
                e: "",
                E: "",
                i: "",
                I: "",
                o: "",
                O: "",
                ss: "",
                SS: "",
                u: "",
                U: ""
            },
            j.replaceAccents = function(e) {
                var t, n = "[", i = j.characterEquivalents;
                if (!j.characterRegex) {
                    for (t in j.characterRegexArray = {},
                    i)
                        "string" == typeof t && (n += i[t],
                        j.characterRegexArray[t] = new RegExp("[" + i[t] + "]","g"));
                    j.characterRegex = new RegExp(n + "]")
                }
                if (j.characterRegex.test(e))
                    for (t in i)
                        "string" == typeof t && (e = e.replace(j.characterRegexArray[t], t));
                return e
            }
            ,
            j.isValueInArray = function(e, t) {
                for (var n = t.length, i = 0; i < n; i++)
                    if (t[i][0] === e)
                        return i;
                return -1
            }
            ,
            j.addParser = function(e) {
                for (var t = j.parsers.length, n = !0, i = 0; i < t; i++)
                    j.parsers[i].id.toLowerCase() === e.id.toLowerCase() && (n = !1);
                n && j.parsers.push(e)
            }
            ,
            j.getParserById = function(e) {
                if ("false" == e)
                    return !1;
                for (var t = j.parsers.length, n = 0; n < t; n++)
                    if (j.parsers[n].id.toLowerCase() === e.toString().toLowerCase())
                        return j.parsers[n];
                return !1
            }
            ,
            j.addWidget = function(e) {
                j.widgets.push(e)
            }
            ,
            j.hasWidget = function(e, t) {
                return (e = T(e)).length && e[0].config && e[0].config.widgetInit[t] || !1
            }
            ,
            j.getWidgetById = function(e) {
                for (var t, n = j.widgets.length, i = 0; i < n; i++)
                    if ((t = j.widgets[i]) && t.hasOwnProperty("id") && t.id.toLowerCase() === e.toLowerCase())
                        return t
            }
            ,
            j.applyWidget = function(n, i) {
                var e, t, a, o = (n = T(n)[0]).config, r = o.widgetOptions, s = [];
                !1 !== i && n.hasInitialized && (n.isApplyingWidgets || n.isUpdating) || (o.debug && (e = new Date),
                o.widgets.length && (n.isApplyingWidgets = !0,
                o.widgets = T.grep(o.widgets, function(e, t) {
                    return T.inArray(e, o.widgets) === t
                }),
                T.each(o.widgets || [], function(e, t) {
                    (a = j.getWidgetById(t)) && a.id && (a.priority || (a.priority = 10),
                    s[e] = a)
                }),
                s.sort(function(e, t) {
                    return e.priority < t.priority ? -1 : e.priority === t.priority ? 0 : 1
                }),
                T.each(s, function(e, t) {
                    t && (!i && o.widgetInit[t.id] || (o.widgetInit[t.id] = !0,
                    t.hasOwnProperty("options") && (r = n.config.widgetOptions = T.extend(!0, {}, t.options, r)),
                    t.hasOwnProperty("init") && t.init(n, t, o, r)),
                    !i && t.hasOwnProperty("format") && t.format(n, o, r, !1))
                })),
                setTimeout(function() {
                    n.isApplyingWidgets = !1
                }, 0),
                o.debug && (t = o.widgets.length,
                C("Completed " + (!0 === i ? "initializing " : "applying ") + t + " widget" + (1 !== t ? "s" : ""), e)))
            }
            ,
            j.refreshWidgets = function(e, t, n) {
                for (var i = (e = T(e)[0]).config, a = i.widgets, o = j.widgets, r = o.length, s = 0; s < r; s++)
                    o[s] && o[s].id && (t || T.inArray(o[s].id, a) < 0) && (i.debug && w('Refeshing widgets: Removing "' + o[s].id + '"'),
                    o[s].hasOwnProperty("remove") && i.widgetInit[o[s].id] && (o[s].remove(e, i, i.widgetOptions),
                    i.widgetInit[o[s].id] = !1));
                !0 !== n && j.applyWidget(e, t)
            }
            ,
            j.getData = function(e, t, n) {
                var i, a, o = "";
                return (e = T(e)).length ? (i = !!T.metadata && e.metadata(),
                a = " " + (e.attr("class") || ""),
                void 0 !== e.data(n) || void 0 !== e.data(n.toLowerCase()) ? o += e.data(n) || e.data(n.toLowerCase()) : i && void 0 !== i[n] ? o += i[n] : t && void 0 !== t[n] ? o += t[n] : " " !== a && a.match(" " + n + "-") && (o = a.match(new RegExp("\\s" + n + "-([\\w-]+)"))[1] || ""),
                T.trim(o)) : ""
            }
            ,
            j.formatFloat = function(e, t) {
                return "string" != typeof e || "" === e ? e : (e = (t && t.config ? !1 !== t.config.usNumberFormat : void 0 === t || t) ? e.replace(/,/g, "") : e.replace(/[\s|\.]/g, "").replace(/,/g, "."),
                /^\s*\([.\d]+\)/.test(e) && (e = e.replace(/^\s*\(([.\d]+)\)/, "-$1")),
                t = parseFloat(e),
                isNaN(t) ? T.trim(e) : t)
            }
            ,
            j.isDigit = function(e) {
                return !isNaN(e) || /^[\-+(]?\d+[)]?$/.test(e.toString().replace(/[,.'"\s]/g, ""))
            }
        }
    });
    var c = T.tablesorter;
    T.fn.extend({
        tablesorter: c.construct
    }),
    c.addParser({
        id: "no-parser",
        is: function() {
            return !1
        },
        format: function() {
            return ""
        },
        type: "text"
    }),
    c.addParser({
        id: "text",
        is: function() {
            return !0
        },
        format: function(e, t) {
            t = t.config;
            return e && (e = T.trim(t.ignoreCase ? e.toLocaleLowerCase() : e),
            e = t.sortLocaleCompare ? c.replaceAccents(e) : e),
            e
        },
        type: "text"
    }),
    c.addParser({
        id: "digit",
        is: function(e) {
            return c.isDigit(e)
        },
        format: function(e, t) {
            var n = c.formatFloat((e || "").replace(/[^\w,. \-()]/g, ""), t);
            return e && "number" == typeof n ? n : e && T.trim(e && t.config.ignoreCase ? e.toLocaleLowerCase() : e)
        },
        type: "numeric"
    }),
    c.addParser({
        id: "currency",
        is: function(e) {
            return /^\(?\d+[\u00a3$\u20ac\u00a4\u00a5\u00a2?.]|[\u00a3$\u20ac\u00a4\u00a5\u00a2?.]\d+\)?$/.test((e || "").replace(/[+\-,. ]/g, ""))
        },
        format: function(e, t) {
            var n = c.formatFloat((e || "").replace(/[^\w,. \-()]/g, ""), t);
            return e && "number" == typeof n ? n : e && T.trim(e && t.config.ignoreCase ? e.toLocaleLowerCase() : e)
        },
        type: "numeric"
    }),
    c.addParser({
        id: "ipAddress",
        is: function(e) {
            return /^\d{1,3}[\.]\d{1,3}[\.]\d{1,3}[\.]\d{1,3}$/.test(e)
        },
        format: function(e, t) {
            for (var n = e ? e.split(".") : "", i = "", a = n.length, o = 0; o < a; o++)
                i += ("00" + n[o]).slice(-3);
            return e && c.formatFloat(i, t)
        },
        type: "numeric"
    }),
    c.addParser({
        id: "url",
        is: function(e) {
            return /^(https?|ftp|file):\/\//.test(e)
        },
        format: function(e) {
            return e && T.trim(e.replace(/(https?|ftp|file):\/\//, ""))
        },
        parsed: !0,
        type: "text"
    }),
    c.addParser({
        id: "isoDate",
        is: function(e) {
            return /^\d{4}[\/\-]\d{1,2}[\/\-]\d{1,2}/.test(e)
        },
        format: function(e, t) {
            return e && c.formatFloat("" !== e ? new Date(e.replace(/-/g, "/")).getTime() || e : "", t)
        },
        type: "numeric"
    }),
    c.addParser({
        id: "percent",
        is: function(e) {
            return /(\d\s*?%|%\s*?\d)/.test(e) && e.length < 15
        },
        format: function(e, t) {
            return e && c.formatFloat(e.replace(/%/g, ""), t)
        },
        type: "numeric"
    }),
    c.addParser({
        id: "usLongDate",
        is: function(e) {
            return /^[A-Z]{3,10}\.?\s+\d{1,2},?\s+(\d{4})(\s+\d{1,2}:\d{2}(:\d{2})?(\s+[AP]M)?)?$/i.test(e) || /^\d{1,2}\s+[A-Z]{3,10}\s+\d{4}/i.test(e)
        },
        format: function(e, t) {
            return e && c.formatFloat(new Date(e.replace(/(\S)([AP]M)$/i, "$1 $2")).getTime() || e, t)
        },
        type: "numeric"
    }),
    c.addParser({
        id: "shortDate",
        is: function(e) {
            return /(^\d{1,2}[\/\s]\d{1,2}[\/\s]\d{4})|(^\d{4}[\/\s]\d{1,2}[\/\s]\d{1,2})/.test((e || "").replace(/\s+/g, " ").replace(/[\-.,]/g, "/"))
        },
        format: function(e, t, n, i) {
            var a;
            return e && (i = (a = (n = t.config).$headers.filter("[data-column=" + i + "]:last")).length && a[0].dateFormat || c.getData(a, c.getColumnData(t, n.headers, i), "dateFormat") || n.dateFormat,
            e = e.replace(/\s+/g, " ").replace(/[\-.,]/g, "/"),
            "mmddyyyy" === i ? e = e.replace(/(\d{1,2})[\/\s](\d{1,2})[\/\s](\d{4})/, "$3/$1/$2") : "ddmmyyyy" === i ? e = e.replace(/(\d{1,2})[\/\s](\d{1,2})[\/\s](\d{4})/, "$3/$2/$1") : "yyyymmdd" === i && (e = e.replace(/(\d{4})[\/\s](\d{1,2})[\/\s](\d{1,2})/, "$1/$2/$3"))),
            e && c.formatFloat(new Date(e).getTime() || e, t)
        },
        type: "numeric"
    }),
    c.addParser({
        id: "time",
        is: function(e) {
            return /^(([0-2]?\d:[0-5]\d)|([0-1]?\d:[0-5]\d\s?([AP]M)))$/i.test(e)
        },
        format: function(e, t) {
            return e && c.formatFloat(new Date("2000/01/01 " + e.replace(/(\S)([AP]M)$/i, "$1 $2")).getTime() || e, t)
        },
        type: "numeric"
    }),
    c.addParser({
        id: "metadata",
        is: function() {
            return !1
        },
        format: function(e, t, n) {
            return e = (e = t.config).parserMetadataName || "sortValue",
            T(n).metadata()[e]
        },
        type: "numeric"
    }),
    c.addWidget({
        id: "zebra",
        priority: 90,
        format: function(e, t, n) {
            var i, a, o, r, s = new RegExp(t.cssChildRow,"i"), l = t.$tbodies;
            for (t.debug && (r = new Date),
            e = 0; e < l.length; e++)
                a = 0,
                l.eq(e).children("tr:visible").not(t.selectorRemove).each(function() {
                    i = T(this),
                    s.test(this.className) || a++,
                    o = 0 == a % 2,
                    i.removeClass(n.zebra[o ? 1 : 0]).addClass(n.zebra[o ? 0 : 1])
                });
            t.debug && c.benchmark("Applying Zebra widget", r)
        },
        remove: function(e, t, n) {
            var i;
            t = t.$tbodies;
            var a = (n.zebra || ["even", "odd"]).join(" ");
            for (n = 0; n < t.length; n++)
                (i = T.tablesorter.processTbody(e, t.eq(n), !0)).children().removeClass(a),
                T.tablesorter.processTbody(e, i, !1)
        }
    })
}(jQuery);
var SCM = SCM || {};
SCM.Common = {
    getQueryStringValue: function(e, t) {
        var n = t + "="
          , t = e.indexOf(n);
        {
            if (-1 === t)
                return null;
            t += n.length
        }
        t = 0 <= e.indexOf("&", t) ? (n = e.indexOf("&", t),
        e.substring(t, n)) : e.substring(t);
        return t
    },
    isDefined: function(e) {
        return void 0 !== e && void 0 !== e && null != e
    }
},
SCM = SCM || {},
SCM.QueryBuilder = {},
SCM.QueryBuilder.defaults = {
    runSearch: function(e) {
        window.location.hash = "#" + e
    },
    beforeSearch: function() {}
},
SCM.QueryBuilder.configure = function() {
    function i(e) {
        var t = e
          , e = t.closest(".querybuilder-instance");
        t.hasClass("filter-citation") ? (e.find(o).addClass("hide"),
        e.find(r).removeClass("hide")) : (e.find(r).addClass("hide"),
        e.find(o).removeClass("hide"))
    }
    var t, e = $(".querybuilder-filter"), a = $(".querybuilder-filter-current-wrap"), n = $(".querybuilder-filter-dropdown"), o = $(".querybuilder-input-standard"), r = $(".querybuilder-input-citation"), s = $(".querybuilder-instance"), l = $(".querybuilder-add");
    function c(e, t) {
        $(".sort-order-list").addClass("hide"),
        t.stopPropagation();
        e = e.find(n);
        n.not(e).addClass("hide"),
        e.hasClass("hide") ? e.removeClass("hide") : e.addClass("hide")
    }
    function d(e) {
        var t = e.closest(".querybuilder-filter-dropdown");
        $thisLabel = e.closest(a).find(".querybuilder-filter-label"),
        t.children(e).removeClass("selected"),
        e.addClass("selected"),
        $thisLabel.text(e.text()),
        i(e);
        var n = e.parents(".querybuilder-instance").attr("id");
        $("#search-errors li").each(function() {
            var e = $(this);
            e.attr("from") === n && e.remove()
        }),
        e.hasClass("filter-citation") ? u(e.closest(".querybuilder-instance").attr("id"), !1) : u(e = function() {
            var e = null;
            return s.each(function() {
                if (!$(this).hasClass("hide") && !$(this).find(r).hasClass("hide"))
                    return e = $(this).attr("id"),
                    !1
            }),
            e
        }(), null === e)
    }
    function u(n, i) {
        s.each(function() {
            var e = s.attr("id")
              , t = $(this).find("li[data-fieldname='Citation']");
            e === n && null !== n || (i ? t.show() : t.hide())
        })
    }
    function h() {
        var e = "";
        if (0 < $(".js-custom-queryBuilder").length)
            e = SCM.CustomQueryBuilder.queryBuilderHandler();
        else {
            var h = $("#hfCurrentSearchTerm").val()
              , t = (f = $(".querybuilder-submit").attr("data-current-url")).split("&")
              , f = (t = $.grep(t, function(e, t) {
                return e.split("=")[0].indexOf("fd_IsLatestEdition") < 0
            })).join("&")
              , p = new Object
              , g = 1
              , m = !1
              , n = $("#search-errors");
            function v(e, t) {
                var n, i = "";
                return 0 <= t.indexOf("q=") ? ((n = SCM.Common.getQueryStringValue(t, "q")).startsWith("(") || (i = "("),
                i = n.endsWith(")") ? i + n.slice(0, -1) + " AND " + e + ")" : i + n + " AND " + e + ")",
                t.replace(n, i)) : "q=" + e + "&" + t
            }
            function i(e) {
                var i = $("<ul>");
                n.append(i),
                $.each(e, function(e, t) {
                    var n;
                    i.append((n = t,
                    (t = $("<li>")).text(n.message),
                    t.attr("from", n.origin),
                    t))
                })
            }
            var b = [];
            if (n.empty(),
            $(".querybuilder-wrap .querybuilder-instance").each(function(e) {
                var o = $(this);
                if (!o.hasClass("hide")) {
                    var t = o.find("#instance_QueryBuilderSearchTerm");
                    t = (t = (0 === t.length ? o.find(".querybuilder-input") : t).val().trim()).replace(/\"/g, "");
                    var n = o.find(".querybuilder-filter-dropdown li.selected").text()
                      , i = o.find(".querybuilder-filter-dropdown li.selected").attr("data-fieldname")
                      , a = !1;
                    if (1 === g) {
                        var r, s = encodeURIComponent(t);
                        if (null == i || "" === $.trim(i) || "" === s)
                            return encodeURIComponent(h) !== s && (f = 0 <= (r = f.indexOf("q=")) && 0 <= f.indexOf("&", r) ? null !== (r = SCM.Common.getQueryStringValue(f, "q")) && "" !== r ? (r = "q=" + r + "&",
                            f.replace(r, "q=" + s + "&")) : "q=" + s + "&" + f : "q=" + s + "&" + f),
                            p.q = s,
                            m = !0,
                            "" === s ? f = f.replace("q=&", "") : g++,
                            !0;
                        s = SCM.Common.getQueryStringValue(f, "q");
                        null !== s && "" !== s ? (s = "q=" + s + "&",
                        f = f.replace(s, "")) : p = new Object,
                        a = !0
                    }
                    switch (n) {
                    case "":
                        var l, c = "q" + g;
                        "" !== t && (f = v(l = t, f),
                        p[c] = encodeURIComponent(l),
                        m = !0);
                        break;
                    case "All":
                        "" !== t && (l = encodeURIComponent(t),
                        f = v(l, f),
                        (1 === g && a || 1 !== g) && (p["All" + g] = l,
                        m = !0));
                        break;
                    case "Citation":
                        var d = {}
                          , u = "Citation" + g;
                        $.each([{
                            id: "#instance_CitationYear",
                            field: "Year",
                            pattern: /^(?!0(0?){3})\d(\d?){3}$/,
                            message: "The 'Year' field only accepts numbers."
                        }, {
                            id: "#instance_CitationVolume",
                            field: "Volume"
                        }, {
                            id: "#instance_CitationIssueNo",
                            field: "IssueNo"
                        }, {
                            id: "#instance_CitationPage",
                            field: "StartPage"
                        }], function(e, t) {
                            var n, i = o.find(t.id), a = i.val().trim();
                            null !== (n = a) && "" !== n && void 0 !== n && (p[u] || (p[u] = d,
                            m = !0),
                            t.pattern && !t.pattern.test(a) ? (i.val(""),
                            -1 === $.inArray(t.message, b) && b.push({
                                message: t.message,
                                origin: "qbInstance" + g
                            })) : d[t.field] = a)
                        });
                        break;
                    default:
                        "" !== t && (l = t,
                        p[i + g] = encodeURIComponent(l),
                        m = !0)
                    }
                }
                g++
            }),
            0 < b.length)
                return i(b),
                void $("#queryBuilderSubmit").addClass("btn-green").removeAttr("style");
            var a = SCM.Common.getQueryStringValue(f, "page");
            "page=1" === f && (f = "&page=1"),
            null !== a && "" !== a && (f = f.replace("page=" + a + "&", "page=1&")),
            e = f,
            m && (t = JSON.stringify(p),
            e = (a = SCM.Common.getQueryStringValue(f, "qb")) ? e.replace(a, t) : e + "&qb=" + t)
        }
        SCM.QueryBuilder.defaults.beforeSearch(),
        SCM.QueryBuilder.defaults.runSearch(e)
    }
    (t = jQuery)(".querybuilder-instance").each(function() {
        var e;
        t(this).hasClass("hide") || void 0 !== (e = t(this).find("[id^=operator-]")) && 0 < e.length && t(this).find("[id^=" + e.val().toLowerCase() + "Op-]").prop("checked", !0)
    }),
    e.each(function() {
        var e = t(this);
        e.hasClass("selected") && (e.closest(a).find(".querybuilder-filter-label").text(e.text()),
        i(e))
    }),
    a.off("click").on("click", function(e) {
        c($(this), e)
    }),
    a.off("keydown").keydown(function(e) {
        13 == e.which && c($(this), e)
    }),
    $(document).on("click", function() {
        n.addClass("hide")
    }),
    e.on("click", function() {
        d($(this))
    }),
    e.keydown(function(e) {
        13 == e.which && d($(this))
    }),
    $(".querybuilder-input, .citation-input").on("keyup", function() {
        $("#queryBuilderSubmit").addClass("btn-green").removeAttr("style"),
        !function(e) {
            var t = e;
            if (t.hasClass("citation-input")) {
                var n = t.val().replace(/\'/g, "").trim().length
                  , i = t.val().replace(/\'/g, "").trim().length
                  , a = t.val().replace(/\'/g, "").trim().length
                  , e = t.val().replace(/\'/g, "").trim().length;
                return 0 < n || 0 < i || 0 < a || 0 < e ? !0 : (0 !== n || 0 !== i || 0 !== a || 0 !== e) && void 0
            }
            t = t.val().replace(/\'/g, "").trim().length;
            return 0 !== t && (0 < t || void 0)
        }($(this)) ? l.removeClass("valid").attr("disabled") : l.addClass("valid").removeAttr("disabled")
    }),
    l.on("click", function() {
        var e, t, n;
        $(this).attr("disabled") ? alert("A value must be entered before adding another filter.") : (e = 1,
        s.each(function() {
            $(this).hasClass("hide") || e++
        }),
        t = $("#qbInstance" + e),
        void 0 !== (n = $("#operators-qbInstance" + e)) && 0 < n.length && (n.removeClass("hide"),
        $("#andOp-qbInstance" + e).prop("checked", !0)),
        t.removeClass("hide"),
        l.removeClass("valid").attr("disabled", ""))
    }),
    $(".querybuilder-submit").on("click", function() {
        $(this).removeClass("btn-green").attr("style", "opacity: 0.3;")
    }),
    $(".querybuilder-wrap").on("keyup", "input.citation-input.citation-year", function(e) {
        e = $(e.target);
        4 < e.val().length && e.val(e.val().substr(0, 4))
    }),
    $(".js-main, .js-querybuilder-wrap").off("click").on("click", ".querybuilder-submit", function() {
        h()
    }),
    $(".querybuilder-input").off("keyup").keyup(function(e) {
        var t = e.which;
        13 === t && e.preventDefault();
        e = $.trim($(this).val());
        if (13 === t && "" !== e)
            return h(),
            !1
    })
}
,
String.prototype.startsWith || (String.prototype.startsWith = function(e, t) {
    return t = t || 0,
    this.indexOf(e, t) === t
}
),
String.prototype.endsWith || (String.prototype.endsWith = function(e, t) {
    var n = this.toString();
    ("number" != typeof t || !isFinite(t) || Math.floor(t) !== t || t > n.length) && (t = n.length),
    t -= e.length;
    e = n.lastIndexOf(e, t);
    return -1 !== e && e === t
}
);
var SCM = SCM || {};
function getQueryStringValue(e, t) {
    var n = t + "="
      , t = e.indexOf(n);
    return -1 === t ? null : (t += n.length,
    0 <= e.indexOf("&", t) ? (n = e.indexOf("&", t),
    e.substring(t, n)) : e.substring(t))
}
function isDefined(e) {
    return void 0 !== e && void 0 !== e && null != e && "" !== e
}
function jsonToQueryString(t) {
    return Object.keys(t).filter(function(e) {
        return isDefined(e)
    }).map(function(e) {
        return encodeURIComponent(e) + "=" + encodeURIComponent(t[e])
    }).join("&")
}
SCM.JournalCitationFilter = function(d) {
    var u = "f_JournalDisplayName"
      , h = "rg_IssuePublicationDate"
      , f = "f_Volume"
      , p = "f_IssueNo"
      , g = "f_StartPage"
      , e = null
      , t = null
      , n = null
      , i = null
      , a = null
      , m = null
      , v = null
      , b = null
      , y = null
      , S = null
      , w = null
      , C = null
      , k = null
      , x = null
      , o = null
      , r = null
      , M = null
      , j = null
      , T = null
      , A = null
      , $ = null
      , I = null
      , F = null
      , _ = null
      , E = null
      , L = null;
    function s() {
        var e = document.getElementById("hfJournalCitationFilterLoaded");
        return !(!e || !e.value)
    }
    function l(e, t) {
        return t = t || "",
        (document.getElementById(e) || {}).value || t
    }
    function c() {
        r.classList.remove("collapsed"),
        -1 !== o.className.indexOf("icon-general-arrow-filled-right") && (o.classList.remove("icon-general-arrow-filled-right"),
        o.classList.add("icon-general-arrow-filled-down"))
    }
    return {
        init: function() {
            s() && (e = getQueryStringValue(location.search, u),
            t = getQueryStringValue(location.search, h),
            n = getQueryStringValue(location.search, f),
            i = getQueryStringValue(location.search, p),
            a = getQueryStringValue(location.search, g),
            m = document.getElementById("SelectedJournal"),
            v = document.getElementById("Citation_IssuePublicationDate"),
            b = document.getElementById("Citation_Volume"),
            y = document.getElementById("Citation_IssueNo"),
            S = document.getElementById("Citation_StartPage"),
            w = isDefined(v) ? v.getAttribute("pattern") : null,
            C = isDefined(b) ? b.getAttribute("pattern") : null,
            k = isDefined(y) ? y.getAttribute("pattern") : null,
            x = isDefined(S) ? S.getAttribute("pattern") : null,
            o = document.getElementsByClassName("js-journal-citation-filter-toggle")[0],
            r = document.getElementsByClassName("journal-citation-filter-input-wrap")[0],
            M = l("Config_PlaceholderTextJournal"),
            j = l("Config_PlaceholderTextYear"),
            T = l("Config_PlaceholderTextVolume"),
            A = l("Config_PlaceholderTextIssueNo"),
            $ = l("Config_PlaceholderTextStartPage"),
            I = l("Config_ValidationMessageJournal"),
            F = l("Config_ValidationMessageYear"),
            _ = l("Config_ValidationMessageVolume"),
            E = l("Config_ValidationMessageIssueNo"),
            L = l("Config_ValidationMessageStartPage"),
            !0 === function() {
                if (isDefined(e) && isDefined(m) || isDefined(t) && isDefined(v) || isDefined(n) && isDefined(b) || isDefined(i) && isDefined(y) || isDefined(a) && isDefined(S))
                    return v.value = function(e) {
                        if (!isDefined(e))
                            return "";
                        var t = decodeURIComponent(e).split("TO").map(function(e) {
                            return e.replace("+", "")
                        });
                        return e = 0 < t.length ? t[0] : e,
                        new Date(e).getUTCFullYear()
                    }(t),
                    b.value = n,
                    y.value = i,
                    S.value = a,
                    !0;
                return !1
            }() && c())
        },
        applyFilter: function(e, t) {
            var n, i, a, o, r;
            if (!(c = (n = isDefined(m) && 0 < m.options.length && isDefined(m.options[m.selectedIndex]) ? m.options[m.selectedIndex].textContent : "",
            i = isDefined(v) ? v.value : "",
            a = isDefined(b) ? b.value : "",
            o = isDefined(y) ? y.value : "",
            r = isDefined(S) ? S.value : "",
            l = {},
            c = "",
            n === M && "" !== n ? c = I + "\n" : "" !== n && (l[u] = d.trim(n)),
            i !== j && "" !== i && (n = new RegExp(w),
            isNaN(i) || !n.test(i) ? c += F + "\n" : (i = "01/01/" + i + " TO 12/31/" + i,
            l[h] = i)),
            a !== T && "" !== a && (new RegExp(C).test(a) ? l[f] = a : c += _ + "\n"),
            o !== A && "" !== o && (new RegExp(k).test(o) ? l[p] = o : c += E + "\n"),
            r !== $ && "" !== r && (new RegExp(x).test(r) ? l[g] = r : c += L + "\n"),
            0 < c.length ? (alert(c),
            !1) : l)))
                return !1;
            var s, l = jsonToQueryString(c), e = (c = (c = e).split("&"),
            s = [u, h, f, p, g, "page"],
            (c = c.filter(function(e) {
                e = e.split("=")[0];
                return s.indexOf(e) < 0
            })).push("page=1"),
            c.join("&").trim()), c = "";
            t && (c = t.split("&").filter(function(e) {
                e = e.split("=")[0];
                return "dateFilterType" === e || "noDateTypes" === e
            }).join("&").trim()),
            e && (l += "&" + e),
            c && (l += "&" + c);
            c = {
                queryString: l
            };
            return void 0 !== (l = d("#hfSiteURL")) && "" !== l.val() && (SCM.SearchResults.defaults.baseSiteUrl = l.val()),
            SCM.SearchResults.doSolrSearch(c),
            !1
        },
        toggleWidget: function() {
            -1 !== r.className.indexOf("collapsed") ? c() : (r.classList.add("collapsed"),
            -1 !== o.className.indexOf("icon-general-arrow-filled-down") && (o.classList.remove("icon-general-arrow-filled-down"),
            o.classList.add("icon-general-arrow-filled-right")))
        },
        journalCitationFilterLoaded: s
    }
}(jQuery),
$(document).ready(function() {
    function t() {
        var e = $(".js-journal-citation-filter-update").data("searchUri")
          , t = window.location.search;
        t.length && (t = t.substring(1)),
        SCM.JournalCitationFilter.applyFilter(e, t)
    }
    function n() {
        $(document).ajaxStart(function() {
            $(".info-inner-cover").removeClass("uncovered"),
            $(".info-inner-cover").addClass("covered")
        }),
        $(document).ajaxComplete(function() {
            $(".info-inner-cover").removeClass("covered"),
            $(".info-inner-cover").addClass("uncovered")
        })
    }
    SCM.JournalCitationFilter.journalCitationFilterLoaded() && (SCM.JournalCitationFilter.init(),
    $(document).on("click", ".js-journal-citation-filter-update", function() {
        $(this).addClass("fade"),
        n(),
        t()
    }),
    $(document).on("keyup", ".js-advanced-citation-filter-field", function(e) {
        13 === e.keyCode && (e.preventDefault(),
        $(".js-journal-citation-filter-update").addClass("fade"),
        n(),
        t())
    }),
    $(document).on("click", ".js-journal-citation-filter-toggle", function() {
        SCM.JournalCitationFilter.toggleWidget()
    }),
    $(document).on("keyup change", ".js-advanced-citation-filter-field", function() {
        $(".js-journal-citation-filter-update").removeClass("fade")
    }))
});
var SCM = SCM || {};
SCM.ArticleImageDetails = function(o) {
    var t, i = null;
    function r() {
        o("body").toggleClass("modalOpen")
    }
    function a() {
        o("." + i + ", .figureModal .close").on("click", e),
        o(".js-item-image").first().on("click", c),
        o(".js-item-image").last().on("click", c),
        o(".js-previous-image-details, .js-next-image-details").on("click", d),
        o(".figureModalContainer").on("click", f)
    }
    function n() {
        o("." + i + ", .figureModal .close").off("click", e),
        o(".js-item-image").first().off("click", c),
        o(".js-item-image").last().off("click", c),
        o(".js-previous-image-details, .js-next-image-details").off("click", d),
        o(".figureModalContainer").off("click", f)
    }
    function e(e) {
        e.preventDefault(),
        e.stopPropagation();
        e = o(this).data("item");
        o("#" + e).fadeToggle(200),
        o("#" + e).toggleClass("active-modal"),
        r(),
        l(e),
        o(".active-modal").length ? s() : t.focus()
    }
    function s() {
        var e = document.querySelector(".active-modal .figureModal")
          , t = e.querySelectorAll('a[href]:not([disabled]), button:not([disabled]), textarea:not([disabled]), input[type="text"]:not([disabled]), input[type="radio"]:not([disabled]), input[type="checkbox"]:not([disabled]), select:not([disabled])')
          , n = t[0]
          , i = t[t.length - 1];
        n.focus(),
        e.addEventListener("keydown", function(e) {
            "Tab" !== e.key && 9 !== e.keyCode || (e.shiftKey ? document.activeElement === n && (i.focus(),
            e.preventDefault()) : document.activeElement === i && (n.focus(),
            e.preventDefault()))
        })
    }
    function l(t) {
        var e = o("#" + t).data("articleid");
        e && o.ajax({
            type: "POST",
            url: "/Article/GetCitation",
            data: {
                articleID: e
            }
        }).done(function(e) {
            e && (document.getElementById(t).getElementsByClassName("citation")[0].innerHTML = e)
        }).fail(function(e) {
            console.log(e.message)
        })
    }
    function c(e) {
        e.preventDefault(),
        e.stopPropagation();
        e = o(this).data("item");
        u(o("#" + e))
    }
    function d(e) {
        e.preventDefault(),
        e.stopPropagation();
        var t = o(this)
          , n = t.data("item")
          , i = o("#" + n);
        i.removeClass("active-modal");
        var a = t.data("new-item")
          , e = o("#" + a);
        e.addClass("active-modal"),
        "newPage" === a ? (n = t.data("url"),
        t = t.data("modal-open"),
        r(),
        SCM.SearchResults.doSolrSearch({
            queryString: n,
            openModal: t
        })) : l(a),
        e.toggle(function() {
            i.toggle()
        }),
        u(e),
        s()
    }
    function u(e) {
        var t = e.find(".js-previous-image-details")
          , n = e.find(".js-next-image-details")
          , i = null
          , a = null;
        "newPage" === t.data("new-item") && (i = t.data("url"),
        a = t.data("modal-open")),
        "newPage" === n.data("new-item") && (i = n.data("url"),
        a = n.data("modal-open")),
        i && SCM.SearchResults.doSolrSearch({
            queryString: i,
            openModal: a,
            cacheSearchWithoutUpdatingDom: !0,
            currentItem: e,
            functionToDoWhileAjaxLoading: h
        })
    }
    function h(e) {
        var t = e.find(".js-previous-image-details, .js-next-image-details");
        e.length && (t.hasClass("disabled") ? (t.removeClass("disabled"),
        a()) : t.hasClass("disabled") || (t.addClass("disabled"),
        n()))
    }
    function f(e) {
        $target = o(e.target),
        $target.parents(".figureModalContainer:visible").length || (o(".figureModalContainer").hide(),
        o("body").removeClass("modalOpen"),
        t.focus())
    }
    return o(".js-item-image").on("click", function() {
        t = document.activeElement
    }),
    {
        init: function(e, t, n) {
            o(".figureModalContainer").hide(),
            !0 === t && (o("#" + n).fadeToggle(200),
            r(),
            l(n)),
            i = e,
            (e = o(".figureModalContainer")).remove(),
            o("#multimediaGalleryModalWrapper").append(e),
            a()
        }
    }
}(jQuery);
var SCM = SCM || {};
SCM.UploadImage_Complete = function(e) {
    var t, n = $.extend({
        targetSelector: "#UploadTarget",
        jsonResultSelector: "#jsonResult",
        replacementContainerSelector: "#id"
    }, e), e = $(n.targetSelector).contents().find(n.jsonResultSelector);
    1 === e.length && (e = $.parseJSON(e.html()),
    $("[data-valmsg-for]").attr("class", "field-validation-valid").html(""),
    e.Success ? n.success && n.success() : 0 < e.Messages.length ? (t = "Error \n",
    e.Messages.forEach(function(e) {
        t += e + "\n"
    }),
    alert(t)) : e.Html ? $(n.replacementContainerSelector).replaceWith(e.Html.replace(/{{/g, "&quot;")) : e.ValidationErrors.forEach(function(e) {
        var t = $("[data-valmsg-for=" + e.Key + "]");
        t.addClass("field-validation-error").removeClass("field-validation-valid"),
        e.Errors.forEach(function(e) {
            t.html(t.html() + e + "<br />")
        })
    }))
}
,
SCM.AjaxHelperSuccessCallback = function(e, t, n) {
    e.RedirectUrl && 0 < e.RedirectUrl.length ? window.location = e.RedirectUrl : e.Html && 0 < e.Html.length ? t.replaceWith(e.Html) : e.Success ? n() : t.replaceWith(e)
}
,
SCM.AjaxHelperErrorCallback = function(e, t, n) {
    e.RedirectUrl && 0 < e.RedirectUrl.length ? window.location = e.RedirectUrl : e.Html && 0 < e.Html.length ? t.replaceWith(e.Html) : e.Success ? n() : t.replaceWith(e)
}
,
SCM.showModal = function() {
    var t = [];
    "undefined" != typeof tinyMCE && tinyMCE.editors.forEach(function(e) {
        $("#divDefaultUpdateTarget").find("#" + e.editorContainer).each(function() {
            t.push(e.id)
        })
    }),
    $.fancybox({
        autosize: !0,
        autoScale: !1,
        title: "",
        href: "#divDefaultUpdateTarget"
    }),
    "undefined" != typeof tinyMCE && t.forEach(function(e) {
        $("#" + e).scmTinyMCE()
    })
}
,
SCM.hideModal = function() {
    $.fancybox.close()
}
,
SCM.refreshModal = function() {
    $.fancybox.update()
}
,
function() {
    var o = $("body");
    function r(e, t) {
        return 0 === e.indexOf("*.") && (e = e.replace("*.", t)),
        e
    }
    $(document).ajaxError(function(e, t, n) {
        if (o.removeClass("wait"),
        t.responseText)
            try {
                var i, a = $.parseJSON(t.responseText);
                null == a.Success || a.Success || (i = "There was an error processing the request \n",
                a.Messages.forEach(function(e) {
                    i += e + "\n"
                }),
                alert(i))
            } catch (e) {
                console.log("Ajax error occured, responseText is not json: " + e.message)
            }
    }),
    $.validator.addMethod("isDateGreaterThan", function(e, t, n) {
        return 1 != function(e, t) {
            t = new Date(t),
            e = new Date(e);
            {
                if (t.getFullYear() == e.getFullYear() && t.getMonth() == e.getMonth() && t.getDate() == e.getDate())
                    return !1;
                if (e < t)
                    return !0
            }
            return !1
        }($(t).val(), n)
    }, ""),
    $(document).ajaxStart(function() {
        o.addClass("wait")
    }).ajaxStop(function() {
        o.removeClass("wait")
    }),
    o.on("keypress", "[data-default-button]", function(e) {
        if (13 == e.which)
            return $("#" + $(this).data("defaultButton")).click(),
            !1
    }),
    $.validator.unobtrusive.adapters.add("dynamicrange", ["minvalueproperty", "maxvalueproperty"], function(e) {
        e.rules.dynamicrange = e.params,
        null != e.message && ($.validator.messages.dynamicrange = e.message)
    }),
    $.validator.addMethod("dynamicrange", function(e, t, n) {
        var i = (a = t.name).substr(0, a.lastIndexOf(".") + 1)
          , a = parseInt($('input[name="' + r(n.minvalueproperty, i) + '"]').val(), 10)
          , i = parseInt($('input[name="' + r(n.maxvalueproperty, i) + '"]').val(), 10)
          , e = parseInt(e, 10);
        return !(isNaN(a) || isNaN(i) || isNaN(e) || e < a || i < e) || ($.validator.messages.dynamicrange = $.format($(t).attr("data-val-dynamicrange"), a, i),
        !1)
    }, "")
}(),
function(r) {
    r.fn.radiobuttonEnable = function() {
        return this.each(function() {
            var i = r(this);
            i.find("*[data-rb-enable-name]").each(function() {
                var e, t = r(this), n = i.find('input:radio[name="' + t.data("rbEnableName") + '"]:checked');
                0 < n.length && (null != (e = t.data("rbEnableValue")) && n.val().toString().toLowerCase() != e.toString().toLowerCase() && t.attr("disabled", "disabled"),
                null != (e = t.data("rbMakeVisibleValue")) && n.val().toString().toLowerCase() != e.toString().toLowerCase() && t.hide())
            }),
            i.find("input:radio").on("change", function() {
                var i = r(this)
                  , e = '[data-rb-enable-name="' + i.attr("name") + '"]';
                r(e).each(function() {
                    var e = r(this)
                      , t = tinymce.editors[e[0].id]
                      , n = e.data("rbEnableValue");
                    null != n && (n.toString().toLowerCase() == i.val().toLowerCase() ? (e.removeAttr("disabled"),
                    t && t.getBody().setAttribute("contenteditable", !0)) : (e.attr("disabled", "disabled"),
                    t && t.getBody().setAttribute("contenteditable", !1))),
                    null != (n = e.data("rbMakeVisibleValue")) && (n.toString().toLowerCase() == i.val().toLowerCase() && !e.is(":visible") || n.toString().toLowerCase() != i.val().toLowerCase() && e.is(":visible")) && e.fadeToggle()
                })
            })
        })
    }
    ,
    r.fn.configureSCMForm = function(e) {
        var n = r.extend({
            cancelButtonSelector: ".cancel",
            submitButtonSelector: ".submit",
            nextQuestionButtonSelector: ".nextQuestion",
            skipButtonSelector: ".skip",
            validatorIgnores: ":disabled, input[type='hidden']",
            nextQuestion: null,
            cancel: null,
            skip: null,
            validateOnSubmit: null,
            validateOnKeyUp: !1
        }, e);
        return this.each(function() {
            var t = r(this);
            jQuery.validator.unobtrusive.parse("#" + this.id),
            t.validate();
            var e = r.data(t[0], "validator").settings;
            e.ignore = n.validatorIgnores,
            !0 === n.validateOnKeyUp && (n.validateOnKeyUp = null),
            e.onkeyup = n.validateOnKeyUp,
            e.onsubmit = n.validateOnSubmit,
            t.find(n.submitButtonSelector).off("click.configureSCMForm").on("click.configureSCMForm", function(e) {
                e.preventDefault(),
                t.valid() && t.trigger("submit")
            }),
            t.find(n.nextQuestionButtonSelector).off("click.configureSCMForm").on("click.configureSCMForm", function(e) {
                e.preventDefault(),
                n.nextQuestion()
            }),
            t.find(n.skipButtonSelector).off("click.configureSCMForm").on("click.configureSCMForm", function(e) {
                e.preventDefault(),
                n.skip()
            }),
            t.find(n.cancelButtonSelector).off("click.configureSCMForm").on("click.configureSCMForm", function(e) {
                e.preventDefault(),
                n.cancel ? n.cancel() : (t.hide(),
                SCM.hideModal())
            })
        })
    }
    ,
    r.fn.viewMore = function(e) {
        var n = r.extend({
            hiddenSelector: ".read-more",
            readMoreButtonSelector: "#readMore",
            readMoreText: "Read More",
            readLessText: "Read Less"
        }, e);
        return this.each(function() {
            var t = r(n.hiddenSelector);
            t.hide(),
            r(n.readMoreButtonSelector).on("click", function(e) {
                e.preventDefault(),
                t.fadeToggle()
            })
        })
    }
    ,
    r.fn.scmTinyMCE = function() {
        return r(".mceOpen.mce_forecolor").show(),
        r(".mce_forecolor .mceLast .mceIconOnly").show(),
        r(".mceOpen.mce_backcolor").show(),
        r(".mceOpen.mce_backcolor .mceIconOnly").show(),
        this.each(function() {
            r(this).tinymce({
                gecko_spellcheck: !0,
                theme: "advanced",
                theme_advanced_buttons1: "bold,italic,underline,|,bullist,numlist,|,sub,sup,|,charmap,|,forecolor,backcolor,|,link",
                theme_advanced_buttons2: "",
                theme_advanced_buttons3: "",
                plugins: "inlinepopups",
                theme_advanced_statusbar_location: null,
                oninit: function(e) {
                    var t = r("#" + e.editorId + "[data-rb-enable-name]")
                      , e = r('input:radio[name="' + t.data("rbEnableName") + '"]');
                    0 < e.length && e.val().toString().toLowerCase() != t.data("rbEnableValue").toString().toLowerCase() && (t.attr("disabled", "disabled"),
                    (t = tinymce.editors[t[0].id]) && t.getBody().setAttribute("contenteditable", !1))
                }
            })
        })
    }
    ,
    r.fn.scmTimer = function(t) {
        return this.each(function() {
            var e, n, i, a = r(this), o = r.extend({
                h: 0,
                m: 0,
                s: 0,
                hs: 0,
                stop: !1,
                milliseconds: 150,
                intervalCheck: null
            }, t);
            o.stop ? clearInterval(a.data("scmTimerToken")) : (e = function(e) {
                return e < 10 && (e = "0" + e),
                e
            }
            ,
            n = (new Date).getTime(),
            (i = function() {
                a.text(e(o.h) + ":" + e(o.m) + ":" + e(o.s) + ":" + e(o.hs))
            }
            )(),
            a.data("scmTimerToken", setInterval(function() {
                var e, t;
                a.is(":visible") ? (t = (e = (new Date).getTime()) - n,
                o.hs += Math.floor(t / 10),
                n = e,
                100 <= o.hs && (o.s += Math.floor(o.hs / 100),
                o.hs = o.hs % 100,
                60 <= o.s && (o.m += Math.floor(o.s / 60),
                o.s = o.s % 60),
                60 <= o.m && (o.h += Math.floor(o.m / 60),
                o.m = o.m % 60)),
                i(),
                o.intervalCheck && (o.intervalCheck(o) || clearInterval(a.data("scmTimerToken")))) : clearInterval(a.data("scmTimerToken"))
            }, o.milliseconds)))
        })
    }
    ,
    r.fn.wkTimer = function(t) {
        return this.each(function() {
            var e, n, i, a = r(this), o = r.extend({
                h: 0,
                m: 0,
                s: 0,
                hs: 0,
                stop: !1,
                milliseconds: 150,
                intervalCheck: null
            }, t);
            o.stop ? clearInterval(a.data("wkTimerToken")) : (e = function(e) {
                return e < 10 && (e = "0" + e),
                e
            }
            ,
            n = (new Date).getTime(),
            (i = function() {
                a.text(e(o.m) + ":" + e(o.s))
            }
            )(),
            a.data("wkTimerToken", setInterval(function() {
                var e, t;
                a.is(":visible") ? (t = (e = (new Date).getTime()) - n,
                o.hs += Math.floor(t / 10),
                n = e,
                100 <= o.hs && (o.s += Math.floor(o.hs / 100),
                o.hs = o.hs % 100,
                60 <= o.s && (o.m += Math.floor(o.s / 60),
                o.s = o.s % 60),
                60 <= o.m && (o.h += Math.floor(o.m / 60),
                o.m = o.m % 60)),
                i(),
                o.intervalCheck && (o.intervalCheck(o) || clearInterval(a.data("wkTimerToken")))) : clearInterval(a.data("wkTimerToken"))
            }, o.milliseconds)))
        })
    }
}(jQuery);
var SCM = SCM || {};
SCM.__namespace = !0,
SCM.eventManager = function(o) {
    function e(e, t) {
        return o.pubsub("subscribe", e, t)
    }
    function n(e, t) {
        o.pubsub("publish", e, t)
    }
    function i(n, i) {
        return e(s, function(e, t) {
            n === t.actionEnum && i(t.data)
        })
    }
    var a = "actionCompleted"
      , r = function(n, i) {
        return e(a, function(e, t) {
            n === t.actionEnum && i(t)
        })
    }
      , s = "actionCompleteactionRequest";
    return {
        subscribeWidgetRefresh: function(e, t) {
            var i = o.extend({
                refreshWhenInvisible: !1,
                messageContainerSelector: "#divMessage"
            }, t)
              , a = ""
              , a = r(e, function(t) {
                var n;
                i.refreshIf && !i.refreshIf(t) || (n = o(i.containerSelector),
                (i.refreshWhenInvisible || n.is(":visible")) && o.ajax({
                    type: "POST",
                    url: i.url,
                    data: i.data,
                    dataType: "html",
                    success: function(e) {
                        o.pubsub("unsubscribe", a),
                        n.replaceWith(e).show(),
                        i.refreshSuccess && i.refreshSuccess(t)
                    }
                }))
            })
        },
        subscribe: e,
        publish: n,
        publishActionCompleted: function(e, t) {
            t = o.extend({
                actionEnum: e
            }, t);
            n(a, t)
        },
        subscribeActionCompleted: r,
        publishActionRequest: function(e, t) {
            return n(s, {
                actionEnum: e,
                data: t
            })
        },
        subscribeActionRequest: i,
        subscribeActionRequestDisplayResult: function(e, t) {
            return i(e, function(e) {
                e = o.extend({
                    type: "POST"
                }, e);
                o.ajax({
                    type: e.type,
                    url: e.url,
                    data: e.data,
                    dataType: "html",
                    success: function(e) {
                        o(t).html(e).show()
                    },
                    error: function(e) {
                        alert(e)
                    }
                }),
                SCM.hideModal()
            })
        }
    }
}(jQuery),
SCM.eventManager.subscriptionMessages = {
    playVideo: "SCM.PlayVideo"
};
var SCM = SCM || {};
!function(e, t) {
    var i = {}
      , a = i.hasOwnProperty;
    e.subscribe = function(e, t) {
        a.call(i, e) || (i[e] = []);
        var n = i[e].push(t) - 1;
        return {
            remove: function() {
                delete i[e][n]
            }
        }
    }
    ,
    e.publish = function(e, n) {
        a.call(i, e) && t.each(i[e], function(e, t) {
            t(void 0 !== n ? n : {})
        })
    }
}(SCM.EventEmitter = SCM.EventEmitter || {}, jQuery);
var SCM = SCM || {};
!function(pdf, $) {
    function formatIssuePurchaseLink(e, t) {
        var n = e;
        return 0 <= e.toLowerCase().indexOf("resourceid=") && (n = e.replace(/resourceID=\{0\}|resourceID=\d+/i, "resourceid=" + t)),
        n
    }
    function logErrors(jqXHR, textStatus, errorThrown) {
        var err;
        window.console && (err = eval("(" + jqXHR.responseText + ")"),
        console.log("error: " + err),
        console.log("status: " + textStatus))
    }
    function openPDF(e) {
        window.location.href = e
    }
    function openNoAccessModalArticle(e, t) {
        e.attr({
            "data-reveal-id": "noAccessReveal",
            "data-reveal": ""
        }).removeAttr("data-ajax-url");
        t = "/article.aspx?articleid=" + t + "#purchaseSubscriptionBox";
        pdf.$noAccessModal.find("#articleLinkToPurchase").attr("href", t),
        pdf.$noAccessModal.foundation("reveal", "open")
    }
    function openNoAccessModalArticleSeo(e, t, n) {
        e.attr({
            "data-reveal-id": "noAccessReveal",
            "data-reveal": ""
        }).removeAttr("data-ajax-url"),
        "DO_NOT_USE" === n ? pdf.$noAccessModal.find("#articleLinkToPurchase").remove() : (n = n,
        pdf.$noAccessModal.find("#articleLinkToPurchase").attr("href", n)),
        pdf.$noAccessModal.foundation("reveal", "open")
    }
    function openNoAccessModalIssue(e, t) {
        t = formatIssuePurchaseLink(e, t);
        pdf.$noAccessModal.find(".aIssuePurchaseLink").attr("href", t),
        pdf.$noAccessModal.foundation("reveal", "open")
    }
    pdf.$noAccessModal = $("#noAccessReveal"),
    pdf.checkArticlePDFAccess = function(t) {
        var n = t.attr("data-article-id")
          , i = t.attr("data-article-url")
          , e = t.attr("data-ajax-url")
          , a = $("#hfSiteURL")
          , o = "";
        null !== t.attr("data-article-seo-url") && (o = t.attr("data-article-seo-url")),
        void 0 !== a && void 0 !== a.val() && "" !== a && (e = "//" + a.val() + e);
        a = {};
        a.aId = n,
        $.ajax({
            type: "POST",
            url: e,
            data: a,
            traditional: !0,
            success: function(e) {
                e.Success ? openPDF(i) : 0 < o.length ? openNoAccessModalArticleSeo(t, n, o) : openNoAccessModalArticle(t, n)
            },
            error: function(e, t, n) {
                logErrors(e, t, n)
            }
        })
    }
    ,
    pdf.checkIssuePDFAccess = function(e) {
        var t = e.attr("data-issue-id")
          , n = e.attr("data-issue-url")
          , e = e.attr("data-ajax-issue-url")
          , i = pdf.$noAccessModal.find(".aIssuePurchaseLink").attr("href");
        -1 < n.toLowerCase().indexOf("/toc.pdf") ? window.location.href = n : $.ajax({
            type: "POST",
            url: e,
            data: {
                issueId: t
            },
            traditional: !0,
            success: function(e) {
                e.Success ? openPDF(n) : openNoAccessModalIssue(i, t)
            },
            error: function(e, t, n) {
                logErrors(e, t, n)
            }
        })
    }
    ,
    pdf.bindUiEvents = function() {
        $(document).on("click", ".al-link.pdfaccess", function() {
            $(document).foundation(),
            pdf.$noAccessModal.foundation("reveal", "close"),
            pdf.$noAccessModal.find("#articleLinkToPurchase").show(),
            pdf.$noAccessModal.find(".issue-purchase-modal").hide(),
            $(this).attr("data-reveal-id") || pdf.checkArticlePDFAccess($(this))
        }),
        $(document).on("click", ".close-reveal-modal", function() {
            try {
                $(this).parents(".reveal-modal").foundation("reveal", "close")
            } catch (e) {
                console.log("Foundation error - pdfaccess : " + e)
            }
        }),
        $(document).on("click", ".al-link.issue-pdfLink", function() {
            pdf.$noAccessModal.foundation("reveal", "close"),
            pdf.$noAccessModal.find("#articleLinkToPurchase").hide(),
            pdf.$noAccessModal.find(".issue-purchase-modal").show(),
            pdf.checkIssuePDFAccess($(this))
        })
    }
    ,
    pdf.init = function() {
        pdf.bindUiEvents()
    }
}(SCM.PDFAccess = SCM.PDFAccess || {}, jQuery);
var SCM = SCM || {};
SCM.Supplements = SCM.Supplements || {},
SCM.Supplements.updateIssueSupplementsOnChange = function() {
    $(".js-supplements-select").on("change", function() {
        window.location.href = $(this).val()
    })
}
,
SCM.Supplements.updateIssueSupplementsOnChange();
var SCM = SCM || {};
!function(e, u, n, h) {
    var t = u("#Toolbar")
      , i = u("#ViewsDrop")
      , a = u("#ShareDrop")
      , o = u("#ToolsDrop");
    function r() {
        var t, e;
        u(".tab-item").parent("li").show(),
        u(".tabs-content").length && (t = "",
        u(".tabs-content > .content").each(function() {
            var e = u(this);
            e.hasClass("active") && (t = e.attr("id"))
        }),
        u("#ViewsDrop li").show(),
        u("#ViewsDrop").find('[data-tab="#' + t + '"]').closest("li").hide()),
        (e = u(".item-with-dropdown:visible")).show(),
        e.each(function() {
            var e = !1
              , t = u(this);
            t.find("ul li, .js-article-content-filter").each(function() {
                (t.is(":visible") || "none" !== t.css("display")) && (e = !0)
            }),
            e || t.hide()
        })
    }
    function s(e, t) {
        var a, o, r, s, l, c, d;
        u(e, "#ContentTab").length && (a = u('.widget-items[data-widgetname="' + t + '"]').children(),
        t = i.children(".js-article-content-filter"),
        u("#ContentTabFilteredView"),
        t.filter('[data-content-filter="article-content"]').hide(),
        0 === (o = a.filter(".table-wrap, .fig-section, .figure-title").add(a.has(".table-wrap, .fig-section"))).length && t.remove('[data-content-filter="figures-tables"]'),
        0 === (r = a.filter(".video-section")).length && t.remove('[data-content-filter="video"]'),
        0 === (s = a.filter(".audio-section")).length && t.remove('[data-content-filter="audio"]'),
        0 === (l = a.has(".widget-ArticleDataSupplements, .supplementary-material")).length && t.remove('[data-content-filter="supplementary-data"]'),
        c = u("#ContentTab").find(".js-download-images-ppt"),
        d = u("#ContentTab").find("div.comments"),
        t.on("click", function() {
            var e = u(this).attr("data-content-filter")
              , t = u("#endNotesTargetLocation")
              , n = u('.js-article-content-filter[data-content-filter="' + e + '"]');
            n.hide(),
            n.siblings().show();
            var i, n = u(".article-metadata-standalone-panel");
            "figures-tables" === e ? i = o : "video" === e ? i = r : "audio" === e ? i = s : "supplementary-data" === e && (i = l),
            i !== h && null !== i && i.length ? (a.hide(),
            l.hide(),
            i.show(),
            d.hide(),
            (i = i).filter(".fig-section:not(:has(a[restricted]))").length || i.find(".fig-section:not(:has(a[restricted]))").length ? c.show() : c.hide(),
            t.length && t.hide()) : (a.show(),
            0 < n.children().length ? n.show() : n.hide(),
            l.show(),
            d.show(),
            c.hide(),
            t.length && t.show()),
            SCM.SiteJS.restrictedImages()
        }))
    }
    function l() {
        u("hypothesis-sidebar:visible").length ? u("hypothesis-sidebar").css("display", "none") : (u(".site-menu-lvl-0").find(".site-menu:visible").slideToggle("fast"),
        u(".f-dropdown:visible").slideToggle("fast"),
        u(".js-login-box-placeholder").addClass("hide"),
        u("hypothesis-sidebar").css("display", "block"),
        u("[data-hypothesis-trigger]").click())
    }
    function c(e) {
        var t, n;
        return (t = "Toolbar__sidebar-toggle",
        n = h,
        !(e = e).originalEvent || (e = e.originalEvent.composedPath ? e.originalEvent.composedPath() : h) !== h && (n = e.find(function(e) {
            return e.className === t
        })),
        n) !== h
    }
    function d(e) {
        var t;
        "hypothesis-sidebar" === e.target.localName && c(e) ? u("hypothesis-sidebar").css("display", "none") : (t = u(e.target),
        e.target.localName.startsWith("hypothesis") ? (u("hypothesis-sidebar").css("display", "block"),
        u("[data-hypothesis-trigger]").click()) : t.attr("data-hypothesis-trigger") !== h || t.hasClass("js-annotate") || u("hypothesis-sidebar").css("display", "none"))
    }
    e.closeDropDownIfChildItemClicked = function() {
        u("#Toolbar .f-dropdown > li").on("click", function() {
            u(this).closest(".toolbar-item").trigger("click")
        })
    }
    ,
    e.removeTabLinkIfTabIsEmpty = function(e) {
        u(e).find(".tab-trigger").each(function() {
            var e = u(this)
              , t = e.attr("data-tab");
            "#ContentTab" !== t && u(t).find("*").length < 20 && (0 === ((t = u(t).html()) !== h ? u.trim(t.replace(/(<([^>]+)>)/gi, "")) : 1).length && e.parent("li").remove())
        })
    }
    ,
    e.hideTabIfDropdownIsEmpty = function() {
        for (var e = [a, o], t = 0; t < e.length; t++) {
            var n = e[t];
            n.children("li").length < 1 && n.parent().hide()
        }
        i.children(".js-article-content-filter").length < 2 && i.parent().hide()
    }
    ,
    e.toggleTabContent = function() {
        u(".tab-trigger").on("click", function(e) {
            e.preventDefault();
            var t = u(this).attr("data-tab")
              , e = u(t);
            e.siblings().removeClass("active"),
            e.addClass("active"),
            "#FigureTab" === t && n.trigger("scroll"),
            r()
        })
    }
    ,
    e.adjustToolbarMargins = function() {
        6 < u(".toolbar-item:visible").length && (u(".toolbar-item").css("marginRight", ".65em"),
        u(".toolbar-item:last-child").css("margin-right", "0"))
    }
    ,
    e.styleToolbarStates = function() {
        t.on("click", ".toolbar-item", function() {
            var e = u(this);
            e.addClass("clicked"),
            e.siblings().removeClass("clicked")
        });
        var e = u(".toolbar-item");
        n.on("click", function() {
            e.each(function() {
                var e = u(this);
                e.find("ul").hasClass("open") || e.removeClass("clicked")
            })
        }),
        u.map(e, function(e) {
            e.children.length || e.classList.add("no-children")
        })
    }
    ,
    e.initArticleContentFilter = function() {
        u(document.body).hasClass("pg_ChapterStandard") ? s(".widget-BookSectionsText", "BookSectionsText") : s(".widget-ArticleFulltext", "ArticleFulltext")
    }
    ,
    e.closeHypothesis = function() {
        u("hypothesis-sidebar").css("display", "none")
    }
    ,
    e.registerAnnotateLink = function() {
        u(".js-annotate").off("click").on("click", function() {
            l()
        })
    }
    ,
    e.hypothesisConfig = function() {
        u(".js-annotate").length && (e.registerAnnotateLink(),
        SCM.Retry.policy().handleResult(function(e) {
            return !e
        }).waitAndRetry(5, 500).execute(function() {
            return u("hypothesis-sidebar:visible").length
        }).then(function(e) {
            u("hypothesis-sidebar").css("display", "none")
        }).catch(function(e) {
            console.error("Timed out waiting for Hypothes.is to be ready.")
        }),
        u(document).on("click", d),
        window.hypothesisConfig = function() {
            return {
                openSidebar: !0,
                onLayoutChange: function(e) {
                    e.width < 50 && 0 !== e.width && u("hypothesis-sidebar:visible").length && u("[data-hypothesis-trigger]").click()
                }
            }
        }
        )
    }
    ,
    e.init = function() {
        t.length && (r(),
        e.removeTabLinkIfTabIsEmpty(i),
        e.styleToolbarStates(),
        e.toggleTabContent(),
        e.initArticleContentFilter(),
        e.hideTabIfDropdownIsEmpty(),
        e.hypothesisConfig(),
        e.adjustToolbarMargins()),
        SCM.CitationModal.enableCitationDownloadOnFormatSelect()
    }
}(SCM.Toolbar = SCM.Toolbar || {}, jQuery, $(document)),
function(e) {
    "use strict";
    e.Placeholders = {
        Utils: {
            addEventListener: function(e, t, n) {
                return e.addEventListener ? e.addEventListener(t, n, !1) : e.attachEvent ? e.attachEvent("on" + t, n) : void 0
            },
            inArray: function(e, t) {
                for (var n = 0, i = e.length; n < i; n++)
                    if (e[n] === t)
                        return !0;
                return !1
            },
            moveCaret: function(e, t) {
                var n;
                e.createTextRange ? ((n = e.createTextRange()).move("character", t),
                n.select()) : e.selectionStart && (e.focus(),
                e.setSelectionRange(t, t))
            },
            changeType: function(e, t) {
                try {
                    return e.type = t,
                    !0
                } catch (e) {
                    return !1
                }
            }
        }
    }
}(this),
function(e) {
    "use strict";
    function t() {}
    function s() {
        try {
            return document.activeElement
        } catch (e) {}
    }
    function l(e, t) {
        var n = !!t && e.value !== t
          , t = e.value === e.getAttribute(k);
        return (n || t) && "true" === e.getAttribute(x) && (e.removeAttribute(x),
        e.value = e.value.replace(e.getAttribute(k), ""),
        e.className = e.className.replace(C, ""),
        t = e.getAttribute(A),
        0 <= parseInt(t, 10) && (e.setAttribute("maxLength", t),
        e.removeAttribute(A)),
        (t = e.getAttribute(M)) && (e.type = t),
        !0)
    }
    function c(e) {
        var t = e.getAttribute(k);
        return !("" !== e.value || !t) && (e.setAttribute(x, "true"),
        e.value = t,
        e.className += " " + w,
        e.getAttribute(A) || (e.setAttribute(A, e.maxLength),
        e.removeAttribute("maxLength")),
        e.getAttribute(M) ? e.type = "text" : "password" === e.type && E.changeType(e, "text") && e.setAttribute(M, "password"),
        !0)
    }
    function n(e, t) {
        var n, i, a, o, r;
        if (e && e.getAttribute(k))
            t(e);
        else
            for (i = e ? e.getElementsByTagName("input") : u,
            a = e ? e.getElementsByTagName("textarea") : h,
            r = 0,
            o = (n = i ? i.length : 0) + (a ? a.length : 0); r < o; r++)
                t(r < n ? i[r] : a[r - n])
    }
    function d(e) {
        n(e, l)
    }
    function i(e) {
        var t, n, i, a, o, r;
        e.form && ("string" == typeof (m = e.form) && (m = document.getElementById(m)),
        m.getAttribute(j) || (E.addEventListener(m, "submit", (r = m,
        function() {
            d(r)
        }
        )),
        m.setAttribute(j, "true"))),
        E.addEventListener(e, "focus", (o = e,
        function() {
            f && o.value === o.getAttribute(k) && "true" === o.getAttribute(x) ? E.moveCaret(o, 0) : l(o)
        }
        )),
        E.addEventListener(e, "blur", (a = e,
        function() {
            c(a)
        }
        )),
        f && (E.addEventListener(e, "keydown", (i = e,
        function(e) {
            return p = i.value,
            "true" === i.getAttribute(x) && p === i.getAttribute(k) && E.inArray(S, e.keyCode) ? (e.preventDefault && e.preventDefault(),
            !1) : void 0
        }
        )),
        E.addEventListener(e, "keyup", (n = e,
        function() {
            l(n, p),
            "" === n.value && (n.blur(),
            E.moveCaret(n, 0))
        }
        )),
        E.addEventListener(e, "click", (t = e,
        function() {
            t === s() && t.value === t.getAttribute(k) && "true" === t.getAttribute(x) && E.moveCaret(t, 0)
        }
        ))),
        e.setAttribute(T, "true"),
        e.setAttribute(k, g),
        !f && e === s() || c(e)
    }
    var u, h, f, a, p, g, o, m, r, v, b, y = ["text", "search", "url", "tel", "email", "password", "number", "textarea"], S = [27, 33, 34, 35, 36, 37, 38, 39, 40, 8, 46], w = "placeholdersjs", C = RegExp("(?:^|\\s)" + w + "(?!\\S)"), k = "data-placeholder-value", x = "data-placeholder-active", M = "data-placeholder-type", j = "data-placeholder-submit", T = "data-placeholder-bound", A = "data-placeholder-maxlength", $ = document.createElement("input"), I = document.getElementsByTagName("head")[0], F = document.documentElement, _ = e.Placeholders, E = _.Utils;
    if (_.nativeSupport = void 0 !== $.placeholder,
    !_.nativeSupport) {
        for (u = document.getElementsByTagName("input"),
        h = document.getElementsByTagName("textarea"),
        f = "false" === F.getAttribute("data-placeholder-focus"),
        a = "false" !== F.getAttribute("data-placeholder-live"),
        ($ = document.createElement("style")).type = "text/css",
        F = document.createTextNode("." + w + " { color:#ccc; }"),
        $.styleSheet ? $.styleSheet.cssText = F.nodeValue : $.appendChild(F),
        I.insertBefore($, I.firstChild),
        b = 0,
        v = u.length + h.length; b < v; b++)
            r = u.length > b ? u[b] : h[b - u.length],
            (g = r.attributes.placeholder) && ((g = g.nodeValue) && E.inArray(y, r.type) && i(r));
        o = setInterval(function() {
            for (b = 0,
            v = u.length + h.length; b < v; b++)
                r = u.length > b ? u[b] : h[b - u.length],
                (g = r.attributes.placeholder) ? (g = g.nodeValue) && E.inArray(y, r.type) && (r.getAttribute(T) || i(r),
                g === r.getAttribute(k) && ("password" !== r.type || r.getAttribute(M)) || ("password" === r.type && !r.getAttribute(M) && E.changeType(r, "text") && r.setAttribute(M, "password"),
                r.value === r.getAttribute(k) && (r.value = g),
                r.setAttribute(k, g))) : r.getAttribute(x) && (l(r),
                r.removeAttribute(k));
            a || clearInterval(o)
        }, 100)
    }
    E.addEventListener(e, "beforeunload", function() {
        _.disable()
    }),
    _.disable = _.nativeSupport ? t : d,
    _.enable = _.nativeSupport ? t : function(e) {
        n(e, c)
    }
}(this),
function(e) {
    "function" == typeof define && define.amd ? define(["jquery"], e) : "object" == typeof exports ? module.exports = e(require("jquery")) : e(jQuery)
}(function(be) {
    be.fn.jScrollPane = function(n) {
        function i(y, e) {
            function S(e) {
                var t, n, i, a, o, r, s, l, c, d, u, h, f, p, g, m = !1, v = !1;
                if (U = e,
                void 0 === P)
                    i = y.scrollTop(),
                    a = y.scrollLeft(),
                    y.css({
                        overflow: "hidden",
                        padding: 0
                    }),
                    O = y.innerWidth() + ve,
                    N = y.innerHeight(),
                    y.width(O),
                    P = be('<div class="jspPane" />').css("padding", fe).append(y.children()),
                    B = be('<div class="jspContainer" />').css({
                        width: O + "px",
                        height: N + "px"
                    }).append(P).appendTo(y);
                else {
                    if (y.css("width", ""),
                    m = U.stickToBottom && (20 < (r = H - N) && r - R() < 10),
                    v = U.stickToRight && (20 < (o = q - O) && o - L() < 10),
                    (r = y.innerWidth() + ve != O || y.outerHeight() != N) && (O = y.innerWidth() + ve,
                    N = y.innerHeight(),
                    B.css({
                        width: O + "px",
                        height: N + "px"
                    })),
                    !r && pe == q && P.outerHeight() == H)
                        return y.width(O),
                        0;
                    pe = q,
                    P.css("width", ""),
                    y.width(O),
                    B.find(">.jspVerticalBar,>.jspHorizontalBar").remove().end()
                }
                function b() {
                    var e = Z
                      , t = X;
                    switch (s) {
                    case 40:
                        ge.scrollByY(U.keyboardSpeed, !1);
                        break;
                    case 38:
                        ge.scrollByY(-U.keyboardSpeed, !1);
                        break;
                    case 34:
                    case 32:
                        ge.scrollByY(N * U.scrollPagePercent, !1);
                        break;
                    case 33:
                        ge.scrollByY(-N * U.scrollPagePercent, !1);
                        break;
                    case 39:
                        ge.scrollByX(U.keyboardSpeed, !1);
                        break;
                    case 37:
                        ge.scrollByX(-U.keyboardSpeed, !1)
                    }
                    return l = e != Z || t != X
                }
                P.css("overflow", "auto"),
                q = e.contentWidth || P[0].scrollWidth,
                H = P[0].scrollHeight,
                P.css("overflow", ""),
                J = 1 < (W = H / N),
                (z = 1 < (V = q / O)) || J ? (y.addClass("jspScrollable"),
                (o = U.maintainPosition && (X || Z)) && (t = L(),
                n = R()),
                J && (B.append(be('<div class="jspVerticalBar" />').append(be('<div class="jspCap jspCapTop" />'), be('<div class="jspTrack" />').append(be('<div class="jspDrag" />').append(be('<div class="jspDragTop" />'), be('<div class="jspDragBottom" />'))), be('<div class="jspCap jspCapBottom" />'))),
                ee = B.find(">.jspVerticalBar"),
                te = ee.find(">.jspTrack"),
                Q = te.find(">.jspDrag"),
                U.showArrows && (ae = be('<a class="jspArrow jspArrowUp" />').bind("mousedown.jsp", x(0, -1)).bind("click.jsp", D),
                oe = be('<a class="jspArrow jspArrowDown" />').bind("mousedown.jsp", x(0, 1)).bind("click.jsp", D),
                U.arrowScrollOnHover && (ae.bind("mouseover.jsp", x(0, -1, ae)),
                oe.bind("mouseover.jsp", x(0, 1, oe))),
                k(te, U.verticalArrowPositions, ae, oe)),
                ne = N,
                B.find(">.jspVerticalBar>.jspCap:visible,>.jspVerticalBar>.jspArrow").each(function() {
                    ne -= be(this).outerHeight()
                }),
                Q.hover(function() {
                    Q.addClass("jspHover")
                }, function() {
                    Q.removeClass("jspHover")
                }).bind("mousedown.jsp", function(e) {
                    be("html").bind("dragstart.jsp selectstart.jsp", D),
                    Q.addClass("jspActive");
                    var t = e.pageY - Q.position().top;
                    return be("html").bind("mousemove.jsp", function(e) {
                        T(e.pageY - t, !1)
                    }).bind("mouseup.jsp mouseleave.jsp", j),
                    !1
                }),
                w()),
                z && (B.append(be('<div class="jspHorizontalBar" />').append(be('<div class="jspCap jspCapLeft" />'), be('<div class="jspTrack" />').append(be('<div class="jspDrag" />').append(be('<div class="jspDragLeft" />'), be('<div class="jspDragRight" />'))), be('<div class="jspCap jspCapRight" />'))),
                re = B.find(">.jspHorizontalBar"),
                se = re.find(">.jspTrack"),
                Y = se.find(">.jspDrag"),
                U.showArrows && (de = be('<a class="jspArrow jspArrowLeft" />').bind("mousedown.jsp", x(-1, 0)).bind("click.jsp", D),
                ue = be('<a class="jspArrow jspArrowRight" />').bind("mousedown.jsp", x(1, 0)).bind("click.jsp", D),
                U.arrowScrollOnHover && (de.bind("mouseover.jsp", x(-1, 0, de)),
                ue.bind("mouseover.jsp", x(1, 0, ue))),
                k(se, U.horizontalArrowPositions, de, ue)),
                Y.hover(function() {
                    Y.addClass("jspHover")
                }, function() {
                    Y.removeClass("jspHover")
                }).bind("mousedown.jsp", function(e) {
                    be("html").bind("dragstart.jsp selectstart.jsp", D),
                    Y.addClass("jspActive");
                    var t = e.pageX - Y.position().left;
                    return be("html").bind("mousemove.jsp", function(e) {
                        $(e.pageX - t, !1)
                    }).bind("mouseup.jsp mouseleave.jsp", j),
                    !1
                }),
                le = B.innerWidth(),
                C()),
                z && J && (r = se.outerHeight(),
                e = te.outerWidth(),
                ne -= r,
                be(re).find(">.jspCap:visible,>.jspArrow").each(function() {
                    le += be(this).outerWidth()
                }),
                le -= e,
                N -= e,
                O -= r,
                se.parent().append(be('<div class="jspCorner" />').css("width", r + "px")),
                w(),
                C()),
                z && P.width(B.outerWidth() - ve + "px"),
                H = P.outerHeight(),
                W = H / N,
                z && ((ce = Math.ceil(1 / V * le)) > U.horizontalDragMaxWidth ? ce = U.horizontalDragMaxWidth : ce < U.horizontalDragMinWidth && (ce = U.horizontalDragMinWidth),
                Y.width(ce + "px"),
                K = le - ce,
                I(Z)),
                J && ((ie = Math.ceil(1 / W * ne)) > U.verticalDragMaxHeight ? ie = U.verticalDragMaxHeight : ie < U.verticalDragMinHeight && (ie = U.verticalDragMinHeight),
                Q.height(ie + "px"),
                G = ne - ie,
                A(X)),
                o && (_(v ? q - O : t, !1),
                F(m ? H - N : n, !1)),
                P.find(":input,a").unbind("focus.jsp").bind("focus.jsp", function(e) {
                    E(e.target, !1)
                }),
                B.unbind(me).bind(me, function(e, t, n, i) {
                    var a = Z = Z || 0
                      , o = X = X || 0
                      , e = e.deltaFactor || U.mouseWheelSpeed;
                    return ge.scrollBy(n * e, -i * e, !1),
                    a == Z && o == X
                }),
                g = !1,
                B.unbind("touchstart.jsp touchmove.jsp touchend.jsp click.jsp-touchclick").bind("touchstart.jsp", function(e) {
                    e = e.originalEvent.touches[0];
                    d = L(),
                    u = R(),
                    h = e.pageX,
                    f = e.pageY,
                    g = !(p = !1)
                }).bind("touchmove.jsp", function(e) {
                    if (g) {
                        var t = e.originalEvent.touches[0]
                          , n = Z
                          , e = X;
                        return ge.scrollTo(d + h - t.pageX, u + f - t.pageY),
                        p = p || 5 < Math.abs(h - t.pageX) || 5 < Math.abs(f - t.pageY),
                        n == Z && e == X
                    }
                }).bind("touchend.jsp", function() {
                    g = !1
                }).bind("click.jsp-touchclick", function() {
                    return p ? p = !1 : void 0
                }),
                U.enableKeyboardNavigation && (c = [],
                z && c.push(re[0]),
                J && c.push(ee[0]),
                P.bind("focus.jsp", function() {
                    y.focus()
                }),
                y.attr("tabindex", 0).unbind("keydown.jsp keypress.jsp").bind("keydown.jsp", function(e) {
                    if (e.target === this || c.length && be(e.target).closest(c).length) {
                        var t = Z
                          , n = X;
                        switch (e.keyCode) {
                        case 40:
                        case 38:
                        case 34:
                        case 32:
                        case 33:
                        case 39:
                        case 37:
                            s = e.keyCode,
                            b();
                            break;
                        case 35:
                            F(H - N),
                            s = null;
                            break;
                        case 36:
                            F(0),
                            s = null
                        }
                        return !(l = e.keyCode == s && t != Z || n != X)
                    }
                }).bind("keypress.jsp", function(e) {
                    return e.keyCode == s && b(),
                    e.target === this || c.length && be(e.target).closest(c).length ? !l : void 0
                }),
                U.hideFocus ? (y.css("outline", "none"),
                "hideFocus"in B[0] && y.attr("hideFocus", !0)) : (y.css("outline", ""),
                "hideFocus"in B[0] && y.attr("hideFocus", !1))),
                U.clickOnTrack && (M(),
                J && te.bind("mousedown.jsp", function(i) {
                    if (void 0 === i.originalTarget || i.originalTarget == i.currentTarget) {
                        var a, o = be(this), e = o.offset(), r = i.pageY - e.top - X, s = !0, l = function() {
                            var e = o.offset()
                              , t = i.pageY - e.top - ie / 2
                              , n = N * U.scrollPagePercent
                              , e = G * n / (H - N);
                            if (r < 0)
                                t < X - e ? ge.scrollByY(-n) : T(t);
                            else {
                                if (!(0 < r))
                                    return void c();
                                X + e < t ? ge.scrollByY(n) : T(t)
                            }
                            a = setTimeout(l, s ? U.initialDelay : U.trackClickRepeatFreq),
                            s = !1
                        }, c = function() {
                            a && clearTimeout(a),
                            a = null,
                            be(document).unbind("mouseup.jsp", c)
                        };
                        return l(),
                        be(document).bind("mouseup.jsp", c),
                        !1
                    }
                }),
                z && se.bind("mousedown.jsp", function(i) {
                    if (void 0 === i.originalTarget || i.originalTarget == i.currentTarget) {
                        var a, o = be(this), e = o.offset(), r = i.pageX - e.left - Z, s = !0, l = function() {
                            var e = o.offset()
                              , t = i.pageX - e.left - ce / 2
                              , n = O * U.scrollPagePercent
                              , e = K * n / (q - O);
                            if (r < 0)
                                t < Z - e ? ge.scrollByX(-n) : $(t);
                            else {
                                if (!(0 < r))
                                    return void c();
                                Z + e < t ? ge.scrollByX(n) : $(t)
                            }
                            a = setTimeout(l, s ? U.initialDelay : U.trackClickRepeatFreq),
                            s = !1
                        }, c = function() {
                            a && clearTimeout(a),
                            a = null,
                            be(document).unbind("mouseup.jsp", c)
                        };
                        return l(),
                        be(document).bind("mouseup.jsp", c),
                        !1
                    }
                })),
                function() {
                    if (location.hash && 1 < location.hash.length) {
                        var e, t, n = escape(location.hash.substr(1));
                        try {
                            e = be("#" + n + ', a[name="' + n + '"]')
                        } catch (e) {
                            return
                        }
                        e.length && P.find(n) && (0 === B.scrollTop() ? t = setInterval(function() {
                            0 < B.scrollTop() && (E(e, !0),
                            be(document).scrollTop(B.position().top),
                            clearInterval(t))
                        }, 50) : (E(e, !0),
                        be(document).scrollTop(B.position().top)))
                    }
                }(),
                U.hijackInternalLinks && (be(document.body).data("jspHijack") || (be(document.body).data("jspHijack", !0),
                be(document.body).delegate('a[href*="#"]', "click", function(e) {
                    var t, n, i, a = this.href.substr(0, this.href.indexOf("#")), o = location.href;
                    if (-1 !== location.href.indexOf("#") && (o = location.href.substr(0, location.href.indexOf("#"))),
                    a === o) {
                        t = escape(this.href.substr(this.href.indexOf("#") + 1));
                        try {
                            n = be("#" + t + ', a[name="' + t + '"]')
                        } catch (e) {
                            return
                        }
                        n.length && ((i = n.closest(".jspScrollable")).data("jsp").scrollToElement(n, !0),
                        i[0].scrollIntoView && (a = be(window).scrollTop(),
                        ((o = n.offset().top) < a || o > a + be(window).height()) && i[0].scrollIntoView()),
                        e.preventDefault())
                    }
                })))) : (y.removeClass("jspScrollable"),
                P.css({
                    top: 0,
                    left: 0,
                    width: B.width() - ve
                }),
                B.unbind(me),
                P.find(":input,a").unbind("focus.jsp"),
                y.attr("tabindex", "-1").removeAttr("tabindex").unbind("keydown.jsp keypress.jsp"),
                P.unbind(".jsp"),
                M()),
                U.autoReinitialise && !he ? he = setInterval(function() {
                    S(U)
                }, U.autoReinitialiseDelay) : !U.autoReinitialise && he && clearInterval(he),
                i && y.scrollTop(0) && F(i, !1),
                a && y.scrollLeft(0) && _(a, !1),
                y.trigger("jsp-initialised", [z || J])
            }
            function w() {
                te.height(ne + "px"),
                X = 0,
                t = U.verticalGutter + te.outerWidth(),
                P.width(O - t - ve);
                try {
                    0 === ee.position().left && P.css("margin-left", t + "px")
                } catch (e) {}
            }
            function C() {
                B.find(">.jspHorizontalBar>.jspCap:visible,>.jspHorizontalBar>.jspArrow").each(function() {
                    le -= be(this).outerWidth()
                }),
                se.width(le + "px"),
                Z = 0
            }
            function k(e, t, n, i) {
                var a = "before"
                  , o = "after";
                "os" == t && (t = /Mac/.test(navigator.platform) ? "after" : "split"),
                t == a ? o = t : t == o && (a = t,
                t = n,
                n = i,
                i = t),
                e[a](n)[o](i)
            }
            function x(e, t, n) {
                return function() {
                    return function(e, t, n, i) {
                        n = be(n).addClass("jspActive");
                        var a, o, r = !0, s = function() {
                            0 !== e && ge.scrollByX(e * U.arrowButtonSpeed),
                            0 !== t && ge.scrollByY(t * U.arrowButtonSpeed),
                            o = setTimeout(s, r ? U.initialDelay : U.arrowRepeatFreq),
                            r = !1
                        };
                        s(),
                        a = i ? "mouseout.jsp" : "mouseup.jsp",
                        (i = i || be("html")).bind(a, function() {
                            n.removeClass("jspActive"),
                            o && clearTimeout(o),
                            o = null,
                            i.unbind(a)
                        })
                    }(e, t, this, n),
                    this.blur(),
                    !1
                }
            }
            function M() {
                se && se.unbind("mousedown.jsp"),
                te && te.unbind("mousedown.jsp")
            }
            function j() {
                be("html").unbind("dragstart.jsp selectstart.jsp mousemove.jsp mouseup.jsp mouseleave.jsp"),
                Q && Q.removeClass("jspActive"),
                Y && Y.removeClass("jspActive")
            }
            function T(e, t) {
                var n, i, a, o;
                J && (e < 0 ? e = 0 : G < e && (e = G),
                n = new be.Event("jsp-will-scroll-y"),
                y.trigger(n, [e]),
                n.isDefaultPrevented() || (i = 0 === (n = e || 0),
                a = n == G,
                o = -(e / G) * (H - N),
                void 0 === t && (t = U.animateScroll),
                t ? ge.animate(Q, "top", e, A, function() {
                    y.trigger("jsp-user-scroll-y", [-o, i, a])
                }) : (Q.css("top", e),
                A(e),
                y.trigger("jsp-user-scroll-y", [-o, i, a]))))
            }
            function A(e) {
                void 0 === e && (e = Q.position().top),
                B.scrollTop(0);
                var t, n = 0 === (X = e || 0), i = X == G, a = -(e / G) * (H - N);
                o == n && s == i || (o = n,
                s = i,
                y.trigger("jsp-arrow-change", [o, s, r, l])),
                t = n,
                e = i,
                U.showArrows && (ae[t ? "addClass" : "removeClass"]("jspDisabled"),
                oe[e ? "addClass" : "removeClass"]("jspDisabled")),
                P.css("top", a),
                y.trigger("jsp-scroll-y", [-a, n, i]).trigger("scroll")
            }
            function $(e, t) {
                var n, i, a, o;
                z && (e < 0 ? e = 0 : K < e && (e = K),
                n = new be.Event("jsp-will-scroll-x"),
                y.trigger(n, [e]),
                n.isDefaultPrevented() || (i = 0 === (n = e || 0),
                a = n == K,
                o = -(e / K) * (q - O),
                void 0 === t && (t = U.animateScroll),
                t ? ge.animate(Y, "left", e, I, function() {
                    y.trigger("jsp-user-scroll-x", [-o, i, a])
                }) : (Y.css("left", e),
                I(e),
                y.trigger("jsp-user-scroll-x", [-o, i, a]))))
            }
            function I(e) {
                void 0 === e && (e = Y.position().left),
                B.scrollTop(0);
                var t, n = 0 === (Z = e || 0), i = Z == K, a = -(e / K) * (q - O);
                r == n && l == i || (r = n,
                l = i,
                y.trigger("jsp-arrow-change", [o, s, r, l])),
                t = n,
                e = i,
                U.showArrows && (de[t ? "addClass" : "removeClass"]("jspDisabled"),
                ue[e ? "addClass" : "removeClass"]("jspDisabled")),
                P.css("left", a),
                y.trigger("jsp-scroll-x", [-a, n, i]).trigger("scroll")
            }
            function F(e, t) {
                T(e / (H - N) * G, t)
            }
            function _(e, t) {
                $(e / (q - O) * K, t)
            }
            function E(e, t, n) {
                var i, a, o, r, s, l, c, d = 0, u = 0;
                try {
                    i = be(e)
                } catch (e) {
                    return
                }
                for (r = i.outerHeight(),
                a = i.outerWidth(),
                B.scrollTop(0),
                B.scrollLeft(0); !i.is(".jspPane"); )
                    if (d += i.position().top,
                    u += i.position().left,
                    i = i.offsetParent(),
                    /^body|html$/i.test(i[0].nodeName))
                        return;
                s = (o = R()) + N,
                d < o || t ? l = d - U.horizontalGutter : s < d + r && (l = d - N + r + U.horizontalGutter),
                isNaN(l) || F(l, n),
                l = (r = L()) + O,
                u < r || t ? c = u - U.horizontalGutter : l < u + a && (c = u - O + a + U.horizontalGutter),
                isNaN(c) || _(c, n)
            }
            function L() {
                return -P.position().left
            }
            function R() {
                return -P.position().top
            }
            function D() {
                return !1
            }
            var U, P, O, N, B, q, H, V, W, J, z, Q, G, X, Y, K, Z, ee, te, t, ne, ie, ae, oe, re, se, le, ce, de, ue, he, fe, pe, ge = this, o = !0, r = !0, s = !1, l = !1, n = y.clone(!1, !1).empty(), me = be.fn.mwheelIntent ? "mwheelIntent.jsp" : "mousewheel.jsp", ve = "border-box" === y.css("box-sizing") ? fe = 0 : (fe = y.css("paddingTop") + " " + y.css("paddingRight") + " " + y.css("paddingBottom") + " " + y.css("paddingLeft"),
            (parseInt(y.css("paddingLeft"), 10) || 0) + (parseInt(y.css("paddingRight"), 10) || 0));
            be.extend(ge, {
                reinitialise: function(e) {
                    S(e = be.extend({}, U, e))
                },
                scrollToElement: function(e, t, n) {
                    E(e, t, n)
                },
                scrollTo: function(e, t, n) {
                    _(e, n),
                    F(t, n)
                },
                scrollToX: function(e, t) {
                    _(e, t)
                },
                scrollToY: function(e, t) {
                    F(e, t)
                },
                scrollToPercentX: function(e, t) {
                    _(e * (q - O), t)
                },
                scrollToPercentY: function(e, t) {
                    F(e * (H - N), t)
                },
                scrollBy: function(e, t, n) {
                    ge.scrollByX(e, n),
                    ge.scrollByY(t, n)
                },
                scrollByX: function(e, t) {
                    $((L() + Math[e < 0 ? "floor" : "ceil"](e)) / (q - O) * K, t)
                },
                scrollByY: function(e, t) {
                    T((R() + Math[e < 0 ? "floor" : "ceil"](e)) / (H - N) * G, t)
                },
                positionDragX: function(e, t) {
                    $(e, t)
                },
                positionDragY: function(e, t) {
                    T(e, t)
                },
                animate: function(e, t, n, i, a) {
                    var o = {};
                    o[t] = n,
                    e.animate(o, {
                        duration: U.animateDuration,
                        easing: U.animateEase,
                        queue: !1,
                        step: i,
                        complete: a
                    })
                },
                getContentPositionX: L,
                getContentPositionY: R,
                getContentWidth: function() {
                    return q
                },
                getContentHeight: function() {
                    return H
                },
                getPercentScrolledX: function() {
                    return L() / (q - O)
                },
                getPercentScrolledY: function() {
                    return R() / (H - N)
                },
                getIsScrollableH: function() {
                    return z
                },
                getIsScrollableV: function() {
                    return J
                },
                getContentPane: function() {
                    return P
                },
                scrollToBottom: function(e) {
                    T(G, e)
                },
                hijackInternalLinks: be.noop,
                destroy: function() {
                    var e, t;
                    e = R(),
                    t = L(),
                    y.removeClass("jspScrollable").unbind(".jsp"),
                    P.unbind(".jsp"),
                    y.replaceWith(n.append(P.children())),
                    n.scrollTop(e),
                    n.scrollLeft(t),
                    he && clearInterval(he)
                }
            }),
            S(e)
        }
        return n = be.extend({}, be.fn.jScrollPane.defaults, n),
        be.each(["arrowButtonSpeed", "trackClickSpeed", "keyboardSpeed"], function() {
            n[this] = n[this] || n.speed
        }),
        this.each(function() {
            var e = be(this)
              , t = e.data("jsp");
            t ? t.reinitialise(n) : (be("script", e).filter('[type="text/javascript"],:not([type])').remove(),
            t = new i(e,n),
            e.data("jsp", t))
        })
    }
    ,
    be.fn.jScrollPane.defaults = {
        showArrows: !1,
        maintainPosition: !0,
        stickToBottom: !1,
        stickToRight: !1,
        clickOnTrack: !0,
        autoReinitialise: !1,
        autoReinitialiseDelay: 500,
        verticalDragMinHeight: 0,
        verticalDragMaxHeight: 99999,
        horizontalDragMinWidth: 0,
        horizontalDragMaxWidth: 99999,
        contentWidth: void 0,
        animateScroll: !1,
        animateDuration: 300,
        animateEase: "linear",
        hijackInternalLinks: !1,
        verticalGutter: 4,
        horizontalGutter: 4,
        mouseWheelSpeed: 3,
        arrowButtonSpeed: 0,
        arrowRepeatFreq: 50,
        arrowScrollOnHover: !1,
        trackClickSpeed: 0,
        trackClickRepeatFreq: 70,
        verticalArrowPositions: "split",
        horizontalArrowPositions: "split",
        enableKeyboardNavigation: !0,
        hideFocus: !1,
        keyboardSpeed: 0,
        initialDelay: 300,
        speed: 30,
        scrollPagePercent: .8
    }
}),
function(e) {
    "function" == typeof define && define.amd ? define(["jquery"], e) : "object" == typeof exports ? module.exports = e : e(jQuery)
}(function(d) {
    var u, h, e = ["wheel", "mousewheel", "DOMMouseScroll", "MozMousePixelScroll"], t = "onwheel"in document || 9 <= document.documentMode ? ["wheel"] : ["mousewheel", "DomMouseScroll", "MozMousePixelScroll"], f = Array.prototype.slice;
    if (d.event.fixHooks)
        for (var n = e.length; n; )
            d.event.fixHooks[e[--n]] = d.event.mouseHooks;
    var p = d.event.special.mousewheel = {
        version: "3.1.12",
        setup: function() {
            if (this.addEventListener)
                for (var e = t.length; e; )
                    this.addEventListener(t[--e], i, !1);
            else
                this.onmousewheel = i;
            d.data(this, "mousewheel-line-height", p.getLineHeight(this)),
            d.data(this, "mousewheel-page-height", p.getPageHeight(this))
        },
        teardown: function() {
            if (this.removeEventListener)
                for (var e = t.length; e; )
                    this.removeEventListener(t[--e], i, !1);
            else
                this.onmousewheel = null;
            d.removeData(this, "mousewheel-line-height"),
            d.removeData(this, "mousewheel-page-height")
        },
        getLineHeight: function(e) {
            var t = d(e)
              , e = t["offsetParent"in d.fn ? "offsetParent" : "parent"]();
            return e.length || (e = d("body")),
            parseInt(e.css("fontSize"), 10) || parseInt(t.css("fontSize"), 10) || 16
        },
        getPageHeight: function(e) {
            return d(e).height()
        },
        settings: {
            adjustOldDeltas: !0,
            normalizeOffset: !0
        }
    };
    function i(e) {
        var t, n = e || window.event, i = f.call(arguments, 1), a = 0, o = 0, r = 0, s = 0, l = 0, c = 0;
        if (e = d.event.fix(n),
        e.type = "mousewheel",
        "detail"in n && (r = -1 * n.detail),
        "wheelDelta"in n && (r = n.wheelDelta),
        "wheelDeltaY"in n && (r = n.wheelDeltaY),
        "wheelDeltaX"in n && (o = -1 * n.wheelDeltaX),
        "axis"in n && n.axis === n.HORIZONTAL_AXIS && (o = -1 * r,
        r = 0),
        a = 0 === r ? o : r,
        "deltaY"in n && (a = r = -1 * n.deltaY),
        "deltaX"in n && (o = n.deltaX,
        0 === r && (a = -1 * o)),
        0 !== r || 0 !== o)
            return 1 === n.deltaMode ? (a *= t = d.data(this, "mousewheel-line-height"),
            r *= t,
            o *= t) : 2 === n.deltaMode && (a *= t = d.data(this, "mousewheel-page-height"),
            r *= t,
            o *= t),
            s = Math.max(Math.abs(r), Math.abs(o)),
            (!h || s < h) && m(n, h = s) && (h /= 40),
            m(n, s) && (a /= 40,
            o /= 40,
            r /= 40),
            a = Math[1 <= a ? "floor" : "ceil"](a / h),
            o = Math[1 <= o ? "floor" : "ceil"](o / h),
            r = Math[1 <= r ? "floor" : "ceil"](r / h),
            p.settings.normalizeOffset && this.getBoundingClientRect && (s = this.getBoundingClientRect(),
            l = e.clientX - s.left,
            c = e.clientY - s.top),
            e.deltaX = o,
            e.deltaY = r,
            e.deltaFactor = h,
            e.offsetX = l,
            e.offsetY = c,
            e.deltaMode = 0,
            i.unshift(e, a, o, r),
            u && clearTimeout(u),
            u = setTimeout(g, 200),
            (d.event.dispatch || d.event.handle).apply(this, i)
    }
    function g() {
        h = null
    }
    function m(e, t) {
        return p.settings.adjustOldDeltas && "mousewheel" === e.type && t % 120 == 0
    }
    d.fn.extend({
        mousewheel: function(e) {
            return e ? this.bind("mousewheel", e) : this.trigger("mousewheel")
        },
        unmousewheel: function(e) {
            return this.unbind("mousewheel", e)
        }
    })
});
var SCM = SCM || {};
Date.prototype.MMddyyyy = function() {
    var e = this.getMonth() + 1
      , t = this.getDate()
      , n = e
      , i = t;
    return e < 10 && (n = "0" + e),
    t < 10 && (i = "0" + t),
    n + "/" + i + "/" + this.getFullYear()
}
,
function(a, e) {
    var o = e("#hfValidationErrorInvalidYear").val()
      , r = e("#hfValidationErrorInvalidRange").val();
    function t() {
        a.$fromYear = e("#fromYear"),
        a.$toYear = e("#toYear"),
        a.$fromMonth = e("#fromMonth"),
        a.$toMonth = e("#toMonth")
    }
    a.getSolrDateString = function(e, t, n, i) {
        a.isSingleDateSelected ? (t = e,
        n ? (i = n,
        --n) : (n = 0,
        i = 12)) : (!e && t ? (e = 1666,
        n = 0) : e && !t && (t = 2999,
        i = 12),
        !i && e && t && (i = 12),
        n && --n);
        n = new Date(e,n,1),
        i = new Date(t,i,0);
        return n.MMddyyyy() + " TO " + i.MMddyyyy()
    }
    ,
    a.getValidationResponseTextForDateRange = function(e, t, n, i) {
        return !e && !t || e && !/^[\d]{4}$/.test(e) || t && !/^[\d]{4}$/.test(t) ? o : e && t && t < e || n && i && i < n && e && t && e === t ? r : void 0
    }
    ,
    a.getValidationResponseTextForSingleDate = function(e) {
        if (!e || !/^[\d]{4}$/.test(e))
            return o
    }
    ,
    a.fillInMonthDropdown = function(e, t) {
        var n;
        !e.length || (n = e.data("selected")) && t.val() && e.val(n)
    }
    ,
    a.isSingleDateSelected = !1,
    a.initDateRangeToggle = function() {
        e(document).on("click", ".js-date-range-input-radio", function() {
            a.isSingleDateSelected = "single" === e(this).attr("value"),
            t(),
            a.isSingleDateSelected ? (e(".js-date-input-to").addClass("hide"),
            e(".js-date-range-label").addClass("hide")) : (e(".js-date-input-to").removeClass("hide"),
            e(".js-date-range-label").removeClass("hide"))
        })
    }
    ,
    a.initDateFilterTypeToggle = function() {
        0 <= window.location.search.indexOf("dateFilterType=single") && e('.js-date-range-input-radio[value="single"]').click()
    }
    ,
    a.$fromYear = null,
    a.$toYear = null,
    a.$fromMonth = null,
    a.$toMonth = null,
    a.init = function() {
        t(),
        a.initDateRangeToggle(),
        a.initDateFilterTypeToggle(),
        a.fillInMonthDropdown(a.$fromMonth, a.$fromYear),
        a.fillInMonthDropdown(a.$toMonth, a.$toYear)
    }
}(SCM.PublicationDateFilter = SCM.PublicationDateFilter || {}, jQuery);
var SCM = SCM || {};
SCM.PubHistory = function(t) {
    return {
        registerToggle: function() {
            t(document.body).on("click", ".js-history-dropdown-trigger", function(e) {
                e.stopPropagation(),
                SCM.Toolbar.closeHypothesis(),
                t(".js-history-entries-wrap").toggleClass("expanded")
            })
        }
    }
}(jQuery);
var SCM = SCM || {};
SCM.ClientStatsMaster = function(r) {
    function s(e, t, n, i, a, o) {
        this.SourceType = e,
        this.ActionType = t,
        this.ActionDescription = n,
        this.ActionUrl = i,
        this.SearchData = a,
        this.IsTurnaway = o
    }
    function i(e, t, n, i, a, o) {
        o = new s(e,t,n,i,a,o).toJson();
        r.ajax({
            type: "POST",
            url: "/Services/UserActionService.svc/TrackUserAction",
            data: o,
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            async: !0,
            processData: !0
        }).fail(function(e, t) {
            window.console && (console.log("jqXhr.responseText: " + e.responseText),
            console.log("status: " + t))
        })
    }
    return s.prototype.toJson = function() {
        return JSON.stringify(this)
    }
    ,
    {
        trackContentTabEvents: function() {
            var e = r("#Toolbar")
              , t = {
                "#FigureTab": "FiguresClicked",
                "#TableTab": "TablesClicked",
                "#ContentTab": "ArticleClicked",
                "#SupplementTab": "SupplementClicked",
                "#MultimediaTab": "MultimediaClicked"
            };
            e.on("click", ".tab-trigger", function() {
                var e = r(this).attr("data-tab");
                e in t && i(22, "View", t[e], window.location.href, "", !1)
            })
        },
        trackShares: function() {
            var e = r("#ShareDrop")
              , t = {
                addthis_button_email: "EmailClicked",
                addthis_button_share: "TwitterClicked",
                addthis_button_facebook: "FacebookClicked",
                addthis_button_compact: "CompactClicked"
            };
            e.on("click", "a", function() {
                var e = r(this).attr("class");
                e in t && i(22, "Share", t[e], window.location.href, "", !1)
            })
        },
        trackSingleAction: function(e, t, n) {
            e.on("click", function() {
                i(22, t, n, window.location.href, "", !1)
            })
        }
    }
}(jQuery),
$(window).on("load", function() {
    SCM.ClientStatsMaster.trackContentTabEvents(),
    SCM.ClientStatsMaster.trackShares(),
    SCM.ClientStatsMaster.trackSingleAction($('a[data-reveal-id="getCitation"]'), "Tools", "GetCitationClicked"),
    SCM.ClientStatsMaster.trackSingleAction($("div.toolboxGetAlertsWidget"), "Tools", "AlertsClicked"),
    SCM.ClientStatsMaster.trackSingleAction($("div#getAlertsConfirmation"), "Tools", "AlertAdded"),
    SCM.ClientStatsMaster.trackSingleAction($("#PermissionsLink"), "Tools", "GetPermissionsClicked"),
    SCM.ClientStatsMaster.trackSingleAction($("a.tablelink").filter(":parent"), "ViewLargeImage", "ViewLargeImageClicked")
});
var SCM = SCM || {};
SCM.JumpLinks = SCM.JumpLinks || {},
SCM.JumpLinks = function(d, i) {
    var u, a, o = [], l = [], e = !1;
    return {
        init: function() {
            {
                var e, t, n;
                u = d("html, body"),
                a = d(".js-jumplink, .sectionLink, .js-no-access-jumplink").not(".disable").not(".hide"),
                (u.hasClass("pg_article") || u.hasClass("pg_issue")) && (a.each(function() {
                    var e = d(this)
                      , t = s(e.attr("href"));
                    o.push({
                        jumplink: e,
                        target: t
                    })
                }),
                window.location.hash && (e = window.location.hash.split("#").pop().trim(),
                0 < (t = e.indexOf("=")) && (e = e.substring(0, t)),
                r(n = s("#" + e))),
                d(window).on("scroll", h),
                f())
            }
            u.hasClass("pg_chapterstandard") && (a.each(function() {
                var e = d(this)
                  , t = d(e.attr("href").split("#").pop().trim());
                n = s("#" + t.selector),
                $jumplinkTarget = s(n),
                o.push({
                    jumplink: e,
                    target: $jumplinkTarget
                })
            }),
            window.location.hash && (e = window.location.hash.split("#").pop().trim()).startsWith("jumplink-") && (e = e.substr("jumplink-".length),
            r(n = function(e, t) {
                return d("[" + e + "]").filter(function() {
                    return d(this).attr(e) === t
                })
            }("data-supplement-target", e))),
            d(window).on("scroll", h),
            f());
            u.hasClass("pg_siconversioncalculatorpage") && d(window).on("scroll", h);
            (function(i) {
                a.on("click", function(e) {
                    var t, n;
                    i.hasClass("pg_issue") ? (t = d(e.target),
                    n = d.deparam.querystring(),
                    e = 1,
                    n.page && (e = Number.parseInt(n.page)),
                    0 !== t.data("page") && t.data("page") !== e && (window.location = "?page=" + t.data("page") + t.attr("href"))) : i.hasClass("pg_article") || i.hasClass("pg_chapterstandard") || i.hasClass("pg_siconversioncalculatorpage") ? (c(i, d(this).attr("href")),
                    t = i,
                    d(".page-column--left").removeClass("js-filters-open"),
                    d(".page-column--left, .responsive-issue-nav, .issue-dropdown-wrap").removeAttr("style"),
                    t.removeClass("noscroll"),
                    d(document).off("touchmove"),
                    SCM.SiteJS.initFoundation()) : i.hasClass("pg_book") && c(i, d(this).attr("href"))
                })
            }
            )(u),
            u.hasClass("pg_articlesplitview") && d(".js-jumplink:contains('References')").parents(".section-jump-link").hide()
        },
        registerNotesTocLink: function(t, e) {
            d("." + e).on("click", function() {
                var e = d(t).offset().top - 50;
                u.animate({
                    scrollTop: e
                }, 400, function() {
                    d(window).off("scroll", h),
                    d(window).on("scroll", h)
                }),
                u.removeClass("noscroll")
            })
        },
        registerFootNotesLink: f
    };
    function r(e) {
        e.length && (e = n(e),
        u.animate({
            scrollTop: e
        }, 400, function() {
            d(window).off("scroll", h),
            d(window).on("scroll", h)
        }))
    }
    function n(e) {
        var t = i.getStickyToolbarHeight()
          , n = e[0].id;
        return "no-access-message" == n || "login-purchase" == n ? e.offset().top - t - 18 : e.offset().top - t
    }
    function s(e) {
        if (e && e.length) {
            var t = d(e);
            return 0 === t.length && e.startsWith("#") && (e = e.substring(1),
            t = d("[data-legacy-id='" + e + "']")),
            t
        }
        return null
    }
    function h() {
        window.scrollY,
        e || (rAF = requestAnimationFrame(t),
        e = !0)
    }
    function c(e, t) {
        $target = s(t);
        t = n($target);
        e.animate({
            scrollTop: t
        }, 400, function() {
            d(window).off("scroll", h),
            d(window).on("scroll", h)
        })
    }
    function f() {
        d(".js-end-note-link").off("click"),
        d(".js-end-note-link").on("click", function(e) {
            var t, n, i, a, o = d(this).attr("data-fn-id"), r = d("#bookId").val(), s = 0 < d(".widget-ArticleFulltext").length, l = (a = d(this),
            d("#sv_main:visible").length ? (a.closest(".table-wrap-foot").length || a.closest(".js-fig-section").length) && d(".js-sv-figuresTables").length ? d(".js-sv-figuresTables") : d("#split-view-scroll-pane") : d("#ContentColumn")), c = d("#sv_main:visible").length;
            o && o.length && (s ? 1 < (t = d('.content-inner-wrap:visible .js-xref-fn[reveal-id="' + o + '"]:visible')).length && (t = (t = t.filter(function(e) {
                return 0 === d(t[e]).closest(".table-modal.table-full-width-wrap").length
            })).first()) : t = l.find('.js-xref-fn[reveal-id="' + o + '"]:first'),
            0 === t.length && r.length && (t = l.find('.js-related-object[legacysectionid="' + o + '"]:first')),
            t.length ? (n = 0,
            i = u,
            a = t.offset().top - 60,
            c && (n = l.offset().top,
            i = l,
            a = t.offset().top - n + l.scrollTop() - 5),
            i.animate({
                scrollTop: a
            }, 200, function() {
                d(window).off("scroll", h),
                d(window).on("scroll", h)
            }),
            u.removeClass("noscroll")) : !s && r.length && (s = App.CurrentSubdomain.length ? "/" + App.CurrentSubdomain : "",
            d.ajax({
                url: s + "/Content/GoToChapterFootNote",
                cache: !1,
                data: {
                    bookId: r,
                    footnoteId: o
                },
                dataType: "json",
                success: function(e) {
                    e.Success && (window.location = e.RedirectURL)
                }
            })))
        })
    }
    function t() {
        d(".js-tocLink");
        var r = d(".js-jumplink")
          , s = d.deparam.querystring();
        d(window).on("scroll", function() {
            var e, t, n, i, a, o = d(this).scrollTop();
            d(".articleClientType").each(function() {
                var e = d(this).offset().top
                  , t = d(this).attr("id")
                  , t = d('.section-jump-link__link-wrap a[href="#' + t + '"]');
                e - 90 < o && (d(t).length && d(".list-issue-jumplinks li").removeClass("active"),
                r.removeClass("active"),
                d(t).closest(".js-jumplink").addClass("active"))
            }),
            u.hasClass("pg_issue") && !r.hasClass("active") && (e = d("#ArticleListPageSize").val(),
            t = 0,
            s.page && (t = Number.parseInt(s.page) - 1),
            n = t * e,
            (a = d(".section-jump-link__link-wrap a")).each(function(e, t) {
                return t.dataset.ordinal > n ? (d(i).closest(".js-jumplink").addClass("active"),
                !1) : (a.length - 1 === e && d(t).closest(".js-jumplink").addClass("active"),
                void (i = t))
            })),
            d(".article-body").length && d("#ContentColumn h2").each(function() {
                var e = d(this).offset().top
                  , t = d(this).attr("id")
                  , t = d('#InfoColumn .section-jump-link__link-wrap a[href="#' + t + '"]');
                e - 90 < o && (d(t).length && d(".jumplink-list li").removeClass("active"),
                r.removeClass("active"),
                d(t).closest(".js-jumplink").addClass("active"))
            }),
            d(".book-chapter-body").length && (l.length || (d("#ContentColumn h2, #ContentColumn h3, #ContentColumn h4").each(function() {
                l.push(d(this))
            }),
            0 < d(".js-toc-footnotes-link").find(".js-notes-link-chapter-footnotes:visible").length && l.push(d("#chapter-footnotes")),
            0 < d(".js-toc-notes-link").find(".js-notes-link-end-notes:visible").length && l.push(d("#endNotesTargetLocation"))),
            d(l).each(function() {
                var e = d(this).offset().top
                  , t = d(this).data("magellan-destination") ? parseInt(d(this).data("magellan-destination")) : parseInt(d(this).prevAll(".jumpLoc-sectionId").eq(0).attr("id"))
                  , t = d(this).hasClass("js-end-notes-target") ? d("#InfoColumn .js-section-title-wrap .js-notes-link-end-notes:visible") : d(this).hasClass("js-footnotes-target") ? d("#InfoColumn .js-section-title-wrap .js-notes-link-chapter-footnotes:visible") : d('#InfoColumn .js-section-title-wrap a[data-sectionid="' + t + '"]');
                e - 120 < o && d(t).length && (d(".js-jumplink-list li").removeClass("active"),
                r.removeClass("active"),
                r.removeClass("at-highlighted-heading"),
                d(t).closest(".js-jumplink").addClass("active"),
                d(t).closest(".js-jumplink").addClass("at-highlighted-heading"),
                d(t).parents(".js-headings-placeholder").siblings(".js-section-title-wrap").find(".js-tocLink").addClass("active"),
                d(t).parents(".js-headings-placeholder").siblings(".js-section-title-wrap").find(".js-jumplink").addClass("active"))
            })),
            d(".pg_siconversioncalculatorpage").length && d("#table1, #length, #area, #mass, #volume, #table2, #analytes__A-D, #analytes__E-K, #analytes__L-Q, #analytes__R-Z").each(function() {
                var e = d(this).offset().top
                  , t = d(this).attr("id")
                  , t = d('#InfoColumn .section-jump-link__link-wrap a[href="#' + t + '"]');
                e - 90 < o && (d(t).length && d(".jumplink-list li").removeClass("active at-selected-LR-element"),
                r.removeClass("active at-selected-LR-element"),
                d(t).closest(".js-jumplink").addClass("active at-selected-LR-element"))
            })
        })
    }
}(jQuery, SCM.StickyToolbarHelper);
var SCM = SCM || {};
SCM.trapFocus = (jQuery,
{
    publicTrapFocus: function(i, e, a) {
        i.keydown(function(e) {
            var t, n;
            "Escape" === e.key && a.focus(),
            "Tab" !== e.key && 9 !== e.keyCode || (t = (n = i.find('a[href]:not([disabled]), button:not([disabled]), textarea:not([disabled]), input[type="text"]:not([disabled]), input[type="radio"]:not([disabled]), input[type="checkbox"]:not([disabled]), select:not([disabled]), input, div[tabindex=0]').filter(":visible"))[0],
            n = n[n.length - 1],
            e.shiftKey ? document.activeElement === t && (n.focus(),
            e.preventDefault()) : document.activeElement === n && (t.focus(),
            e.preventDefault()))
        }),
        e.on("click", function() {
            a.focus()
        })
    }
});
var SCM = SCM || {};
!function(e, i) {
    var a, o, r, s, l, c, d, u, h, f, p, g, m, v, t, b, y, S, w, C, k = window.scrollY || window.pageYOffset, x = !1, M = 0;
    function n() {
        k = window.scrollY || window.pageYOffset,
        x || (requestAnimationFrame(E),
        x = !0)
    }
    function j() {
        return a.hasClass("pg_article")
    }
    function T() {
        return a.hasClass("pg_articlesbygroup")
    }
    function A() {
        return a.hasClass("pg_issue")
    }
    function $() {
        return a.hasClass("pg_searchresults")
    }
    function I() {
        return a.hasClass("pg_book")
    }
    function F() {
        return a.hasClass("pg_chapterstandard")
    }
    function _() {
        return a.hasClass("pg_siconversioncalculatorpage")
    }
    function E() {
        var e, t, n;
        x = !1,
        1023 < SCM.SiteJS.getViewportWidth() ? (j() || F() || I()) && (k >= i(".js-content-body").offset().top + d ? (function() {
            var e;
            !function() {
                null === P && (P = f.children().length);
                return P
            }() && ((e = c.clone(!0)).find(".js-navbar-search-filter").attr("id", "sticky-navbar-search-filter"),
            e.find(".js-navbar-search-filter-label").attr("for", "sticky-navbar-search-filter"),
            e.find(".js-microsite-search-term").attr("id", "sticky-microsite-search-term"),
            e.find(".js-microsite-search-term-label").attr("for", "sticky-microsite-search-term"),
            e.find(".js-citation-format").attr("id", "sticky-select-format"),
            e.find(".js-citation-format-label").attr("for", "sticky-selectFormat"),
            e.find(".mobile-microsite-search").remove(),
            f.append(e),
            "undefined" != typeof addthis && addthis.toolbox(".js-sticky-toolbar"),
            P = !0)
        }(),
        f.addClass("stuck")) : f.removeClass("stuck")) : (j() || F() || _()) && (k >= i(".js-mobile-nav").offset().top + u ? o.addClass("stuck") : o.removeClass("stuck")),
        "sticky" === v && U() && (U() && 1200 < SCM.SiteJS.getViewportWidth() ? (j() && (50 + S.height() + p.height() - w.height() - 80 <= k ? (S.css("height", S.height()),
        $rightRailAdContainer.addClass("fixed")) : (S.css("height", "auto"),
        $rightRailAdContainer.removeClass("fixed"))),
        (A() || $() || I() || F()) && (50 + S.height() + p.height() - w.height() - 24 <= k ? (S.css("height", S.height()),
        $rightRailAdContainer.addClass("fixed")) : (S.css("height", "auto"),
        $rightRailAdContainer.removeClass("fixed")))) : $rightRailAdContainer.removeClass("fixed"),
        U() && 1023 < SCM.SiteJS.getViewportWidth() ? (T() && i(".pg_articlesbygroup #Sidebar .widget:last-of-type").css("margin-bottom", "0"),
        (T() || a.hasClass("pg_selfserve/sspage") || a.hasClass("pg_selfservepage")) && (50 + S.height() + p.height() - $rightRailAdContainer.height() - 24 <= k ? (S.css("height", S.height()),
        $rightRailAdContainer.addClass("fixed")) : (S.css("height", "auto"),
        $rightRailAdContainer.removeClass("fixed")))) : $rightRailAdContainer.removeClass("fixed")),
        SCM.SiteJS.isPageViewLarge() || (t = 0,
        "guardian" === m && R() && (t = g.height()),
        n = p ? p.height() + p.offset().top : 0,
        e = C ? C.height() : 0,
        k && (p || C) && n + e + t - M <= k ? ((j() || F() || I() || _()) && (l.addClass("stuck"),
        $leftNav.css("top", "55px")),
        $() && SCM.SiteJS.getViewportWidth() <= 1023 && r.addClass("stuck")) : (j() || $() || F() || I() || _()) && ($leftNav.css("top", "0px"),
        h.removeClass("stuck"))),
        $() && SCM.SiteJS.getViewportWidth() <= 1023 && (k >= p.height() + 148 + 70 ? (r.addClass("stuck"),
        r.next().css("margin-top", "70px")) : (h.removeClass("stuck"),
        r.next().css("margin-top", "0px"))),
        !A() || (n = i(".js-issue-dropdown-wrap")).length && (e = parseInt(n.css("margin-bottom").replace("px", "")),
        t = C ? C.height() : 0,
        1023 < SCM.SiteJS.getViewportWidth() && (k >= p.height() + n.height() + 2 * e + t + p.offset().top ? l.addClass("stuck") : A() && l.removeClass("stuck")),
        k >= p.height() + n.height() + 2 * e + t + p.offset().top + l.height() + 30 ? (s.addClass("stuck"),
        SCM.SiteJS.getViewportWidth() <= 1023 && s.parent().css("padding-top", s.height() + 32 + "px")) : A() && (s.removeClass("stuck"),
        SCM.SiteJS.getViewportWidth() <= 1023 && s.parent().css("padding-top", "0px"))),
        "scrolldelay" === m && !0 === b && R() && (k >= p.height() - 290 ? (g.addClass("fixed"),
        y.addClass("master-container-sticky")) : (g.removeClass("fixed"),
        y.removeClass("master-container-sticky"))),
        "guardian" === m && R() && (k >= p.height() - 290 && k < 220 && 0 !== k ? (g.addClass("fixed"),
        g.removeClass("guardian-scrolled"),
        y.addClass("master-container-sticky"),
        i(".journal-header").show()) : 220 <= k ? (g.removeClass("fixed"),
        g.addClass("guardian-scrolled"),
        y.addClass("master-container-sticky"),
        i(".journal-header").hide()) : (g.removeClass("fixed"),
        g.removeClass("guardian-scrolled"),
        y.removeClass("master-container-sticky"),
        i(".journal-header").show()))
    }
    e.init = function() {
        a = i("body"),
        y = i(".js-master-container"),
        l = i(".js-left-nav-col"),
        $leftNav = i(".js-left-nav"),
        c = i(".js-toolbar-wrap"),
        d = c.height(),
        u = i(".js-mobile-nav").height(),
        h = i(".js-left-nav-col, .js-toolbar-wrap, .sr-filters, .js-mobile-nav"),
        f = i(".js-sticky-toolbar"),
        p = i(".js-master-header"),
        C = i(".widget-SitewideBanner"),
        g = i(".js-ad-banner-header"),
        t = i("#hdnAdDelaySeconds").val(),
        m = i("#hdnAdConfigurationTop").val(),
        v = i("#hdnAdConfigurationRightRail").val(),
        S = i("#Sidebar.page-column--right"),
        $rightRailAdContainer = i("#Sidebar>div:last-of-type"),
        w = i("#Sidebar>div:last-of-type>div"),
        s = i(".js-issue-browse-mobile-nav"),
        o = i(".js-mobile-nav-sticky"),
        r = i(".sr-filters");
        var e = i("#hfLeftNavStickyOffset");
        e.length && (M = parseInt(e.val())),
        0 < t && "scrolldelay" === m && (b = !0,
        setTimeout(function() {
            b = !1,
            g.removeClass("fixed"),
            y.removeClass("master-container-sticky")
        }, t)),
        i(window).on("scroll", n),
        E()
    }
    ;
    var L = null;
    function R() {
        return L = L || i("#adBlockHeader iframe").length
    }
    var D = null;
    function U() {
        return D = D || i("#Sidebar>div:last-of-type iframe").length
    }
    var P = null
}(SCM.StickyElements = SCM.StickyElements || {}, jQuery);
var SCM = SCM || {};
function GetReturnUrl() {
    var e, t = window.location.href;
    return 0 < t.indexOf("?") && (e = window.location.search.split("&"),
    t = t.substring(0, t.indexOf("?")),
    !e.length || (e = e.filter(function(e) {
        return "login" !== e.split("=")[0].replace("?", "")
    })).length && (t += e.join("&")),
    t += window.location.hash),
    t
}
SCM.Utilities = SCM.Utilities || {},
SCM.AddReturnUrlToSocietyLinks = function() {
    var t = GetReturnUrl()
      , t = encodeURIComponent(t)
      , e = $("#hfPlaceholderReturnUrlValue")
      , n = e.length ? e.val() : null;
    $(".society-links-logo, .society-links-url").each(function() {
        var e;
        n && n.length && (e = $(this)).attr("href", e.attr("href").replace(n, t))
    })
}
;
var SCM = SCM || {};
!function(e, r) {
    var s = r(".sigma").length
      , l = "<span class='get-access js-get-access-label at-get-access'>Get access<img class='get-access-icon' src='/UI/app/svg/chevron-right-white.svg' alt='Arrow' aria-hidden='true'></span>";
    e.setAccessIcons = function(o) {
        o = o || SCM.AccessIcons;
        var e = r("[data-resource-id-access]");
        e.length && o && (e.each(function(e, t) {
            var n = r(this)
              , i = n.data("resourceIdAccess")
              , a = SCM.SiteJS.getAccessIcon(i, o);
            a && (i = a,
            n = (a = n).find(".js-access-icon-placeholder"),
            s && !n.length && (n = a.find(".js-sigma-access-placeholder")),
            n.length && (n.removeClass(function(e, t) {
                return (t.match(/icon-availability_.+/g) || []).join(" ")
            }),
            function(e, t) {
                var n = t.prev();
                s && -1 !== r.inArray(e, c) ? (t.remove(),
                n.wrapInner('<span class="access-title"></span>'),
                n.append(l)) : t.removeClass(e).addClass(e)
            }(i.icon, n),
            n.attr("title", i.title)))
        }),
        0 < r(".pg_book").length && (0 < r(".js-get-access-label").length ? r(".js-get-access-wrapper").removeClass("hidden") : r(".js-login-purchase-wrap").addClass("hidden")))
    }
    ;
    var c = ["icon-availability_restricted", "icon-availability_cart"];
    e.getAccessIcon = function(n, e) {
        var i;
        return (e = e || SCM.AccessIcons).map(function(e, t) {
            if (e.id === n)
                return i = e,
                !1
        }),
        i
    }
}(SCM.SiteJS = SCM.SiteJS || {}, jQuery);
var SCM = SCM || {};
!function(e, t) {
    e.registerAnswerLinkClick = function() {
        t(".js-answer-link").on("click", function() {
            var e = t(this);
            e.next(".js-answer-wrap").toggleClass("hide"),
            e.find(".js-answer-show").toggleClass("hide"),
            e.find(".js-answer-hide").toggleClass("hide")
        })
    }
}(SCM.ChapterAnswerSet = SCM.ChapterAnswerSet || {}, jQuery);
var SCM = SCM || {};
!function(e, s) {
    var l = s("#hfMaxRelativeDepth").length ? parseInt(s("#hfMaxRelativeDepth").val()) : 0
      , d = s("#hfBrowseContentInLinkText").val()
      , u = 100;
    function h() {
        var e = s(this);
        return parseInt(e.attr("data-level")) > l
    }
    function t() {
        var n, i, a, e = s(this).closest(".js-tree-node-item"), t = e.closest(".js-tree-browse-wrap"), o = e.attr("data-level"), c = e.attr("data-id"), r = null;
        o === l && (r = e.next(".js-children").find(".js-tree-node-item").filter(h)),
        f(t, c, r),
        setTimeout(function() {
            var r, s, l;
            r = t,
            s = e,
            l = c,
            new Promise(function(e, t) {
                var n = s.find(".js-tree-node-link").text()
                  , i = r.find(".js-tree-browse-breadcrumb-link")
                  , a = i.closest(".js-tree-browse-breadcrumb-wrap")
                  , o = i.closest(".js-breadcrumbs");
                o.is(".active") || a.height(0),
                o.addClass("active"),
                o.addClass("fade"),
                setTimeout(function() {
                    a.height(i.closest(".js-breadcrumbs").outerHeight())
                }, u),
                i.removeClass("active");
                o = i.siblings(".hide").first();
                o.text(n),
                o.attr("data-id", l),
                o.removeClass("hide"),
                o.addClass("active"),
                e()
            }
            )
        }, u),
        n = t,
        i = (r = e).find(".js-tree-node-link").text(),
        a = r.attr("data-id"),
        new Promise(function(t, e) {
            setTimeout(function() {
                n.find(".js-tree-browse-link-all").addClass("hide");
                var e = n.find(".js-tree-browse-link-narrowed");
                e.text(d + i),
                e.attr("href", e.data("href-template").concat(a)),
                e.removeClass("hide"),
                t()
            }, u)
        }
        )
    }
    function f(t, e, n) {
        var a = t.find('.js-tree-node-item[data-parent-id="' + e + '"]');
        n && n.length && (a = a.add(n));
        e = t.find(".js-tree-node-item");
        e.removeClass("fade");
        var i, n = t.find(".js-tree-browse-nodes-wrap").height();
        t.find(".js-tree-browse-nodes-wrap").height(n),
        i = e,
        new Promise(function(e, t) {
            setTimeout(function() {
                i.removeClass("active"),
                e()
            }, u)
        }
        ).then(function(e) {
            return n = t,
            i = a,
            new Promise(function(t, e) {
                setTimeout(function() {
                    i.addClass("active");
                    var e = n.find(".js-tree-browse-nodes").outerHeight();
                    n.find(".js-tree-browse-nodes-wrap").height(e),
                    t()
                }, u)
            }
            );
            var n, i
        }).then(function() {
            return n = a,
            new Promise(function(e, t) {
                setTimeout(function() {
                    n.addClass("fade"),
                    e()
                }, u)
            }
            );
            var n
        })
    }
    function n() {
        var e = s(this)
          , t = e.closest(".js-tree-browse-wrap");
        e.nextAll().addClass("hide"),
        e.addClass("active");
        var n = e.attr("data-id");
        f(t, n),
        e.is(".js-root-breadcrumb") ? ($breadcrumbsWrap = e.parents(".js-breadcrumbs"),
        $breadcrumbsWrap.removeClass("fade"),
        $breadcrumbsWrap.closest(".js-tree-browse-breadcrumb-wrap").height(0),
        setTimeout(function() {
            $breadcrumbsWrap.removeClass("active")
        }, u),
        t.find(".js-tree-browse-link-all").removeClass("hide"),
        t.find(".js-tree-browse-link-narrowed").addClass("hide")) : (e = t.find('.js-tree-node-item[data-id="' + n + '"]').find(".js-tree-node-link").text(),
        (t = t.find(".js-tree-browse-link-narrowed")).text(d + e),
        t.attr("href", t.data("href-template").concat(n)),
        t.removeClass("hide"))
    }
    e.checkPageHeightForSeriesDropdown = function() {
        var e, n, t = s(".js-main");
        0 !== s("#searchResultsPage").length && (t = s("#ContentColumn")),
        0 < t.length && (e = t.height(),
        n = e,
        s(".js-tree-browse-wrap").each(function(e) {
            var t = s(this).height();
            n < t && (n = t)
        }),
        e < n && t.height(n))
    }
    ,
    e.init = function() {
        s(document.body).on("click", ".js-tree-node-link", t),
        s(document.body).on("click", ".js-tree-browse-breadcrumb-link", n),
        e.checkPageHeightForSeriesDropdown()
    }
}(SCM.TreeBrowse = SCM.TreeBrowse || {}, jQuery);
var SCM = SCM || {};
!function(l, d) {
    var e = d("body")
      , n = d(".search-wrap-filters")
      , t = !1
      , a = !1
      , o = !1
      , r = (d(".navbar-search"),
    d(".js-navbar-search-container"))
      , s = d(".js_close-navsearch")
      , c = d(".js_expand-navsearch")
      , u = d(".navbar-menu, .navbar-search-collapsed")
      , h = d(".navbar-search-advanced, .navbar-search-close, .navbar-search")
      , f = d(".navbar-search .navbar-search-input");
    function p(e, t) {
        var n, i, a, o = d("#NeedSubscription");
        !e.length || t.length || 2 <= (a = e.split(" ")).length && (n = d("<div/>"),
        i = a[0],
        e = a[a.length - 1],
        (a = (a = d('[content-id="' + i + '"]').first()).length ? a : d('[content-id="' + i.toLowerCase() + '"]').first()).length && (n.append(a.children().clone()),
        n = l.getAllReferencesInRange(a, n, e)),
        t = 0 < n.html().length ? n : ""),
        d(t).hasClass("video-modal") || d(t).hasClass("audio-modal") ? t.foundation("reveal", "open") : t.length ? SCM.SiteJS.openRevealModal(t) : o.foundation("reveal", "open")
    }
    $mobileSearchInput = d(".mobile-search-input"),
    $toolbarWrap = d(".toolbar-wrap"),
    $toolbarInnerWrap = d(".toolbar-inner-wrap"),
    activeElement = void 0,
    $viewOption = "Basic",
    d("#hfViewOption").val(),
    l.initSkipNavToMainContent = function() {
        var e = "#skipNav_sitewidebanner"
          , t = d(e);
        t.length && d(".skipnav").attr("href", e),
        d(".skipnav").on("click", function() {
            (t.length ? t : d("#skipNav")).focus()
        })
    }
    ,
    l.isPageViewLarge = function() {
        if (e.hasClass("pg_ViewLarge"))
            return !0
    }
    ,
    l.setBlockLink = function() {
        d(document).on("click", ".js-widget-dynamic-entry", function(e) {
            e = d(e.currentTarget).data("resource-url");
            e && (window.location = e)
        })
    }
    ,
    l.setAllLinksTarget = function() {
        d("a[target]").not(".openInAnotherWindow").each(function() {
            d(this).attr("target", "")
        })
    }
    ,
    l.getNewSelectedFilter = function() {
        var t = n.children("li");
        t.on("click", function() {
            var e = d(this);
            t.removeClass("selected"),
            e.addClass("selected"),
            SCM.SiteJS.setSelectedSearchFilter()
        })
    }
    ,
    l.initSelfServeNavigation = function() {
        var e = d('.js-selfserve-navigation-menu a[href="' + window.location.pathname + '"]');
        e.addClass("ss-currentPage"),
        e.parents("ul.selfserve-nav-menu-child-list").addClass("open"),
        e.parents("ul.selfserve-nav-menu-child-list").siblings("button.selfserve-subnav-toggle").removeClass("icon-general-arrow-filled-right").addClass("icon-general-arrow-filled-down")
    }
    ,
    l.toggleSelfServeNavigation = function() {
        d(".selfserve-subnav-toggle, .selfserve-parent-toggle").on("click", function(e) {
            var t = d(this)
              , n = d(this).siblings(".selfserve-sublist");
            e.preventDefault(),
            t.hasClass("icon-general-arrow-filled-right") ? t.removeClass("icon-general-arrow-filled-right").addClass("icon-general-arrow-filled-down") : t.removeClass("icon-general-arrow-filled-down").addClass("icon-general-arrow-filled-right"),
            n.hasClass("open") ? n.removeClass("open") : n.addClass("open")
        })
    }
    ,
    l.getViewportWidth = function() {
        return Math.max(document.documentElement.clientWidth, window.innerWidth || 0)
    }
    ,
    l.initLazyLoad = function() {
        d("img.contentFigures, img.inlineGraphics, img.lazy").lazyload({
            skip_invisible: !1
        })
    }
    ,
    l.detectIfFirefox = function() {
        null == window.mozInnerScreenX || d("html").addClass("firefox")
    }
    ,
    l.initFoundation = function() {
        d(document).foundation()
    }
    ,
    l.loadAllImagesIfUserIsAboutToUseJumpLinks = function() {
        d("#LeftNavSticker").hover(function() {
            d(".lazy").each(function() {
                var e = d(this);
                e.attr("src", e.attr("data-original"))
            })
        })
    }
    ,
    l.showAuthorInfo = function() {
        d(".js-linked-name-trigger, .linked-name, .al-author-name .linked-name, .al-author-name-more .linked-name, .linked-name-byline, .al-author-footnotes .js-linked-footnotes").on("click", function(e) {
            var t = d(this).siblings(".al-author-info-wrap");
            e.stopPropagation(),
            SCM.Toolbar.closeHypothesis(),
            d(".al-author-info-wrap").not(t).removeClass("open"),
            d(t).toggleClass("open"),
            d(t).attr("tabindex", "-1").focus(),
            d(window).width() < 1200 && d(".al-author-info-wrap.open:visible").length && d("#ContentColumn:visible").length && (e = d("#ContentColumn"),
            t = e.position().left + e.width(),
            e = d(".al-author-info-wrap.open"),
            SCM.SiteJS.shiftOpenAuthorCards(e, t)),
            SCM.ScholarlyiQ.trackOnPageEvent("article-author-" + d(this).text())
        }),
        d(document.body).on("click", function(e) {
            d(e.target).parents(".al-author-info-wrap").length || d(".al-author-info-wrap").removeClass("open")
        })
    }
    ,
    l.addAuthorFootnote = function() {
        d(".al-author-name, .al-author-name-more").each(function() {
            var e = d(this).find(".info-card-note .xref-fn");
            e.length && "*" === e.text() && (d("<sup/>").append(e.html()).insertAfter(d(this).find(".linked-name")),
            e.remove()),
            d(this).find(".info-author-correspondence").length && ((e = d(this).find('span[class^="delimiter"]')).length ? e.prepend('<i class="icon-mail"></i>') : d(this).find(".linked-name").append('<i class="icon-mail"></i>'))
        })
    }
    ,
    l.showHideDropDown = function() {
        d(".selectDropdown").on("click", function(e) {
            d(".dropdown").hide().removeClass("open"),
            e.stopPropagation(),
            d(this).siblings(".dropdown").slideToggle("300", "linear").toggleClass("open")
        }),
        d(document).click(function() {
            d(".dropdown").hide().removeClass("open")
        })
    }
    ,
    l.showMoreRelatedContent = function(e, t) {
        d(e).click(function() {
            var e = d(this);
            e.closest(".related-section-box, .widget-RelatedBookContent").find(t).toggleClass("show-item"),
            e.toggleClass("show-less").find("i").toggleClass("icon-show").toggleClass("icon-hide"),
            e.hasClass("show-less") ? e.find("span").text("See Less") : e.find("span").text("See More")
        })
    }
    ,
    l.showRelatedBookWidgetIfHasContent = function() {
        d(".widget-RelatedBookContent").each(function() {
            var e = d(this);
            5 < e.find("*").length && e.addClass("show")
        })
    }
    ,
    l.handleUnresolvedRelatedObjectLinks = function() {
        d(document).on("click", 'a[isbn][object-type!="end-note"], .js-link-page', function() {
            var t = "/CustomError?statusCode=404"
              , e = d(this)
              , n = e.attr("isbn")
              , i = d("#bookId").val()
              , a = e.attr("legacySectionId")
              , o = d("div[name='" + a + "']");
            !function(e, t) {
                if (e.hasClass("js-link-other")) {
                    e = d("div[content-id='" + t + "']");
                    if (e.length && e.parents(".mixed-citation").length) {
                        e = d('[content-id="' + t + '"]').parents(".paragraph-ref").first();
                        return p(t, e),
                        !0
                    }
                }
                return !1
            }(e, a) && (o.length ? window.location.hash = a : (n = null == n ? "" : n.trim(),
            a = null == a ? "" : a.trim(),
            "" !== n || "" !== a ? (o = App.CurrentSubdomain.length ? "/" + App.CurrentSubdomain : "",
            d.ajax({
                url: o + "/Book/GoToRelatedObjectLink",
                cache: !0,
                dataType: "json",
                data: {
                    isbn: n,
                    legacySectionId: a,
                    currentBookId: i
                }
            }).done(function(e) {
                e && e.Success ? window.top.location.assign(e.RedirectURL) : (console.log("/Book/GoToRelatedObjectLinkfailed!"),
                window.top.location.assign(t))
            }).fail(function() {
                console.log("Book/GoToRelatedObjectLink failed"),
                window.top.location.assign(t)
            })) : window.top.location.assign(t)))
        })
    }
    ,
    l.showSpinner = function() {
        function e() {
            d(".preloader-wrap").removeClass("hide").addClass("active")
        }
        SCM.QueryBuilder.defaults.beforeSearch = e,
        d(".pagination").on("click", e)
    }
    ,
    l.setSelectedSearchFilter = function() {
        var e = n.children(".selected").text();
        d(".selected-text").text(e)
    }
    ,
    l.initFilterClickEvent = function() {
        d(".filter-wrap").on("click", function(e) {
            n.hide(),
            e.stopPropagation(),
            n.toggle()
        }),
        d(document).click(function() {
            n.hide()
        })
    }
    ,
    l.launchSupersededContentModal = function() {
        d("#supersededContent").on("opened.fndtn.reveal", function() {
            d(".js-latest-link").focus()
        }),
        d("#supersededContent").on("closed.fndtn.reveal", function() {
            d(document.body).focus()
        }),
        d("#supersededContent").foundation("reveal", "open")
    }
    ,
    l.launchAddAlertModal = function() {
        d('[data-reveal-id="addArticleUpdateAlert"]').click(function() {
            d("#AddAlert").foundation("reveal-modal", "open")
        })
    }
    ,
    l.launchEmailUserModal = function() {
        d('[data-reveal-id="emailUsernameModal"]').click(function() {
            d("#emailUserName").foundation("reveal-modal", "open")
        })
    }
    ,
    l.showFullDisclaimer = function() {
        d(document).on("click", ".disclaimer-text", function() {
            d(this).closest(".disclaimer-text").find(".js-disclaimer").toggleClass("hide")
        })
    }
    ,
    l.showFullVersionInfo = function() {
        d(".js-version-info-more-link").on("click", function() {
            d(this).closest(".version-info-text").find(".js-version-info").toggleClass("hide")
        })
    }
    ,
    l.closeNavbarSearch = function() {
        s.on("click", function() {
            r.removeClass("tablet-viewport-active"),
            h.hide(),
            u.fadeIn()
        })
    }
    ,
    l.expandNavbarSearch = function() {
        c.on("click", function() {
            r.addClass("tablet-viewport-active"),
            u.hide(),
            h.fadeIn(),
            f.focus()
        })
    }
    ,
    l.calculateResetState = function(e) {
        t = !!e,
        SCM.SiteJS.resetMobileSiteNav(t)
    }
    ,
    l.toggleMobileLanguageSubmenu = function() {
        d(".mobile-header-language").on("click", function() {
            d(".mobile-language-submenu").slideToggle()
        })
    }
    ,
    l.toggleMobileSignInForm = function() {
        var e = d(".mobile-login")
          , t = d(".mobile-signin-nav-arrow");
        d(".mobile-menu-link-wrap").on("click", function() {
            e.hasClass("open") || (e.addClass("open").slideToggle(),
            t.hide())
        }),
        d(".site-menu .mobile-login-form").on("click", ".mobile-login-icon", function() {
            e.removeClass("open").slideToggle(),
            t.show()
        })
    }
    ,
    l.resetMobileSearchFilters = function() {
        d(".sf-facets, .sf-facet-list").removeAttr("style"),
        d(".sf-group-header-icon").removeClass("icon-general_arrow-down").addClass("icon-general_arrow-right")
    }
    ,
    l.resetMobileSiteNav = function(e) {
        d(".header-bottom, .navigation, .microsite-search, .arrow-nav, .arrow-search, .mobile-language-submenu").removeAttr("style"),
        d(".mobile-search-toggle, .mobile-menu-toggle, .arrow-nav, .arrow-search").removeClass("active"),
        d(".microsite-search").removeClass("active-tablet"),
        e && (o = a = !1)
    }
    ,
    l.toggleMobileSearch = function() {
        d(".mobile-search-toggle").on("click", function() {
            SCM.SiteJS.calculateResetState(a, o),
            o = !1 === o,
            SCM.SiteJS.toggleResponsiveMenus(d(".mobile-search-toggle, .arrow-search"), o, d(".microsite-search"))
        })
    }
    ,
    l.toggleResponsiveLeftColumn = function() {
        var t, n = d(".page-column--left"), i = d(".toggle-left-col__close"), e = d(".page-column--left .js-taxonomy-label");
        e.attr("tabindex", "0"),
        e.keypress(function(e) {
            13 === e.which && this.click()
        }),
        d(document.body).removeClass("noscroll"),
        d(".js-main").on("click", ".toggle-left-col__search, .toggle-left-col__article", function(e) {
            e.preventDefault(),
            t = document.activeElement,
            d(document.body).addClass("noscroll"),
            n.show().addClass("js-filters-open");
            e = d(".page-column--left .info-inner-wrap");
            e.attr("tabindex", "-1").focus(),
            SCM.trapFocus.publicTrapFocus(e, i, t),
            navigator.userAgent.toLowerCase().includes("mozilla") || d(document).on("touchmove", function(e) {
                e.preventDefault()
            }),
            d(document).ajaxComplete(function() {
                d(document.body).removeClass("noscroll"),
                n.removeClass("js-filters-open"),
                d(document).off("touchmove"),
                l.initFoundation()
            })
        }),
        d(".toggle-left-col__issue").on("click", function(e) {
            e.preventDefault(),
            d(document.body).addClass("noscroll"),
            d(".issue-dropdown-wrap").hide(),
            d(".responsive-issue-nav").show(),
            navigator.userAgent.toLowerCase().includes("mozilla") || d(document).on("touchmove", function(e) {
                e.preventDefault()
            })
        }),
        i.on("click", function(e) {
            e.preventDefault(),
            d(document.body).removeClass("noscroll"),
            n.removeClass("js-filters-open"),
            d(".page-column--left, .responsive-issue-nav, .issue-dropdown-wrap").removeAttr("style"),
            d(document).off("touchmove"),
            l.initFoundation()
        })
    }
    ,
    l.toggleMobileMenu = function() {
        d(".mobile-menu-toggle").on("click", function() {
            SCM.SiteJS.calculateResetState(o, a),
            a = !1 === a,
            SCM.SiteJS.toggleResponsiveMenus(d(".mobile-menu-toggle, .arrow-nav"), a, d(".navigation"))
        })
    }
    ,
    l.toggleResponsiveMenus = function(e, t, n) {
        var i = d(".header-bottom");
        t ? (e.addClass("active"),
        n.show(),
        i.slideToggle()) : (e.removeClass("active"),
        i.toggle(),
        n.delay(50).hide())
    }
    ,
    l.showFullAuthorList = function() {
        var t = d(".meta-authors--etal")
          , n = d(".meta-authors--remaining")
          , i = d(".meta-authors--limited").find(".delimiter-hidden");
        t.on("click", function(e) {
            e.preventDefault(),
            t.removeClass("is-active"),
            t.attr("aria-hidden", !0),
            n.addClass("is-active"),
            n.attr("aria-hidden", !1),
            i && (i.removeClass("delimiter-hidden"),
            i.addClass("delimiter"))
        })
    }
    ,
    l.showImages = function(e) {
        e.find(".contentFigures").each(function() {
            var e = d(this);
            0 <= e.attr("src").toLowerCase().indexOf("grey.gif") && e.attr("src", e.attr("data-original"))
        })
    }
    ,
    l.openRevealModal = function(e) {
        var t = d("#revealModal");
        t.find("#revealContent").empty().prepend(e.contents().clone()),
        t.foundation("reveal", "open"),
        SCM.SiteJS.showImages(t),
        SCM.SiteJS.restrictedImages();
        var n = document.activeElement;
        d(document).on("opened.fndtn.reveal", "[data-reveal]", function() {
            d(".open").focus(),
            d(".open").addClass("at-openModal")
        }),
        d(document).on("close.fndtn.reveal", "[data-reveal]", function() {
            n.focus(),
            t.removeClass("at-openModal")
        })
    }
    ,
    l.revealFigsTablesInModal = function() {
        e.on("click", ".xref-bibr, .xref-fn, .link-reveal, .table-graphic, .caption-title", function() {
            var e = d(this)
              , t = e.attr("reveal-id") ? e.attr("reveal-id") : e.attr("data-reveal-id") ? e.attr("data-reveal-id") : e.attr("data-id")
              , e = (e = function(e) {
                var t = d('[content-id="' + e + '"]').first();
                {
                    var n, i;
                    t.length || ((n = d('[id="' + e + '"]').first()).length ? (i = n.next().attr("id"),
                    t = d('[data-statsid="' + i + '"]')) : (n = d('[data-table-id="' + e + '"]').first()).length && (t = n.find(".table-wrap")))
                }
                return t
            }(t)).length ? e : d('[content-id="' + t.toLowerCase() + '"]').first();
            p(t, e)
        })
    }
    ,
    l.revealFeaturedFigureInModal = function() {
        d(".issue-featured-image a").on("click", function() {
            var e, t = d(this).closest(".image-synopsis-wrap").html(), n = d("#revealModal"), i = n.find(".js-close-reveal-modal"), a = d(this).data("featuredfigureurl");
            a && (n.find("#revealContent").empty().prepend(t),
            d("#revealContent img").attr("src", a),
            n.foundation("reveal", "open"),
            e = d(":focus"),
            n.off("opened.fndtn.reveal"),
            n.on("opened.fndtn.reveal", function() {
                d(".close-reveal-modal").focus(),
                SCM.trapFocus.publicTrapFocus(n, i, e)
            }),
            n.on("closed.fndtn.reveal", function() {
                e.focus(),
                n.off("keydown.SCM.trapFocus"),
                d(this).find("#revealContent").empty()
            }))
        })
    }
    ,
    l.getAllReferencesInRange = function(e, t, n) {
        var i = e.next()
          , e = i.attr("content-id");
        return e.length && (t.append(i.children().clone()),
        e === n || e === n.toLowerCase() || l.getAllReferencesInRange(i, t, n)),
        t
    }
    ,
    l.showUnAuthenticatedSpans = function() {
        d(document).ready(function() {
            var e = d('div[data-widgetname="ArticleFulltext"] span#UserHasAccess').attr("data-userHasAccess");
            e && e.length && "false" === e.toLowerCase() && d('div[data-widgetname="ArticleFulltext"] a[data-reveal-id]').each(function() {
                d(this).replaceWith(function() {
                    return "<span>" + this.innerHTML + "</span>"
                })
            })
        })
    }
    ,
    l.oupHeaderDropdowns = function() {
        d(".mobile-search-toggle").on("click", function(e) {
            e.preventDefault();
            e = d(this);
            SCM.SiteJS.manageMobileDropdowns(e, ".mobile-search-dropdown")
        }),
        d(".mobile-account-toggle").on("click", function(e) {
            e.preventDefault();
            e = d(this);
            SCM.SiteJS.manageMobileDropdowns(e, ".mobile-account-dropdown")
        }),
        d(".mobile-nav-toggle").on("click", function(e) {
            e.preventDefault();
            e = d(this);
            SCM.SiteJS.manageMobileDropdowns(e, ".mobile-nav-dropdown")
        })
    }
    ,
    l.manageMobileDropdowns = function(e, t) {
        d(".dropdown-panel").hasClass("is-active") ? e.hasClass("is-active") ? (d(t).slideToggle().removeClass("is-active"),
        e.removeClass("is-active"),
        d(".mobile-search-toggle").focus()) : (d(".mobile-dropdown-toggle").removeClass("is-active"),
        d(".dropdown-panel-wrap").children(".is-active").slideToggle().removeClass("is-active"),
        e.addClass("is-active"),
        d(t).delay(400).slideToggle().addClass("is-active")) : (e.addClass("is-active"),
        d(t).slideToggle().addClass("is-active"),
        $mobileSearchInput.focus())
    }
    ,
    l.toggleToolbarDropdown = function() {
        d(".drop-trigger").on("click", function(e) {
            e.preventDefault(),
            d(this).siblings("ul").slideToggle()
        })
    }
    ;
    var g = "signin"
      , m = "mobile"
      , v = "desktop"
      , b = !1;
    function y(e) {
        e.length && (d(".contents-title").show(),
        d(".jumplink-list").append(e))
    }
    l.initSigninForm = function() {
        $mobileSignInLink = d(".mobile-account-dropdown ul li .mobile-account-signin"),
        $mobileSignInArrow = d(".mobile-account-dropdown ul li i.mobile-nav-arrow"),
        $mobileSignInForm = d(".mobile-account-dropdown ul li ul.individual-menu"),
        $desktopSignInForm = d(".dropdown-panel-signin"),
        $desktopInstitution = d(".dropdown-panel-institution");
        function t(t) {
            var e, n;
            $desktopSignInForm.toggleClass("active").toggle(),
            b || (e = SCM.SiteJS.GetLoginUrl(t),
            n = SCM.SiteJS.GetCaptchaInstanceNumber(t),
            d.ajax({
                url: (App.CurrentSubdomain.length ? "/" + App.CurrentSubdomain : "") + e,
                cache: !1,
                data: {
                    captchaInstanceNumber: n
                },
                success: function(e) {
                    SCM.SiteJS.UpdateLoginForm(t, e),
                    SCM.AddReturnUrlToSocietyLinks(),
                    b = !0
                }
            }))
        }
        d(".oup-header-menu-item.desktop .dropdown-toggle.signin").on("click", function(e) {
            e.preventDefault(),
            t(v)
        }),
        d(".dropdown-toggle.institution").on("click", function(e) {
            e.preventDefault(),
            $desktopInstitution.toggleClass("active").toggle()
        });
        var n = !1;
        d(document).mousedown(function(e) {
            var t = d(".dropdown-panel-signin, .dropdown-panel-institution");
            n = !d(t).is(e.target) && 0 === d(t).has(e.target).length
        }),
        d(document).mouseup(function(e) {
            var t = d(".dropdown-panel-signin, .dropdown-panel-institution");
            n && !d(t).is(e.target) && 0 === d(t).has(e.target).length && (d(t).hide(),
            t.removeClass("active")),
            n = !1
        }),
        $mobileSignInLink.on("click", function(e) {
            e.preventDefault(),
            t(m),
            $mobileSignInArrow.hasClass("icon-general_arrow-down") ? $mobileSignInArrow.removeClass("icon-general_arrow-down").addClass("icon-general_arrow-up") : $mobileSignInArrow.removeClass("icon-general_arrow-up").addClass("icon-general_arrow-down"),
            $mobileSignInLink.toggleClass("active")
        }),
        d(document).on("click", ".signin-form .signin-button", function(e) {
            var t = d(this).closest(".signin-form")
              , n = t.find(".preloader-wrap");
            e.preventDefault(),
            e.stopPropagation(),
            SCM.SiteJS.Login(t, n),
            "/sign-in" !== location.pathname && SCM.ScholarlyiQ.trackOnPageEvent("site-signin")
        }),
        d(document).on("keypress", ".signin-form input.username, .signin-form input.password", function(e) {
            var t = d(this).closest(".signin-form")
              , n = t.find(".preloader-wrap");
            13 === (e.keyCode || e.which) && (e.preventDefault(),
            SCM.SiteJS.Login(t, n))
        }),
        d(".signout-button").off("click"),
        d(document).on("click", ".signout-button", function() {
            var e = 0 === location.pathname.toLowerCase().indexOf("/my-account") ? "/" : location.pathname + location.search;
            d.get("/LOGOUT", {
                dest: "/HTTPHandlers/SAMs/LogoutHandler.ashx"
            }).done(function() {
                window.top.location.assign(e)
            }).fail(function() {
                window.top.location.assign(e)
            }),
            SCM.ScholarlyiQ.trackOnPageEvent("site-signout")
        }),
        d(document).on("click", "a.shibboleth-signin", function(e) {
            var t = window.top.location
              , t = t.origin + "/SHIBBOLETH?dest=" + encodeURIComponent(t.pathname + t.search)
              , t = d(this).data("target").replace("{0}", encodeURIComponent(t));
            window.top.location = t
        })
    }
    ,
    l.initLoginFormDropdown = function() {
        d(".signin-form").on("click", 'a[data-target="register"]', function(e) {
            e.preventDefault();
            e = d.deparam.querystring().returnUrl;
            null == e && (e = location.pathname + location.search),
            window.top.location.assign("/my-account/register?returnUrl=" + encodeURIComponent(e))
        })
    }
    ,
    l.Login = function(e, n) {
        var i = e.find("input.username").val()
          , a = e.find("input.password").val();
        if (0 < e.find("#hpcName").val().length && console.warn)
            console.warn("Honeypot captcha triggered. Are you a bot?");
        else if (0 !== i.length && 0 !== a.length) {
            var t = 0 < d(".js-captcha-simple").length
              , o = 0 < e.find(".js-captcha-normal").length
              , r = e.find("input.loginInstanceName").val();
            n.removeClass("hide");
            var s = 0
              , l = "txtCaptchaInputId";
            if (o)
                switch (r) {
                case g:
                    s = captcha0;
                    break;
                case m:
                    s = captcha1;
                    break;
                case v:
                    s = captcha2;
                    break;
                default:
                    s = 0
                }
            else
                t && (l += "-" + SCM.SiteJS.GetCaptchaInstanceNumber(r).toString());
            d.post((App.CurrentSubdomain.length ? "/" + App.CurrentSubdomain : "") + "/OUP/ValidateCaptcha", {
                captchaResponse: o ? grecaptcha.getResponse(s) : "",
                simpleCaptchaResponse: t ? document.getElementById(l).value : "",
                captchaInstanceNumber: SCM.SiteJS.GetCaptchaInstanceNumber(r)
            }).done(function(e) {
                var t;
                "1" === e ? d.post("/LOGIN", {
                    user: i,
                    pass: a,
                    dest: "/HTTPHandlers/SAMs/LoginHandler.ashx"
                }).done(function(e) {
                    "1" === e ? "/sign-in" === location.pathname.toLowerCase() && null !== d.deparam.querystring().handoff_url ? window.location.reload() : SCM.SiteJS.loginReturnBack() : d.post("/OUP/LoginFormIncrementFailedAttempts").done(function() {
                        var e = SCM.SiteJS.GetLoginUrl(r)
                          , t = SCM.SiteJS.GetCaptchaInstanceNumber(r);
                        d.ajax({
                            url: (App.CurrentSubdomain.length ? "/" + App.CurrentSubdomain : "") + e,
                            cache: !1,
                            data: {
                                captchaInstanceNumber: t
                            },
                            success: function(e) {
                                SCM.SiteJS.UpdateLoginForm(r, e),
                                SCM.AddReturnUrlToSocietyLinks(),
                                d(".error").show(),
                                n.addClass("hide")
                            }
                        })
                    })
                }) : (t = SCM.SiteJS.GetLoginUrl(r),
                e = SCM.SiteJS.GetCaptchaInstanceNumber(r),
                d.ajax({
                    url: (App.CurrentSubdomain.length ? "/" + App.CurrentSubdomain : "") + t,
                    cache: !1,
                    data: {
                        captchaInstanceNumber: e
                    },
                    success: function(e) {
                        SCM.SiteJS.UpdateLoginForm(r, e),
                        SCM.AddReturnUrlToSocietyLinks(),
                        d(".error").show(),
                        n.addClass("hide")
                    }
                }))
            })
        } else
            e.find(".error").show()
    }
    ,
    l.UpdateLoginForm = function(e, t) {
        var n;
        e === v ? ((n = d(".dropdown-panel-signin")).html(t),
        n.find("input.loginInstanceName").val(v),
        0 < n.find("div.register-captcha-text-normal-lf").length && resetCaptchaElement2()) : e === m ? ((n = d(".mobile-account-dropdown ul li ul.individual-menu")).html(t),
        n.find("input.loginInstanceName").val(m),
        0 < n.find("div.register-captcha-text-normal-lf").length && resetCaptchaElement1()) : e === g && ((e = d(".unauth-column.account")).html(t),
        e.find("input.loginInstanceName").val(g),
        0 < e.find("div.register-captcha-text-normal-lf").length && resetCaptchaElement())
    }
    ,
    l.GetLoginUrl = function(e) {
        return e == g ? "/OUP/LoginForm/OUP_SignInPage_LoginForm" : "/OUP/LoginForm/LoginFormPopup"
    }
    ,
    l.GetCaptchaInstanceNumber = function(e) {
        var t = 0;
        switch (e) {
        case g:
            t = 0;
            break;
        case m:
            t = 1;
            break;
        case v:
            t = 2;
            break;
        default:
            t = 0
        }
        return t
    }
    ,
    l.loginReturnBack = function() {
        var e = d.deparam.querystring().returnUrl;
        null == e && (e = d.deparam.querystring().redirectUrl),
        null != e && "" !== e || (e = window.top.location.pathname + window.top.location.search),
        e = decodeURIComponent(e);
        var t;
        /^\/((\w+\/)?sign-in|my-account\/forgot-password|my-account\/reset-password|my-account\/register)/i.test(e) ? e = "/" : /^\/[^\/]+/.test(e) || e.indexOf("secureacademic.oup.com") < 0 && (null !== (t = e.match(/\/\/([^/]+(?:\.[^./]+)*)/i)) && t[1].toLowerCase() === window.top.location.hostname.toLowerCase() || (e = "/")),
        "/" !== e && e.indexOf("secureacademic.oup.com") < 0 && null !== (t = e.match(/\/\/([^/]+\.)?([^./]+\.[^./]+)/i)) && t[2].toLowerCase() !== window.top.location.hostname.match(/(.*\.)?([^.]+\.[^.]+)/i)[2].toLowerCase() && (e = "/"),
        window.top.location.assign(e)
    }
    ,
    l.alertKeyPress = function() {
        d(document).on(".js-user-alert", "keydown", function(e) {
            "Enter" === e.key && d(this).triggerHandler("click")
        })
    }
    ,
    l.alertLinks = function() {
        d(document).on("click", ".js-user-alert", function() {
            var e = d(this)
              , t = (activeElement = e).data("additionalurl")
              , n = e.data("userloggedin")
              , i = e.data("alerttype")
              , a = e.data("siteid");
            void 0 !== n && "false" === n.toLowerCase() ? (n = d.deparam.querystring().returnUrl,
            void 0 === a && (a = d("#hdnSiteID").val()),
            e.parent().hasClass("alertType-MarketingLink") && (n = t),
            null == n && (n = location.pathname + location.search,
            location.search.length && -1 !== location.search.indexOf("fl_SiteID") || (n += location.search.length ? "&fl_SiteID=" + a : "?fl_SiteID=" + a)),
            void 0 !== i && (n = n + "#trigger-alerttype=" + i),
            window.location = "/sign-in?returnUrl=" + encodeURIComponent(n)) : void 0 !== t && t.length ? window.location = t : 191 !== a && 192 !== a || 3 !== i ? SCM.SiteJS.showSignUpAlertInfo(e) : window.location = "/my-account/email-alerts"
        }),
        d(document).on("click", ".close-reveal-modal", function() {
            try {
                d(this).parents(".reveal-modal").foundation("reveal", "close")
            } catch (e) {
                console.log("Foundation error - pdfaccess : " + e)
            }
            void 0 !== activeElement && activeElement.focus()
        })
    }
    ,
    l.showSignUpAlertInfo = function(o) {
        d.ajax({
            url: (App.CurrentSubdomain.length ? "/" + App.CurrentSubdomain : "") + "/Toolbox/AlertsSignUp/AlertsSignUpPopup",
            cache: !1,
            data: {
                alertType: o.data("alerttype"),
                resourceId: o.data("alertresourceid"),
                resourceType: o.data("alertresourcetype"),
                email: o.data("alertuseremail"),
                resourceName: o.data("alertresourcename"),
                taxonomyName: o.data("alerttaxonomyname")
            },
            dataType: "html",
            success: function(e) {
                d(".userAlertSignUp").html(e);
                var t = d(".userAlertSignUpModal")
                  , n = t.find(".close-reveal-modal");
                t.off("opened.fndtn.reveal"),
                t.on("opened.fndtn.reveal", function() {
                    SCM.trapFocus.publicTrapFocus(t, n, o),
                    t.focus()
                }),
                t.foundation("reveal", "open");
                var a = d(".userAlertSignUp").find("#selectAlertFreqeuncy");
                d(".userAlertSignUp").find("input.js-taxonomy-checkbox:checked");
                SCM.SiteJS.initTaxonomyArrows(d(".userAlertSignUp")),
                d(".addUserAlert").on("click", function() {
                    lastActiveElement = document.activeElement;
                    var e = d(this).parent()
                      , t = d(this).parent().find(".js-alert-name").val()
                      , n = d(this).parent().find(".js-taxonomy-checkbox:checked")
                      , i = !1;
                    33 == o.data("alerttype") && (t ? n.length < 1 && (i = !0,
                    SCM.SiteJS.showErrorMessage(e, d("#errorSelectionRequired"))) : (i = !0,
                    SCM.SiteJS.showErrorMessage(e, d("#errorAlertNameRequired"))));
                    n = n.filter(SCM.SiteJS.taxonomyFilterFunction),
                    n = SCM.SiteJS.processTaxonomies(n);
                    i || SCM.SiteJS.addSignUpAlert(o, a, t, n, e)
                })
            }
        })
    }
    ,
    l.showEditAlertInfo = function(e) {
        var r = e.parents(".email-alerts-content-row");
        d.ajax({
            url: (App.CurrentSubdomain.length ? "/" + App.CurrentSubdomain : "") + "/Toolbox/AlertsSignUp/AlertsSignUpPopup",
            cache: !1,
            data: {
                alertType: r.data("alerttype"),
                resourceId: r.data("alertresourceid"),
                resourceType: r.data("alertresourcetype"),
                email: r.data("alertuseremail"),
                resourceName: r.data("alertresourcename"),
                taxonomyName: r.data("alerttaxonomyname"),
                existingAlert: r.data("alert")
            },
            dataType: "html",
            success: function(e) {
                d(".userAlertSignUp").html(e),
                d(".userAlertSignUpModal").foundation("reveal", "open");
                var o = d(".userAlertSignUp").find("#selectAlertFreqeuncy");
                d(".userAlertSignUp").find("input.js-taxonomy-checkbox:checked");
                SCM.SiteJS.initTaxonomyArrows(d(".userAlertSignUp")),
                d(".js-edit-user-alert").on("click", function() {
                    var e = d(this).parent()
                      , t = d(this).parent().find(".js-alert-name").val()
                      , n = d(this).parent().find(".js-taxonomy-checkbox:checked")
                      , i = d("#AlertSignUp_AlertId").val()
                      , a = !1;
                    33 == r.data("alerttype") && (t ? n.length < 1 && (a = !0,
                    SCM.SiteJS.showErrorMessage(e, d("#errorSelectionRequired"))) : (a = !0,
                    SCM.SiteJS.showErrorMessage(e, d("#errorAlertNameRequired"))));
                    n = n.filter(SCM.SiteJS.taxonomyFilterFunction),
                    n = SCM.SiteJS.processTaxonomies(n);
                    a || SCM.SiteJS.editTaxonomyAlert(i, r, o, t, n, e)
                })
            }
        })
    }
    ,
    l.taxonomyFilterFunction = function() {
        return d(this).parents(".js-taxonomy-child-list-item").parents(".js-taxonomy-child-list-item").children(".js-taxonomy-parent-label").find(".js-taxonomy-checkbox:checked").length < 1
    }
    ,
    l.initTaxonomyArrows = function(e) {
        e.find(".js-taxonomy-parent-arrow").on("click", function() {
            var e = d(this);
            e.parents(".js-taxonomy-label-wrap").siblings(".js-taxonomy-child-list").toggleClass("hide");
            e = e.children(".js-taxonomy-icon");
            e.hasClass("icon-general-arrow-filled-right") ? e.removeClass("icon-general-arrow-filled-right").addClass("icon-general-arrow-filled-down") : e.removeClass("icon-general-arrow-filled-down").addClass("icon-general-arrow-filled-right")
        }),
        e.find(".js-taxonomy-checkbox").on("click", function() {
            d(this).is(":checked") ? d(this).parent().parent().find(".js-taxonomy-checkbox").prop("checked", !0) : (d(this).parent().parent().find(".js-taxonomy-checkbox").prop("checked", !1),
            d(this).closest(".js-taxonomy-node").children(".js-taxonomy-parent-label").find(".js-taxonomy-checkbox").prop("checked", !1),
            d(this).parents(".js-taxonomy-child-list-item").children(".js-taxonomy-parent-label").find(".js-taxonomy-checkbox").prop("checked", !1))
        })
    }
    ,
    l.showErrorMessage = function(e, t) {
        e.find(".js-message").hide(),
        t.removeClass("hide"),
        t.show()
    }
    ,
    l.processTaxonomies = function(e) {
        var t = new Array;
        for (i = 0; i < e.length; i++) {
            var n = e[i].attributes["data-id"].value;
            t.push(n)
        }
        return t
    }
    ,
    l.addSignUpAlert = function(e, t, n, i, a) {
        var o;
        null != t && (o = t.val()),
        d.ajax({
            url: (App.CurrentSubdomain.length ? "/" + App.CurrentSubdomain : "") + "/Toolbox/AddAlertsSignUpForTaxonomySearch/AddAlertsSignUpPopup",
            cache: !1,
            data: {
                alertType: e.data("alerttype"),
                resourceId: e.data("alertresourceid"),
                resourceType: e.data("alertresourcetype"),
                email: e.data("alertuseremail"),
                resourceName: e.data("alertresourcename"),
                scheduleId: o,
                alertName: n,
                taxonomyName: e.data("alerttaxonomyname"),
                taxonomies: JSON.stringify(i)
            },
            dataType: "html",
            success: function(e) {
                var t, n;
                null != e && ("name-exists" === e.trim() ? SCM.SiteJS.showErrorMessage(a, d("#errorAlertNameExists")) : "search-exists" === e.trim() ? SCM.SiteJS.showErrorMessage(a, d("#errorAlertSearchExists")) : (d(".userAlertSignUp").html(e),
                d(".userAlertSignUpModal").foundation("reveal", "open").addClass("confirmation-wrap"),
                n = d(".confirmation-wrap"),
                t = d(".toggle-left-col__close"),
                e = n.css("top"),
                (n = n).attr("tabindex", "-1").focus(),
                d("html, body").animate({
                    scrollTop: e
                }),
                SCM.trapFocus.publicTrapFocus(n, t, lastActiveElement)))
            }
        })
    }
    ,
    l.editTaxonomyAlert = function(e, t, n, i, a, o) {
        var r;
        null != n && (r = n.val()),
        d.ajax({
            url: (App.CurrentSubdomain.length ? "/" + App.CurrentSubdomain : "") + "/Toolbox/EditAlertForTaxonomySearch/AddAlertsSignUpPopup",
            cache: !1,
            type: "POST",
            data: {
                alertId: e,
                scheduleId: r,
                alertName: i,
                taxonomyName: t.data("alerttaxonomyname"),
                taxonomies: JSON.stringify(a)
            },
            dataType: "html",
            success: function(e) {
                var t = JSON.parse(e);
                null != t && ((e = t.Success ? d("#messageCustom") : d("#errorCustom")).html(t.Message),
                SCM.SiteJS.showErrorMessage(o, e))
            }
        })
    }
    ,
    l.initSearchResultsSort = function() {
        var e = d(".sort-order-select-option")
          , t = d(".sort-order-select")
          , n = d(".preloader-wrap");
        t.off("change").on("change", function() {
            var e = d(this).val();
            SCM.SearchResults.doSolrSearch({
                queryString: e,
                source: "searchresults"
            })
        }),
        e.off("click").on("click", function() {
            d(this).find("option[value]").length && n.removeClass("hide"),
            sessionStorage.detailsState = $viewOption
        }),
        d(".al-pageNumber,.sr-nav-previous,.sr-nav-next").off("click").on("click", function() {
            var e;
            d(this).hasClass("currentPage") || (n.removeClass("hide"),
            e = d(this).attr("data-url"),
            SCM.SearchResults.doSolrSearch({
                queryString: e
            }))
        })
    }
    ,
    l.restrictedImages = function() {
        d("div.graphic-wrap[restricted]").each(function() {
            var e = d(this).children(".copy-right-statement");
            d(e).toggle(!1),
            d(this).off("contextmenu").on("contextmenu", function() {
                return d(e).toggle(),
                !1
            }),
            d(this).off("click").click(function() {
                return d(e).toggle(),
                !1
            }),
            d(e).off("click").click(function() {
                return d(e).toggle(),
                !1
            })
        })
    }
    ,
    SCM.ArticleListNewAndPopular.registerArticleListNewAndPopularCombinedMode(),
    l.moveSubmitCommentLink = function() {
        var e = d(".submitCommentPlaceHolder")
          , t = d(".widget-UserComment");
        e.append(t)
    }
    ,
    l.addUserCommentJumpLink = function() {
        var e, t = d(".content-nav");
        t.length && (e = d(".comments-jumplink"),
        t.append(e))
    }
    ,
    l.addDataSupplementsJumpLink = function() {
        var e = d(".dataSupplements-jumplink");
        y(e)
    }
    ,
    l.addDataRepositoriesJumpLink = function() {
        var e = d(".dataRepositories-jumplink");
        y(e)
    }
    ,
    l.addAuthorNotesJumpLink = function() {
        var e = d(".authorNotes-section-title");
        e.length && (e = d('<li class="section-jump-link head-1"><div class="section-jump-link__link-wrap"><a class="jumplink js-jumplink scrollTo" href="#authorNotesSectionTitle">' + e.text() + "</a></div></li>"),
        y(e))
    }
    ,
    l.shiftOpenAuthorCards = function(e, t) {
        var n = e.closest(".al-author-name");
        n.length || (n = e.closest(".al-author-name-more"));
        var i = n.offset()
          , n = e.width();
        t < i.left + n ? e.addClass("shift-card") : e.hasClass("shift-card") && i.left + n < t && e.removeClass("shift-card")
    }
    ;
    var S = !(l.toggleSearchResultsDetails = function() {
        var t = d("#switch-container")
          , n = d("#switch-post")
          , i = d(".sri-expandedView");
        $viewOption = sessionStorage.detailsState || ("undefined" != typeof clientViewOption && "" !== clientViewOption ? clientViewOption : d("#hfViewOption").val()),
        "Expanded" === $viewOption ? (t.removeClass("off").addClass("on"),
        n.removeClass("off").addClass("on"),
        i.removeClass("hide")) : "Basic" === $viewOption && i.addClass("hide"),
        d(".pagination").on("click", function() {
            sessionStorage.detailsState = $viewOption
        }),
        t.off("click").on("click", function(e) {
            e.stopPropagation(),
            $viewOption = "Expanded" === $viewOption ? "Basic" : "Expanded",
            t.toggleClass("on off"),
            n.toggleClass("on off"),
            i.hasClass("hide") ? i.removeClass("hide") : i.addClass("hide")
        })
    }
    );
    l.adjustRelatedTagsDisplay = function() {
        d(".article-metadata-panel:not(.solr-resource-metadata):not(:last)").remove();
        var e = d(".article-metadata-panel:not(.solr-resource-metadata)").last()
          , t = d(".kwd-group")
          , n = d(".related-topic-tags")
          , a = d(".article-metadata-taxonomies")
          , o = d(".article-metadata-tocSections")
          , r = d(".wi-editors");
        $openScienceBadge = d(".wi-open-science-badge");
        var s = [t, n, a, o, r, $openScienceBadge];
        for (e.length || (e = d(".article-metadata-standalone-panel"),
        d(".widget-items").prepend(e)),
        i = 0; i < s.length; i++)
            s[i].length && e.append(s[i]);
        e.html() && e.show(),
        l.removeEmpty(".article-metadata-panel"),
        l.removeEmpty(".article-metadata-standalone-panel"),
        l.removeEmpty(".access-state-logos"),
        l.removeEmpty(".article-pubstate"),
        S = !0,
        window.dispatchEvent(new CustomEvent("adjustRelatedTagsDisplay.complete"))
    }
    ,
    l.isFinishedAdjustRelatedTagsDisplay = function() {
        return S
    }
    ,
    l.removeEmpty = function(e) {
        for (var t = d(e), n = 0; n < t.length; n++) {
            var i, a = t.eq(n);
            0 === a.children().length && ((i = a.text()) && i.trim() || a.remove())
        }
    }
    ,
    l.showPdfOnlyLink = function() {
        d(".PdfOnlyLink").length && d(".toolbar-item.item-pdf").length && d(".toolbar-item.item-pdf").children().clone().appendTo(".PdfOnlyLink")
    }
    ,
    l.triggerAlertModalOnRedirect = function() {
        var e = d.bbq.getState("trigger-alerttype");
        void 0 !== e && (d('.userAlert a[data-userloggedin="True"][data-alerttype=' + e + "]").click(),
        d.bbq.removeState("trigger-alerttype"))
    }
    ,
    l.triggerSaveSearchModelOnRedirect = function() {
        "1" === d.bbq.getState("triggerSaveSearch") && (d(".lnkSaveSolrSearch").click(),
        d.bbq.removeState("triggerSaveSearch"))
    }
    ,
    l.configureMathjax = function() {
        MathJax.Hub.Config({
            CommonHTML: {
                linebreaks: {
                    automatic: !0
                }
            },
            "HTML-CSS": {
                linebreaks: {
                    automatic: !0
                }
            },
            SVG: {
                linebreaks: {
                    automatic: !0
                }
            },
            tex2jax: {
                inlineMath: [["|$", "$|"], ["\\(", "\\)"]]
            }
        }),
        "sticky" !== d("#hdnAdConfigurationRightRail").val() && MathJax.Hub.Register.StartupHook("End", function() {
            var c, e, t;
            screen.width < 1024 || (c = d(".page-column-wrap").width(),
            d("#ContentTab").on("click", ".js-mathjax-view-large", function(e) {
                var t, n, i, a, o, r, s, l = d(e.currentTarget);
                l.hasClass("js-mathjax-view-large-expanded") || l.prev().hasClass("js-mathjax-view-large-expanded") || ((t = l.clone(!1)).css("position", "absolute"),
                t.addClass("js-mathjax-view-large-clone"),
                t.addClass("mathjax-view-large-expanded"),
                t.addClass("js-mathjax-view-large-expanded"),
                l.before(t),
                n = e.currentTarget.dataset.targetWidth,
                i = l.height(),
                a = (s = d(".page-column-wrap").offset().left) + c,
                o = e.currentTarget.dataset.widthDifference,
                r = Math.ceil(o / 2),
                s = (e = l.offset().left) - s,
                e = a - (e + l.width()),
                r < s && r < e ? (t.css("marginLeft", -r + "px"),
                t.css("marginRight", -r + "px")) : r < s && (e = o - e,
                t.css("marginLeft", -e + "px")),
                t.css("minHeight", Math.ceil(i) + "px"),
                t.css("width", n + "px")),
                l.hasClass("js-mathjax-view-large-expanded") ? (l.css("visibility", "hidden"),
                l.next().css("visibility", "")) : (l.css("visibility", "hidden"),
                l.prev().css("visibility", ""))
            }),
            d("#ContentTab .math span.MathJax").each(function(e, t) {
                var n = t.offsetWidth + 2
                  , i = d(t).parents(".formula-wrap")
                  , t = i.width();
                t < n && (i.addClass("js-mathjax-view-large").addClass("mathjax-view-large"),
                n = Math.min(n, 1200, c),
                i[0].dataset.widthDifference = n - t,
                i[0].dataset.targetWidth = n)
            }),
            d("#ContentTab .tex-math").each(function(e, t) {
                var n = t.offsetWidth + 5
                  , i = d(t).parents(".formula-wrap")
                  , t = i.width();
                t < n && (i.addClass("js-mathjax-view-large").addClass("mathjax-view-large"),
                n = Math.min(n, 1200, c),
                i[0].dataset.widthDifference = n - t,
                i[0].dataset.targetWidth = n)
            }),
            e = function(e) {
                e.matches ? d(".mathjax-view-large").removeClass("js-mathjax-view-large") : d(".mathjax-view-large").addClass("js-mathjax-view-large")
            }
            ,
            (t = window.matchMedia("(max-width: 1023px)")).addListener(e),
            e(t))
        })
    }
    ,
    l.citationAriaExpand = function() {
        var e = d(".js-journal-citation-filter-toggle")
          , t = d(".journal-citation-filter-input-wrap");
        e.attr("aria-expanded", "true"),
        e.click(function() {
            t.is(".collapsed") ? e.attr("aria-expanded", "true") : e.attr("aria-expanded", "false")
        })
    }
    ,
    l.ariaToggleTable = function(t) {
        var n = d(t + "-button")
          , i = n.children(".collapse-icon");
        n.on("click", function(e) {
            e.preventDefault(),
            "true" === n.attr("aria-expanded") ? n.attr("aria-expanded", "false") : n.attr("aria-expanded", "true"),
            i.hasClass("icon-general-arrow-filled-down") ? i.removeClass("icon-general-arrow-filled-down").addClass("icon-general-arrow-filled-right") : i.removeClass("icon-general-arrow-filled-right").addClass("icon-general-arrow-filled-down"),
            d(t).toggleClass("hide"),
            "false" === d(t).attr("aria-hidden") ? d(t).attr("aria-hidden", "true") : d(t).attr("aria-hidden", "false")
        })
    }
    ,
    l.initAriaControls = function() {
        d("[id^=collapsible-table-]").each(function(e) {
            SCM.SiteJS.ariaToggleTable("#collapsible-table-" + e)
        })
    }
    ,
    l.abstractMathJax = function() {
        d(".js-abstract-response-placeholder").length && MathJax.Hub.Queue(["Typeset", MathJax.Hub, ".js-abstract-response-placeholder"])
    }
    ,
    l.articleUserComments = function(e) {
        e = !0 === e;
        var o = d(".comment-form__modal .preloader-wrap")
          , r = d(".content-form__response--error");
        d("#comment-modal-opener" + (e ? "-sv" : "")).click(function(e) {
            e.preventDefault();
            var n = d("#comment-modal-opener");
            "True" !== SCM.UserCommentView.isUserLoggedIn ? (null == (e = d.deparam.querystring().returnUrl) && (e = location.pathname + location.search),
            window.location = "/sign-in?returnUrl=" + encodeURIComponent(e)) : (resetCommentForm(),
            d.ajax({
                url: (App.CurrentSubdomain.length ? "/" + App.CurrentSubdomain : "") + "/Content/SelfServeContent",
                type: "GET",
                data: {
                    selfServeContentId: "CommentsTermsAndConditions",
                    selfServeVersionId: 0
                }
            }).success(function(e) {
                showTermsAndConditions(e);
                var t = d("#divCommentModal");
                setTimeout(function() {
                    t.attr("tabindex", "-1").focus()
                }, 1e3);
                e = d(".icon-general-close");
                SCM.trapFocus.publicTrapFocus(t, e, n)
            }))
        }),
        d("#btnUserAgreeTerms").click(function(e) {
            var t, n;
            e.preventDefault(),
            validateTermsCheckbox() && (d("#TermsAndConditionsContainer, #termsAgreeRow, #termsButtonRow").hide(),
            d("#divUserCommentForm").show(),
            t = d("#divCommentModal"),
            n = d(".icon-general-close"),
            e = d(".comment-body__button"),
            t.attr("tabindex", "-1").focus(),
            SCM.trapFocus.publicTrapFocus(t, n, e))
        }),
        d("#divCommentModal .btnUserCommentSubmit").click(function(e) {
            e.preventDefault(),
            validateCommentForm() && (o.removeClass("hide"),
            submitCommentValues(),
            d("#divCommentModal").attr("tabindex", "-1").focus())
        }),
        d("#divCommentModal .btnModalCancel, #divCommentModal .btnCommentModalExit, .comment-form__close").click(function(e) {
            e.preventDefault(),
            d("#divCommentModal").foundation("reveal", "close"),
            d("#comment-modal-opener").focus()
        }),
        d('input[name="NoConflicts"]').change(function() {
            d(this).is(":checked") ? d(".disclosureBox").show() : d(".disclosureBox").hide()
        }),
        showTermsAndConditions = function(e) {
            d("#termsAgreeRow .lblTermsAndConditions.errors").hide(),
            d("#TermsAndConditionsContainer").html(e),
            d("#TermsAndConditionsContainer, #termsAgreeRow, #termsButtonRow").show(),
            d("#divCommentModal").foundation("reveal", "open")
        }
        ,
        validateTermsCheckbox = function() {
            var e = d("#termsAgreeRow #termsAndConditionsCheckbox");
            return e.length && !e.is(":checked") ? (d("#termsAgreeRow .lblTermsAndConditions.errors").show(),
            !1) : (d("#termsAgreeRow .lblTermsAndConditions.errors").hide(),
            !0)
        }
        ,
        validateCommentForm = function() {
            resetCommentFormValidation(),
            d.validity.setup({
                outputMode: "label"
            }),
            d.validity.start(),
            d("#divCommentModal .required").require();
            var e = d.validity.end()
              , t = d("#divUserCommentForm").find("textarea#Comment")
              , n = t.val()
              , t = parseInt(t.attr("maxlength"));
            return 0 < t && n.length > t && (n = n.substring(0, t)),
            "true" === SCM.UserCommentView.bShowDisclosure && d('input[name="NoConflicts"]').is(":checked") && "" === d('textarea[name="Disclosure"]').val() ? (d("#divCommentModal .lbldisclosure.errors").show(),
            !1) : e.valid
        }
        ,
        resetCommentForm = function() {
            d("#divUserCommentForm").hide();
            var e = d("#divCommentModal");
            e.find("input, textarea").val(""),
            e.find("#displayAlert, div.captchaAlert").hide(),
            d('input[name="NoConflicts"]').removeAttr("checked"),
            d("#termsAndConditionsCheckbox").attr("checked", !1),
            d(".disclosureBox").hide(),
            d("#divCommentModal .btnCommentModalExit").hide(),
            d("#recaptcha_reload").trigger("click");
            e = e.find("#Author");
            e.attr("value", e.attr("dataauthorvalue")),
            resetCommentFormValidation()
        }
        ,
        resetCommentFormValidation = function() {
            var e = d("#divCommentModal");
            e.find(".error").not(".lbldisclosure.errors").remove(),
            r.hide(),
            e.find(".lbldisclosure.errors").hide(),
            d("#termsAgreeRow .lblTermsAndConditions.errors").hide(),
            r.text("")
        }
        ,
        submitCommentValues = function() {
            var t = d("#divUserCommentForm")
              , e = SCM.UserCommentView.resourceType
              , n = SCM.UserCommentView.resourceId
              , i = ""
              , a = "";
            "true" === SCM.UserCommentView.showAffiliations && (i = t.find("input#AffInstitution").val()),
            "true" === SCM.UserCommentView.bShowDisclosure && (a = t.find("textarea#Disclosure").val()),
            d.ajax({
                type: "POST",
                url: "/Content/SubmitUserComment",
                data: {
                    author: t.find("input#Author").val(),
                    affInstitutions: i,
                    disclosure: a,
                    title: t.find("input#Title").val(),
                    comment: t.find("textarea#Comment").val(),
                    resourceType: e,
                    resourceId: n,
                    recaptchaChallege: d("#recaptcha_challenge_field").val(),
                    recaptchaResponse: d("#recaptcha_response_field").val(),
                    instanceName: SCM.UserCommentView.InstanceName
                },
                success: function(e) {
                    o.addClass("hide"),
                    !0 === e.Success ? (t.hide(),
                    d("#divCommentModal #displayAlert").show(),
                    d("#divCommentModal .btnCommentModalExit").show(),
                    "true" === SCM.UserCommentView.isNotModerated.toLowerCase() && location.reload()) : (o.addClass("hide"),
                    d("div.captchaAlert").show())
                },
                error: function(e) {
                    "401" === e.status ? (r.html("You must be logged in to submit a comment."),
                    window.location = "/sign-in?returnUrl=" + encodeURIComponent(window.location.pathname + window.location.search)) : r.html("Comments not saved. Please Try Again."),
                    o.addClass("hide"),
                    r.show()
                }
            })
        }
    }
    ,
    l.init = function() {
        l.detectIfFirefox(),
        l.initSkipNavToMainContent(),
        l.articleUserComments(),
        l.closeNavbarSearch(),
        l.expandNavbarSearch(),
        l.initAriaControls(),
        l.initFilterClickEvent(),
        l.initSearchResultsSort(),
        l.initFoundation(),
        l.initLazyLoad(),
        l.showAuthorInfo(),
        SCM.ChapterAnswerSet.registerAnswerLinkClick(),
        l.showFullAuthorList(),
        l.addAuthorFootnote(),
        l.showHideDropDown(),
        l.showRelatedBookWidgetIfHasContent(),
        l.showMoreRelatedContent(".grw-viewmorelink", ".grw-hide-me"),
        l.showMoreRelatedContent(".mrw-viewmorelink", ".mrw-hide-me"),
        l.showSpinner(),
        l.toggleMobileLanguageSubmenu(),
        l.toggleMobileMenu(),
        SCM.SiteJS.toggleMobileSignInForm(),
        l.toggleToolbarDropdown(),
        SCM.NavDropdown.registerNavDropdownEvents(),
        l.toggleMobileSearch(),
        l.toggleResponsiveLeftColumn(),
        SCM.PubHistory.registerToggle(),
        l.restrictedImages(),
        l.moveSubmitCommentLink(),
        l.addAuthorNotesJumpLink(),
        l.addDataSupplementsJumpLink(),
        l.addDataRepositoriesJumpLink(),
        l.addUserCommentJumpLink(),
        l.alertLinks(),
        l.alertKeyPress(),
        l.oupHeaderDropdowns(),
        l.initSigninForm(),
        l.initSelfServeNavigation(),
        l.toggleSelfServeNavigation(),
        l.setAllLinksTarget(),
        l.showPdfOnlyLink(),
        l.setBlockLink(),
        l.showFullDisclaimer(),
        l.showFullVersionInfo(),
        l.handleUnresolvedRelatedObjectLinks(),
        SCM.ChapterEndNotes.init(),
        SCM.ContentMetric.init()
    }
    ,
    l.windowLoadInit = function() {
        l.revealFigsTablesInModal(),
        l.revealFeaturedFigureInModal(),
        SCM.CitationModal.registerCitationModalEvents("getCitation"),
        l.launchSupersededContentModal(),
        l.setSelectedSearchFilter(),
        l.getNewSelectedFilter(),
        l.loadAllImagesIfUserIsAboutToUseJumpLinks(),
        l.showUnAuthenticatedSpans(),
        l.toggleSearchResultsDetails()
    }
    ,
    l.initArticleTopInfoAccessOptions = function() {
        var e = window.location.pathname.substring(0, window.location.pathname.indexOf("/", 2)) + "/sign-in?returnUrl=" + encodeURIComponent(window.location.pathname + window.location.search);
        d(".article-top-info-user-restricted-options").find(".article-top-info-sign-in").attr("href", e)
    }
}(SCM.SiteJS = SCM.SiteJS || {}, jQuery),
function(i) {
    function n() {
        SCM.SiteJS.getViewportWidth() <= 1023 ? a.addClass("mobile") : a.removeClass("mobile")
    }
    var t, a = i(".page-column--left"), o = (i(".datepicker__input"),
    i(".microsite-search")), r = i(".mobile-search-dropdown"), s = i(".navbar-menu, .navbar-search-collapsed"), l = i(".navbar-search-advanced, .navbar-search-close, .navbar-search"), c = (i(".js-master-header").height(),
    SCM.SiteJS.getViewportWidth());
    i(window).on("resize", function(e) {
        clearTimeout(t),
        t = setTimeout(function() {
            n();
            var e, t = SCM.SiteJS.getViewportWidth();
            c !== t && (1023 <= c && i(".dropdown-panel, .site-menu").removeAttr("style"),
            a.hasClass("js-filters-open") ? c < t && 1023 < t && i(document.body).removeClass("noscroll") : (i(document.body).removeClass("noscroll"),
            a.hide(),
            i(".responsive-issue-nav").hide(),
            i(".page-column--left, .responsive-issue-nav, .issue-dropdown-wrap").removeAttr("style"),
            c = SCM.SiteJS.getViewportWidth()),
            (c <= 930 || 1101 <= c) && (s.removeAttr("style"),
            l.removeAttr("style"),
            i(".js-navbar-search-container").removeClass("tablet-viewport-active").addClass("tablet-viewport-layout")),
            931 <= c && (r.removeAttr("style"),
            o.removeAttr("style"),
            i(".dropdown-panel-wrap").children(".is-active").hide().removeClass("is-active"),
            i(".mobile-dropdown-toggle").removeClass("is-active"))),
            i(".al-author-info-wrap.open:visible").length && i("#ContentColumn:visible").length && (e = i(".al-author-info-wrap.open"),
            i(window).width() < 1200 ? (t = (t = i("#ContentColumn")).position().left + t.width(),
            SCM.SiteJS.shiftOpenAuthorCards(e, t)) : e.removeClass("shift-card"))
        }, 10),
        SCM.TreeBrowse.checkPageHeightForSeriesDropdown()
    }),
    window.addEventListener("orientationchange", function() {
        var e = i(window).scrollTop();
        i("body").animate({
            scrollTop: e
        }, 0)
    }, !1),
    i(window).on("load", function() {
        SCM.SiteJS.windowLoadInit(),
        SCM.SiteJS.adjustRelatedTagsDisplay()
    }),
    i(function() {
        SCM.Logging.init(),
        SCM.JqueryMigrateLogger.init(),
        n(),
        SCM.SiteJS.init(),
        SCM.Toolbar.init(),
        SCM.PDFAccess.init(),
        SCM.SiteJS.setAccessIcons(),
        SCM.StickyElements.init(),
        SCM.AddReturnUrlToSocietyLinks(),
        SCM.JumpLinks.init(),
        SCM.RefLinks.init(),
        SCM.SiteJS.citationAriaExpand(),
        window.matchMedia("print") && i(".video-js").length && SCM.Utilities.Brightcove.init(),
        i(".custom-scroll").jScrollPane(),
        0 < i(".widget-ArticleFulltext").length && SCM.ArticleFulltext.init(),
        SCM.SiteJS.configureMathjax(),
        0 < i(".widget-BookChapterMainView").length && SCM.BookChapterMainView.init(),
        SCM.BookMetadata.init(),
        SCM.SiteJS.triggerAlertModalOnRedirect(),
        SCM.SiteJS.triggerSaveSearchModelOnRedirect(),
        SCM.SplitScreen.init(),
        SCM.TreeBrowse.init(),
        SCM.LoginBox.init()
    }),
    i(document).ajaxStart(function() {
        i("body").css("cursor", "wait")
    }).ajaxComplete(function(e, t, n) {
        SCM.SiteJS.initFoundation(),
        SCM.SiteJS.initSearchResultsSort(),
        SCM.SolrSearch.ajaxComplete(),
        SCM.SiteJS.setAccessIcons(),
        SCM.SiteJS.setAllLinksTarget(),
        SCM.SiteJS.toggleResponsiveLeftColumn(),
        SCM.SiteJS.citationAriaExpand(),
        i("body").css("cursor", "default"),
        SCM.SiteJS.abstractMathJax(),
        n.url.indexOf("brightcove") < 0 && !window.matchMedia("print") && SCM.Utilities.Brightcove.init(),
        SCM.TreeBrowse.checkPageHeightForSeriesDropdown()
    })
}(jQuery);
var SCM = SCM || {};
!function(e, d) {
    var u = !1
      , h = d(".js-login-box-placeholder")
      , f = "";
    function p() {
        var e;
        "" === f && d("#RedirectSiteUrl").length && (e = d("#RedirectSiteUrl").val(),
        f = SCM.ZEncoderV1.Decode(e))
    }
    function g(e, n) {
        var i = e.attr("href").split("&");
        d.each(i, function(e, t) {
            t.startsWith("redirect_uri") && (t = t.split("?"),
            i[e] = "redirect_uri=" + f + "/HTTPHandlers/" + n,
            1 < t.length && (i[e] += "?" + t[1]))
        }),
        e.attr("href", i.join("&"))
    }
    function m(e, t) {
        var n = d(e).attr("href");
        for (-1 !== t.indexOf("?%23") && (t = t.replace("?%23", "%23")); -1 < n.indexOf('"'); )
            n = n.replace('"', "%22");
        for (; -1 < n.indexOf("RedirectUrlPlaceholder"); )
            n = n.replace("RedirectUrlPlaceholder", t);
        d(e).attr("href", n)
    }
    function t(e, t) {
        return e.replace("&" + t, "").replace("?" + t, "?").replace("?&", "?")
    }
    function v() {
        var e = t(e = window.location.href, "login=true");
        return (e = t(e, "error=login_retry")).includes("token=") && (e = e.substring(0, e.indexOf("token=") - 1)),
        e.endsWith("?") && (e = e.slice(0, -1)),
        SCM.ZEncoderV1.Encode(e)
    }
    function b() {
        d(".js-login-box-placeholder").css("z-index", "auto"),
        d("#InfoColumn").css("z-index", 6e3),
        h.addClass("hide")
    }
    function n(e) {
        "Escape" === e.key && b()
    }
    function i(e) {
        var t, n, i, a, o, r, s, l, c;
        y(e, d(".js-account-button")) ? (h.toggleClass("hide"),
        d(".site-menu-lvl-0").find(".site-menu:visible").slideToggle("fast"),
        d(".f-dropdown:visible").slideToggle("fast"),
        u || (l = h,
        c = App.CurrentSubdomain.length ? "/" + App.CurrentSubdomain : "",
        d.get(c + "/Accounts/LoginBox/LoginBox").done(function(e) {
            l.html(e),
            u = !0,
            SCM.AddReturnUrlToSocietyLinks(),
            p()
        })),
        d(".js-login-box-placeholder").css("z-index", 6e3),
        d("#InfoColumn").css("z-index", "auto")) : y(e, d(".js-sign-out-link")) ? (s = v(),
        d(".js-sign-out-link").each(function(e) {
            m(d(this), s),
            g(d(this), "SAMS/LogoutHandler.ashx")
        }),
        window.location.href = d(".js-sign-out-link").attr("href")) : y(e, d(".js-sign-in-link")) ? ((r = v()).includes("signzyin") && r.includes("returnUrl") && (c = d.deparam.querystring().returnUrl,
        r = c.includes("httpszazjzj") ? c : SCM.ZEncoderV1.Encode(c)),
        d(".js-sign-in-link").not(".js-shibboleth-login").each(function(e) {
            m(d(this), r),
            g(d(this), "Sigma/LoginHandler.ashx")
        }),
        d(".js-sign-in-link.js-shibboleth-login").each(function(e) {
            var t = encodeURIComponent(f + "/HTTPHandlers/Sigma/LoginHandler.ashx?state=xredirecturl%3D" + r);
            m(d(this), t)
        }),
        window.location.href = d(".js-sign-in-link").attr("href")) : y(e, d(".js-register-link")) ? ((o = v()).includes("signzyin") && o.includes("returnUrl") || d(".js-register-link").each(function(e) {
            var t = (t = d(this).attr("href")).substring(0, t.indexOf("returnUrl="));
            t += "returnUrl=" + o,
            d(this).attr("href", t)
        }),
        window.location.href = d(".js-register-link").attr("href")) : y(e, d(".js-login-help")) ? (t = d(".js-login-help"),
        n = t,
        i = d("#divAccessHelp"),
        a = i.find(".js-access-help-close"),
        i.off("opened.fndtn.reveal"),
        i.on("opened.fndtn.reveal", function() {
            SCM.trapFocus.publicTrapFocus(i, a, n),
            a.off("click"),
            a.on("click", function(e) {
                e.stopPropagation(),
                i.foundation("reveal", "close"),
                n.focus()
            }),
            i.focus()
        }),
        i.foundation("reveal", "open")) : (t = e,
        (e = h).is(t.target) || e.has(t.target).length || b())
    }
    function y(e, t) {
        return t.is(e.target) || t.has(e.target).length
    }
    e.init = function() {
        p(),
        d(document).on("click", i),
        d(document).on("keyup", n)
    }
}(SCM.LoginBox = SCM.LoginBox || {}, jQuery);
var SCM = SCM || {};
!function(e, w) {
    e.initTestPassword = function(e, t, n) {
        var i = /[A-Z---------------------------------------------------]|\ud801[\udc00-\udc27]|\ud835[\udc00-\udc19\udc34-\udc4d\udc68-\udc81\udc9c\udc9e-\udc9f\udca2\udca5-\udca6\udca9-\udcac\udcae-\udcb5\udcd0-\udce9\udd04-\udd05\udd07-\udd0a\udd0d-\udd14\udd16-\udd1c\udd38-\udd39\udd3b-\udd3e\udd40-\udd44\udd46\udd4a-\udd50\udd6c-\udd85\udda0-\uddb9\uddd4-\udded\ude08-\ude21\ude3c-\ude55\ude70-\ude89\udea8-\udec0\udee2-\udefa\udf1c-\udf34\udf56-\udf6e\udf90-\udfa8\udfca]/
          , a = /[a-z---------------------------------------------------------------]|\ud801[\udc28-\udc4f]|\ud835[\udc1a-\udc33\udc4e-\udc54\udc56-\udc67\udc82-\udc9b\udcb6-\udcb9\udcbb\udcbd-\udcc3\udcc5-\udccf\udcea-\udd03\udd1e-\udd37\udd52-\udd6b\udd86-\udd9f\uddba-\uddd3\uddee-\ude07\ude22-\ude3b\ude56-\ude6f\ude8a-\udea5\udec2-\udeda\udedc-\udee1\udefc-\udf14\udf16-\udf1b\udf36-\udf4e\udf50-\udf55\udf70-\udf88\udf8a-\udf8f\udfaa-\udfc2\udfc4-\udfc9\udfcb]/
          , o = /[!"#$%&'()*+,-./:;<=>?@[\]\\^_`{|}~]/
          , r = /[0-9]/
          , s = ""
          , l = w(".password-input-check-wrap")
          , c = l.find(".icon-case")
          , d = (l.find(".password-confirm-icon"),
        l.find(".password-input-icon"))
          , u = l.find(".icon-length")
          , h = l.find(".icon-number")
          , f = l.find(".icon-lower-case")
          , p = l.find(".icon-special-char")
          , g = l.find(".password-check-wrap")
          , m = w(".password-confirm-wrap")
          , v = m.find(".password-confirm-icon")
          , b = w(".js-sigma-enabled")
          , y = !1;
        function S(e) {
            s === e ? (v.hide(),
            y && (m.find(n).addClass("btn-green"),
            m.find(".register-button-overlay").hide())) : ("" === e || null === e ? v.hide() : v.show(),
            SCM.MyAccount.lockRegistrationButton())
        }
        l.on("keyup", e, function() {
            var e = w(this).val();
            s = e,
            y ? g.hide() : g.show(),
            10 <= e.length ? SCM.MyAccount.showValidPasswordCriteria(u) : SCM.MyAccount.showInvalidPasswordCriteria(u),
            i.test(e) ? SCM.MyAccount.showValidPasswordCriteria(c) : SCM.MyAccount.showInvalidPasswordCriteria(c),
            r.test(e) ? SCM.MyAccount.showValidPasswordCriteria(h) : SCM.MyAccount.showInvalidPasswordCriteria(h),
            a.test(e) ? SCM.MyAccount.showValidPasswordCriteria(f) : SCM.MyAccount.showInvalidPasswordCriteria(f),
            o.test(e) ? SCM.MyAccount.showValidPasswordCriteria(p) : SCM.MyAccount.showInvalidPasswordCriteria(p),
            u.hasClass("green") && c.hasClass("green") && h.hasClass("green") && (0 === b.length || f.hasClass("green") && p.hasClass("green")) ? (y = !0,
            g.fadeOut(1500),
            d.hide(),
            e === l.find(t).val() && ($iconConfirm.hide(),
            l.find(n).addClass("btn-green"),
            l.find(".register-button-overlay").hide())) : (y = !1,
            g.show(),
            SCM.MyAccount.lockRegistrationButton(),
            d.show()),
            "" !== e && null !== e || (g.hide(),
            d.hide());
            e = w(t).val();
            e && S(e)
        }),
        m.on("keyup", t, function() {
            S(w(this).val())
        }),
        w(document).on("click", function() {
            g.hide()
        })
    }
}(SCM.TestPassword = SCM.TestPassword || {}, jQuery);
var SCM = SCM || {};
!function(e, r) {
    e.setActiveJumplink = function() {
        r(".section-jump-link").on("click", function() {
            r(".section-jump-link").removeClass("active"),
            r(this).closest(".section-jump-link").addClass("active")
        })
    }
    ,
    e.toggleNestedJumplinks = function() {
        r(".section-jump-link .list-toggle, .section-jump-link .mobile-list-toggle").on("click", function(e) {
            e.preventDefault();
            var t = r(this)
              , n = t.parents(".section-jump-link__link-wrap").siblings("ul.section-jump-link__sublist")
              , i = "icon-general-arrow-filled-right"
              , a = "icon-general-arrow-filled-down"
              , o = "icon-general_arrow-right"
              , e = "icon-general_arrow-down";
            t.hasClass("list-toggle") && (t.hasClass(i) ? t.removeClass(i).addClass(a) : t.removeClass(a).addClass(i)),
            t.hasClass("mobile-list-toggle") && (t.hasClass(o) ? t.removeClass(o).addClass(e) : t.removeClass(e).addClass(o)),
            "false" === t.attr("aria-expanded") ? t.attr("aria-expanded", "true") : t.attr("aria-expanded", "false"),
            n.slideToggle(),
            "false" === n.attr("aria-hidden") ? n.attr("aria-hidden", "true") : n.attr("aria-hidden", "false")
        })
    }
    ,
    e.filterTopicTerms = function() {
        r(".issue-topic__input").keyup(function() {
            r(".issue-topic__term").hide();
            var e = r(this).val()
              , t = e.toLowerCase();
            r.extend(r.expr[":"], {
                containsIN: function(e, t, n, i) {
                    return 0 <= (e.textContent || e.innerText || "").toLowerCase().indexOf((n[3] || "").toLowerCase())
                }
            }),
            r(".issue-topic__term:containsIN('" + t + "')").show(),
            null !== e && "" !== e || r(".issue-topic__term").show()
        })
    }
    ,
    e.updateIssueBrowseOnChange = function() {
        r(".issue-browse-select").on("change", function() {
            window.location.href = r(this).val()
        })
    }
}(SCM.Issues = SCM.Issues || {}, jQuery),
jQuery(document).ready(function(n) {
    SCM.Issues.filterTopicTerms(),
    SCM.Issues.toggleNestedJumplinks(),
    SCM.Issues.updateIssueBrowseOnChange(),
    window.location.hash && n('.js-jumplink[href="' + window.location.hash + '"]').addClass("active").parents(".section-jump-link").slice(1).children(".section-jump-link__link-wrap").children(".list-toggle").click(),
    SCM.SiteJS.getViewportWidth() <= 900 && n("#IssuesList > option").each(function() {
        var e, t = n(this).text();
        47 < t.length && (0 < (e = t.substr(0, 47).lastIndexOf(" ")) && (e = t.substr(0, e) + "...",
        n(this).text(e)))
    })
});
var SCM = SCM || {};
!function(ns, $) {
    var baseSiteUrl = $("#hfSiteURL");
    function hasInputErrors(e, t) {
        var n = $("#myaccount-tabs-content");
        n.find(".success-message").html("").hide(),
        n.find(".error-message").html("").hide();
        var i = /[<>]/;
        if (i.test(e) || i.test(t)) {
            t = n.find("#err-message-angle-brackets").html();
            return n.find(".error-message").html(t).show(),
            $("html, body").animate({
                scrollTop: n.offset().top
            }, 10),
            1
        }
    }
    function showPersonalInfoErrors(e) {
        var t = $("#myaccount-tabs-content");
        t.find(".error-message").html(e.Html).show(),
        $("html, body").animate({
            scrollTop: t.offset().top
        }, 10)
    }
    function updatePersonalInfo(e, t) {
        var n = $("#myaccount-tabs-content");
        $(".js-header-account-info-user-fullname").html(t),
        n.find(".success-message").html(e.Html).show();
        n = $(".at-authenticated-user");
        n.length && n.text().length && (0 < (e = n.text().split(":")).length && n.text(e[0] + ": " + t))
    }
    ns.initMyAccount = function() {
        var t, n = $(".myaccount-tabs-inner-wrap"), i = $(".mobile-nav-icon");
        $(document).on("click", ".myaccount-mobile-nav", function(e) {
            e.stopPropagation(),
            n.toggle(),
            i.hasClass("icon-general-arrow-filled-down") ? i.removeClass("icon-general-arrow-filled-down").addClass("icon-general-arrow-filled-up") : i.removeClass("icon-general-arrow-filled-up").addClass("icon-general-arrow-filled-down")
        }),
        $(document).click(function() {
            n.hide().removeAttr("style")
        }),
        $(window).on("scroll", function(e) {
            clearTimeout(t),
            t = setTimeout(function() {
                n.removeAttr("style")
            }, 50)
        }),
        $(window).on("resize", function(e) {
            clearTimeout(t),
            t = setTimeout(function() {
                n.removeAttr("style")
            }, 50)
        });
        var e = $(".myaccount-tabs-inner-wrap").find("li.is-active");
        $("#myaccount-tabs").find(".myaccount-current-label").html(e.text()),
        $(document).on("click", ".js-kbart-journal-download", function() {
            var e = $(this).data("id")
              , t = $(this).data("institution");
            $.post("/OUPKbart/GetKbartJournalFile", {
                institutionAcctId: e,
                institutionName: t,
                email: "nrntest1@silverchair.com"
            }, function(e) {
                alert("processing - email will be sent")
            })
        }),
        $(document).on("click", "#myaccount-tabs-content .js-update-acct-sigma", function() {
            $("#updatePersonalDetailsBtn").addClass("disabled");
            var e = $("#myaccount-tabs-content")
              , t = e.find("#FullName").val()
              , n = e.find("#Phone").val()
              , i = e.find("#CountryList").val()
              , e = $("#myaccount-tabs-content").find("#MyAccountToken").val();
            hasInputErrors(t, n) || $.post("/OUPMyAccount/UpdateAccountSigma", {
                fullname: t,
                phone: n,
                country: i,
                token: e
            }, function(e) {
                $("#updatePersonalDetailsBtn").removeClass("disabled"),
                null != e && (e.ReturnId && $("#myaccount-tabs-content").find("#MyAccountToken").val(e.ReturnId),
                e.Success ? updatePersonalInfo(e, t) : showPersonalInfoErrors(e))
            })
        }),
        $(document).on("click", "#myaccount-tabs-content .js-update-acct", function() {
            var t = $("#myaccount-tabs-content");
            t.find(".success-message").html("").hide(),
            t.find(".error-message").html("").hide();
            var e = t.find("#Title").val()
              , n = t.find("#FirstName").val()
              , i = t.find("#LastName").val()
              , a = t.find("#Phone").val()
              , o = t.find("#CountryList").val()
              , r = $("#myaccount-tabs-content").find("#MyAccountToken").val()
              , s = /[<>]/;
            if (s.test(e) || s.test(n) || s.test(i) || s.test(a)) {
                s = t.find("#err-message-angle-brackets").html();
                return t.find(".error-message").html(s).show(),
                void $("html, body").animate({
                    scrollTop: t.offset().top
                }, 10)
            }
            $.post("/OUPMyAccount/UpdateAccount", {
                title: e,
                firstName: n,
                lastName: i,
                phone: a,
                country: o,
                token: r
            }, function(e) {
                null != e && (e.ReturnId && $("#myaccount-tabs-content").find("#MyAccountToken").val(e.ReturnId),
                e.Success ? ($(".js-header-account-info-user-fullname").html(n + " " + i),
                t.find(".success-message").html(e.Html).show()) : (t.find(".error-message").html(e.Html).show(),
                $("html, body").animate({
                    scrollTop: t.offset().top
                }, 10)))
            })
        });
        var d = $("#change-password").find(".error-message").html();
        SCM.TestPassword.initTestPassword("#newPassword", "#confirmNewPassword", "#changePasswordBtn"),
        $(document).on("click", "#changePasswordBtn", function() {
            var t = $("#change-password")
              , n = t.find(".success-message");
            n.hide();
            var i = t.find(".error-message");
            i.html(d).hide();
            var e = {}
              , a = t.find("#currentPassword").val()
              , o = !1;
            "" === a && (e.currentPassword = $("label[for=currentPassword]").text().replace("*", ""),
            o = !0);
            var r = t.find("#newPassword").val();
            "" === r && (e.newPassword = $("label[for=newPassword]").text().replace("*", ""),
            o = !0);
            var s = t.find("#confirmNewPassword").val();
            if ("" === s && (e.confirmNewPassword = $("label[for=confirmNewPassword]").text().replace("*", ""),
            o = !0),
            o) {
                for (var l in e)
                    i.append("<p> * " + e[l] + "</p>").show();
                $("html, body").animate({
                    scrollTop: t.offset().top
                }, 10)
            } else {
                i.html("");
                var o = $("#myaccount-tabs-content").find("#MyAccountToken").val()
                  , c = $(".js-sigma-enabled").length;
                $.post("/OUPMyAccount/ChangePassword", {
                    currentPassword: a,
                    newPassword: r,
                    confirmNewPassword: s,
                    token: o
                }, function(e) {
                    e && (e.ReturnId && $("#myaccount-tabs-content").find("#MyAccountToken").val(e.ReturnId),
                    e.Messages && e.Messages.length && "1" === e.Messages[0] ? (n.show(),
                    0 === c && $.post("/LOGIN", {
                        user: e.Messages[1],
                        pass: r,
                        dest: "/HTTPHandlers/SAMs/LoginHandler.ashx"
                    }).done(function(e) {
                        "1" !== e ? location.href = "/sign-in" : $.post("/OUPMyAccount/RefreshToken", {}, function(e) {
                            null !== e && e.ReturnId && $("#myaccount-tabs-content").find("#MyAccountToken").val(e.ReturnId)
                        })
                    })) : (e.Messages && e.Messages.length && e.Messages[1] && i.html(e.Messages[1]).show(),
                    $("html, body").animate({
                        scrollTop: t.offset().top
                    }, 10)))
                })
            }
        });
        var l = $("#change-email-address").find(".error-message").html();
        $(document).on("click", "#changeEmailBtn", function() {
            var t = $("#change-email-address");
            t.find(".success-message").html("");
            var n = t.find(".error-message");
            n.html(l).hide();
            var e = {}
              , i = !1
              , a = t.find("#newEmailAddress").val();
            "" === a && (e.newEmailAddress = $("label[for=newEmailAddress]").text().replace("*", ""),
            i = !0);
            var o = t.find("#confirmNewEmailAddress").val();
            "" === o && (e.confirmNewEmailAddress = $("label[for=confirmNewEmailAddress]").text().replace("*", ""),
            i = !0);
            var r = t.find("#currentPassword").val();
            if (void 0 !== r && "" === r && (e.password = $("label[for=currentPassword]").text().replace("*", ""),
            i = !0),
            i) {
                for (var s in e)
                    n.append("<p>" + e[s] + "</p>").show();
                $("html, body").animate({
                    scrollTop: t.offset().top
                }, 10)
            } else {
                n.html("");
                i = $("#myaccount-tabs-content").find("#MyAccountToken").val();
                $.post("/OUPMyAccount/RequestEmailAddressChange", {
                    newEmailAddress: a,
                    confirmNewEmailAddress: o,
                    password: r,
                    token: i
                }, function(e) {
                    null != e && (e.ReturnId && $("#myaccount-tabs-content").find("#MyAccountToken").val(e.ReturnId),
                    null == e.Messages || null == e.Messages[0] || "" == e.Messages[0] ? (t.children(".change-email-address-form").hide(),
                    t.children(".change-email-address-verification").show()) : n.html(e.Messages[0]).show())
                })
            }
        }),
        $(document).on("click", "#changeEmailVerificationBtn", function() {
            var n = $("#change-email-address")
              , i = n.find(".success-message");
            i.html("").hide();
            var a = n.find(".error-message");
            a.html("").hide();
            var e = n.find("#changeEmailVerificationCode").val();
            0 < e.length && $.post("/OUPMyAccount/VerifyEmailAddressChange", {
                verificationCode: e
            }, function(e) {
                var t;
                "1" == e[0] ? "True" === n.find("#hfUseSigma").val() ? (t = n.find("#hfSigmaLogoutUrl").val(),
                window.location.href = t) : (i.html(e[1]).show(),
                $.get("/LOGOUT", {
                    dest: "/HTTPHandlers/SAMs/LogoutHandler.ashx"
                }).done(function() {}).fail(function() {})) : (a.html(e[1]).show(),
                $("html, body").animate({
                    scrollTop: n.offset().top
                }, 10))
            })
        }),
        $(".js-newPassowrd").on("paste", function(e) {
            return e.preventDefault(),
            !1
        })
    }
    ,
    ns.initSavedSearches = function() {
        $(".solrSearchSaveWidget table.tablesorter").tablesorter({
            theme: "default",
            delayInit: !0,
            ignoreCase: !0,
            headers: {
                4: {
                    sorter: !1
                }
            },
            sortList: [[0, 0]]
        }),
        $(".solrSearchSaveWidget .save-search-delete").click(function() {
            SCM.MyAccount.deleteSaveSearch($(this))
        }),
        $(".solrSearchSaveWidget .ddlSearchAlertFrequencyMyAccount").change(function() {
            SCM.MyAccount.changeUserAlert($(this))
        }),
        $(".solrSearchSaveWidget .save-search-rename-rename").click(function() {
            var e = $(this).closest("td")
              , t = e.find(".save-search-name-link");
            t.hide(),
            e.find(".save-search-input").val(t.text()).css("display", "inline-block").focus(),
            e.find(".save-search-rename-cancel").show(),
            e.find(".save-search-rename-save").show(),
            $(this).hide()
        }),
        $(".solrSearchSaveWidget .save-search-rename-cancel").click(function() {
            var e = $(this).closest("td");
            e.find(".save-search-name-link").show(),
            e.find(".save-search-input").hide(),
            e.find(".save-search-rename-rename").show(),
            e.find(".save-search-rename-save").hide(),
            $(this).hide()
        }),
        $(".solrSearchSaveWidget .save-search-rename-save").click(function() {
            var e = $(this)
              , t = e.closest("td")
              , n = t.find(".save-search-input")
              , i = e.closest("tr").data("usersearchid")
              , a = n.val()
              , e = t.find(".save-search-name-link");
            a.length && (SCM.MyAccount.renameSaveSearch(a, i, e),
            n.hide(),
            e.show(),
            t.find(".save-search-rename-rename").show(),
            t.find(".save-search-rename-cancel").hide(),
            $(this).hide())
        }),
        $(".solrSearchSaveWidget .save-search-input").on("keypress", function(e) {
            var t = $(this).closest("td")
              , n = $(this).val()
              , i = t.find(".save-search-name-link");
            13 === (e.keyCode || e.which) && (e.preventDefault(),
            n.length && (e = t.closest("tr").data("usersearchid"),
            SCM.MyAccount.renameSaveSearch(n, e, i),
            $(this).hide(),
            i.show(),
            t.find(".save-search-rename-rename").show(),
            t.find(".save-search-rename-save").hide(),
            t.find(".save-search-rename-cancel").hide()))
        })
    }
    ,
    ns.bindTableSorter = function(e) {
        $(e).trigger("update");
        var t = $(e).get(0).config.sortList;
        $(e).trigger("sorton", [t])
    }
    ,
    ns.deleteSaveSearch = function(delElem) {
        $(".alerts-wrap-cover").removeClass("uncovered"),
        $(".alerts-wrap-cover").addClass("covered");
        var ajaxUrl = "//" + baseSiteUrl.val() + "/Solr/DeleteSolrSearchInfoWithToken"
          , parentElem = delElem.closest("tr")
          , id = parentElem.data("usersearchid")
          , userAlertId = parentElem.data("useralertid")
          , token = $("#SolrSearchAuthToken").val();
        $.ajax({
            url: ajaxUrl,
            type: "POST",
            dataType: "json",
            cache: !1,
            data: {
                userSearchId: id,
                userAlertId: userAlertId,
                token: token
            },
            success: function(e) {
                null != e && (e.ReturnId && $("#SolrSearchAuthToken").val(e.ReturnId),
                $(".solrSearchSaveWidget .solrSearchSaveModel .message").html(e.Html).parent().foundation("reveal", "open"),
                e.Success && parentElem.remove())
            },
            error: function(xmlHttpRequest, textStatus, errorThrown) {
                var err;
                window.console && (err = eval("(" + xmlHttpRequest.responseText + ")"),
                console.log("error: " + err),
                console.log("status: " + textStatus))
            }
        }).done(function() {
            SCM.MyAccount.bindTableSorter($(".saved-searches-table.tablesorter")),
            $(".alerts-wrap-cover").removeClass("covered"),
            $(".alerts-wrap-cover").addClass("uncovered")
        })
    }
    ,
    ns.changeUserAlert = function(upElem) {
        var ajaxUrl = "//" + baseSiteUrl.val() + "/Solr/UpdateUserAlertWithToken"
          , parentElem = upElem.closest("tr")
          , id = parentElem.data("usersearchid")
          , userAlertId = parentElem.data("useralertid")
          , scheduleId = upElem.val()
          , token = $("#SolrSearchAuthToken").val();
        $(".alerts-wrap-cover").removeClass("uncovered"),
        $(".alerts-wrap-cover").addClass("covered"),
        $.ajax({
            url: ajaxUrl,
            type: "POST",
            dataType: "json",
            cache: !1,
            data: {
                userSearchId: id,
                userAlertId: userAlertId,
                scheduleId: scheduleId,
                token: token
            },
            success: function(e) {
                var t;
                null != e && (null != (t = JSON.parse(e.ReturnId)) && null != t.Token && $("#SolrSearchAuthToken").val(t.Token),
                $(".solrSearchSaveWidget .solrSearchSaveModel .message").html(e.Html).parent().foundation("reveal", "open"),
                e.Success && null != t && null != t.ReturnId && parentElem.data("useralertid", t.ReturnId))
            },
            error: function(xmlHttpRequest, textStatus, errorThrown) {
                var err;
                window.console && (err = eval("(" + xmlHttpRequest.responseText + ")"),
                console.log("error: " + err),
                console.log("status: " + textStatus))
            }
        }).done(function() {
            $(".alerts-wrap-cover").removeClass("covered"),
            $(".alerts-wrap-cover").addClass("uncovered")
        })
    }
    ,
    ns.renameSaveSearch = function(searchName, userSearchId, $linkElement) {
        var ajaxUrl = "//" + baseSiteUrl.val() + "/Solr/RenameSolrSearchInfoWithToken"
          , token = $("#SolrSearchAuthToken").val();
        $.ajax({
            url: ajaxUrl,
            type: "POST",
            dataType: "json",
            cache: !1,
            data: {
                searchName: searchName,
                userSearchId: userSearchId,
                token: token
            },
            success: function(e) {
                null != e && (e.ReturnId && $("#SolrSearchAuthToken").val(e.ReturnId),
                "Updated Successfully" == e.Html && $linkElement.text(searchName),
                $(".solrSearchSaveWidget .solrSearchSaveModel .message").html(e.Html).parent().foundation("reveal", "open"))
            },
            error: function(xmlHttpRequest, textStatus, errorThrown) {
                var err;
                window.console && (err = eval("(" + xmlHttpRequest.responseText + ")"),
                console.log("error: " + err),
                console.log("status: " + textStatus))
            }
        }).done(function() {
            SCM.MyAccount.bindTableSorter($(".saved-searches-table.tablesorter"))
        })
    }
    ,
    ns.initRegister = function(e) {
        var f = $(".widget-Register");
        null != e && 0 < e.length && (f.find(".error-message").html(e).show(),
        SCM.MyAccount.clearLastErrorMessage()),
        f.on("click", "#showPassword", function() {
            f.find("#Password, #ConfirmPassword").each(function() {
                var e = $(this).clone();
                e.attr("type", "text"),
                e.attr("autocomplete", "off"),
                e.attr("value", $(this).val()),
                $(this).after(e),
                $(this).remove()
            }),
            $(this).hide(),
            $(this).siblings("#hidePassword").show()
        }),
        f.on("click", "#hidePassword", function() {
            f.find("#Password, #ConfirmPassword").each(function() {
                var e = $(this).clone();
                e.attr("type", "password"),
                e.removeAttr("autocomplete"),
                e.attr("value", $(this).val()),
                $(this).after(e),
                $(this).remove()
            }),
            $(this).hide(),
            $(this).siblings("#showPassword").show()
        }),
        f.on("click", "#registerBtn", function() {
            f.find(".error-message").html().hide,
            $("#registerBtn").addClass("disabled");
            var t = f.find("#EmailAddress").val()
              , n = f.find("#Password").val()
              , e = f.find("#ConfirmPassword").val()
              , i = f.find("#hpcName").val()
              , a = (f.find(".txtCaptchaInput").val(),
            $("#recaptcha_challenge_field").val(),
            $("#recaptcha_response_field").val(),
            f.find("#registerIssueAlert"))
              , o = $(".js-captcha-simple").length
              , r = $(".js-captcha-normal").length
              , s = $(".js-captcha-input").val()
              , l = !1;
            null != a && (l = !!a.is(":checked"));
            var c = f.find("#hfAlertJournalId")
              , a = null != c && 0 < c.length ? c.val() : 0
              , c = f.find("#hfAlertSiteId")
              , c = null != c && 0 < c.length ? c.val() : 0
              , d = l ? "?siteId=" + c + "&journalId=" + a : ""
              , u = $(".js-sigma-enabled").length
              , h = $("#sigmaSigninUrl").val();
            0 < i.length ? (console.log("Honeypot captcha triggered. Are you a bot?"),
            $("#registerBtn").removeClass("disabled")) : $.post("/OUPMyAccount/Register", {
                email: t,
                password: n,
                confirmPassword: e,
                alertSiteId: l ? c : 0,
                alertJournalId: l ? a : 0,
                captchaResponse: r ? grecaptcha.getResponse() : "",
                simpleCaptchaResponse: o ? s : ""
            }, function(e) {
                $("#registerBtn").removeClass("disabled"),
                "OK" === e ? u ? window.location = h : $.post("/LOGIN", {
                    user: t,
                    pass: n,
                    dest: "/HTTPHandlers/SAMs/LoginHandler.ashx" + d
                }).done(function(e) {
                    "1" === e ? SCM.SiteJS.loginReturnBack() : f.find(".error-message").html("The account has been created, but the login failed. Please try login again.").show()
                }) : window.location.reload()
            })
        }),
        SCM.TestPassword.initTestPassword("#Password", "#ConfirmPassword", "#registerBtn")
    }
    ,
    ns.clearLastErrorMessage = function() {
        $.post("/OUPMyAccount/ClearLastErrorMessage")
    }
    ,
    ns.lockRegistrationButton = function() {
        $(".register-form-wrap").find("#registerBtn").removeClass("btn-green"),
        $(".register-form-wrap").find(".register-button-overlay").show()
    }
    ,
    ns.showValidPasswordCriteria = function(e) {
        e.removeClass("icon-general-close red").addClass("icon-general-check green"),
        e.siblings(".password-check-label").addClass("fade")
    }
    ,
    ns.showInvalidPasswordCriteria = function(e) {
        e.removeClass("icon-general-check green").addClass("icon-general-close red"),
        e.siblings(".password-check-label").removeClass("fade")
    }
    ,
    ns.initForgotPassword = function() {
        var e = $("#forgot-password").find(".error-message").html();
        $("#forgotPasswordBtn").on("click", function() {
            var n = $("#forgot-password")
              , i = n.find(".success-message")
              , a = n.find(".error-message");
            i.html("").hide(),
            a.html(e).hide();
            var o = n.find("#contactEmail").val();
            0 < o.length ? $.post("/OUPMyAccount/ForgotPassword", {
                email: o
            }, function(e) {
                var t;
                null == e || "" == e ? (t = n.find(".success-message-template").html().replace("{0}", o),
                i.html(t).show()) : (a.html(e).show(),
                $("html, body").animate({
                    scrollTop: n.offset().top
                }, 10))
            }, "html") : (a.append("<p> * " + $("label[for=contactEmail]").text().replace("*", "") + "</p>").show(),
            $("html, body").animate({
                scrollTop: n.offset().top
            }, 10))
        })
    }
    ,
    ns.initResetPassword = function() {
        $("#changePasswordBtn").on("click", function() {
            var t = $("#change-password")
              , n = t.find(".success-message")
              , i = t.find(".error-message")
              , e = $.deparam.querystring().t
              , a = t.find("#newPassword").val()
              , o = t.find("#confirmNewPassword").val();
            $.post("/OUPMyAccount/ResetPassword", {
                token: e,
                newPassword: a,
                confirmNewPassword: o
            }, function(e) {
                null == e || "" == e ? (n.show(),
                i.hide()) : (n.hide(),
                i.html(e).show(),
                $("html, body").animate({
                    scrollTop: t.offset().top
                }, 10))
            }, "html")
        }),
        SCM.TestPassword.initTestPassword("#newPassword", "#confirmNewPassword", "#changePasswordBtn")
    }
    ,
    ns.countSubjectChoices = function() {
        $("#communication-preferences-subject-choices").find(".topics-selected-wrap").each(function() {
            var e = $(this).closest("li").find("input[type=checkbox]")
              , t = e.filter(":checked");
            $(this).find(".totalCount").html(e.length),
            $(this).find(".checkedTotal").html(t.length),
            $(this).show()
        })
    }
    ,
    ns.changeUserTypeSubjects = function(t) {
        var e = $("#communication-preferences");
        $("#userTypeSubjectHeader").hide();
        var n = e.find("#userTypes").val();
        "3" === n && $("#userTypeSubjectHeader").show(),
        e.find("ul#userTypeSubjects > li").each(function() {
            var e = $(this).find("input[type=checkbox]");
            $(this).attr("data-classification-id") === n ? ($(this).show(),
            t && e.prop("checked", e.data("checked"))) : ($(this).hide(),
            t && e.prop("checked", !1))
        })
    }
    ,
    ns.initActivateSubscription = function(e) {
        var t = $(".activate-subscription-wrap");
        null != e && 0 < e.length && (t.find(".error-message").html(e).show(),
        SCM.MyAccount.cleanLastErrorMessage());
        var a = 0 < $("div.register-captcha-text-simple-sub").length
          , o = 0 < $("div.register-captcha-text-normal-sub").length
          , r = "txtCaptchaInputId";
        o ? resetCaptchaElement() : a && (r += "-0"),
        $("#activateSubscriptionBtn").on("click", function() {
            $("#activateSubscriptionBtn").addClass("disabled");
            var e, t, n = $(".activate-subscription-wrap"), i = n.find(".error-message");
            i.html("").hide(),
            n.find("#successMessage").hide(),
            !1 === $("#activateSubscriptionTermsConditions").is(":checked") ? (i.html($("#activateSubErrTermsConditions").html()).show(),
            $("#activateSubscriptionBtn").removeClass("disabled"),
            $("html, body").animate({
                scrollTop: n.offset().top
            }, 10)) : (e = $("#activateSubscriptionToken").val(),
            t = $("#hdnSelectedInstitutionId").val(),
            n = $('input[name="account-type"]:checked').val(),
            0 < e.length ? $.post("/OUPMyAccount/ActivateSubscriptionSubmitToken", {
                token: e,
                accountId: t,
                accountType: n,
                captchaResponse: o ? grecaptcha.getResponse(0) : "",
                simpleCaptchaResponse: a ? document.getElementById(r).value : "",
                captchaInstanceNumber: 0
            }, function(e) {
                "subscriptions" === e ? location.href = "/my-account/subscriptions" : "institutional-settings" === e ? setTimeout(function() {
                    location.href = "/my-account/institutional-settings"
                }, 1e3) : window.location.reload()
            }, "html").fail(function(e, t, n) {
                $("#activateSubscriptionBtn").removeClass("disabled"),
                i.html('We encountered a problem when trying to activate your subscription. Please try again. If the problem continues, please contact <a href="/journals/pages/contact_us/customer_services">customer services</a>.').show()
            }) : $("#activateSubscriptionBtn").removeClass("disabled"))
        }),
        $("#activateSubscriptionToken").on("keypress", function(e) {
            13 === (e.keyCode || e.which) && (e.preventDefault(),
            $("#activateSubscriptionBtn").click())
        })
    }
    ,
    ns.cleanLastErrorMessage = function() {
        $.post("/OUPMyAccount/CleanLastErrorMessage")
    }
}(SCM.MyAccount = SCM.MyAccount || {}, jQuery),
$(document).ready(function() {
    var t, n = $("#journalAddEditDiv"), i = $("#journalAddEditDiv .add-new-alert .new-alert-row-wrap");
    $(document).on("click", ".myaccount-tabs-inner-wrap div", function() {
        $(".tabbed-content-overlay").show()
    }),
    $("#myaccount-tabs-content").on("DOMSubtreeModified", function() {
        $(".tabbed-content-overlay").hide()
    }),
    $("#institutionalLogoURL").keyup(function() {
        $(".logoPreview").attr("src", $(this).val()),
        $(".logoPreview").error(function() {
            $(this).attr("src", "/Images/grey.gif")
        })
    });
    function a(e) {
        n.hasClass("open") && !e.hasClass("js-save-alerts") && $(document).on("closed.fndtn.reveal", "[data-reveal]", function() {
            i.html(t)
        })
    }
    $(document).on("opened.fndtn.reveal", "[data-reveal]", function() {
        t = i.html(),
        $(document).on("mouseup.myAccount", function(e) {
            e = $(e.target);
            a(e)
        }),
        $(document).on("keyup.myAccount", function(e) {
            e = $(e.target);
            a(e)
        })
    }),
    $(document).on("closed.fndtn.reveal", "[data-reveal]", function() {
        $(document).off("mouseup.myAccount"),
        $(document).off("keyup.myAccount")
    }),
    SCM.MyAccount.initRegister($("#lastErrorMessage").val()),
    SCM.MyAccount.initInstitutionalSettings(),
    SCM.MyAccount.initSubscriptions()
});
var SCM = SCM || {};
!function(e, n) {
    function i(e) {
        n("#hdnSelectedInstitutionId").val(e)
    }
    e.institutionalAccountClick = function(e) {
        var t = n(this).attr("data-account-id");
        n(".js-institution-dropdown-wrap").length && (n(".js-institution-dropdown-wrap").removeClass("hide"),
        t = n(".js-institution-dropdown-wrap").find(":selected").val()),
        i(t)
    }
    ,
    e.individualAccountClick = function() {
        n(".js-institution-dropdown-wrap").removeClass("hide").addClass("hide"),
        i(n(this).attr("data-account-id"))
    }
    ,
    e.institutionDropdownChange = function() {
        i(n(this).val())
    }
}(SCM.MyAccount = SCM.MyAccount || {}, jQuery),
$(function() {
    $(".js-account-type-individual").is(":checked") || $(".js-account-type-individual").attr("checked", "checked"),
    $(".js-account-type-institutional").on("click", SCM.MyAccount.institutionalAccountClick),
    $(".js-account-type-individual").attr("checked", "checked").on("click", SCM.MyAccount.individualAccountClick),
    $(".js-institution-dropdown").on("change", SCM.MyAccount.institutionDropdownChange)
});
var SCM = SCM || {};
!function(e, o) {
    e.initCommunicationPreferences = function(e) {
        o("#communication-preferences").length && (SCM.MyAccount.countSubjectChoices(),
        o("#communication-preferences-subject-choices").on("click", ".mainSubjects > a", function() {
            o(this).siblings("ul").slideToggle(),
            o(this).children("i").hasClass("icon-general-arrow-filled-down") ? o(this).children("i").removeClass("icon-general-arrow-filled-down").addClass("icon-general-arrow-filled-right") : o(this).children("i").removeClass("icon-general-arrow-filled-right").addClass("icon-general-arrow-filled-down")
        }),
        o("#communication-preferences-subject-choices").on("click", "input[type=checkbox]", function() {
            o(this).next("ul").find("input[type=checkbox]").prop("checked", !o(this).is(":checked")),
            SCM.MyAccount.countSubjectChoices()
        }),
        null != e && 0 < e && o("#communication-preferences #userTypes").val(e),
        SCM.MyAccount.changeUserTypeSubjects(!1),
        o("#communication-preferences #userTypes").on("change", function() {
            SCM.MyAccount.changeUserTypeSubjects(!0)
        }),
        o("#communication-preferences #btnConfirmOptIn").on("click", function() {
            var t = o(this);
            o.ajax({
                url: "/OUPMyAccount/SendEmailForOptInCommPref",
                type: "GET",
                dataType: "json"
            }).done(function(e) {
                (e.Success ? o("#communication-preferences").find(".success-message") : o("#communication-preferences").find(".error-message")).html(e.Html).show(),
                t.hide(),
                o("#communication-preferences .send-verify-email").hide()
            })
        }),
        o("#communication-preferences #updatePreferencesBtn").on("click", function(e) {
            var t = o("#communication-preferences")
              , n = !t.find("#confirmOptOut").is(":checked")
              , i = [];
            t.find("input[type=checkbox][data-type=subjectId]").filter(":checked").each(function() {
                i.push(o(this).val())
            });
            var a = t.find("#userTypes").val();
            o.ajax({
                url: "/OUPMyAccount/UpdateCommunicationPreferences",
                type: "POST",
                traditional: !0,
                data: {
                    optInMarketEmail: n,
                    subjectIds: i,
                    classificationId: a
                },
                dataType: "html"
            }).done(function(e) {
                (e.includes("apologize") ? t.find(".error-message") : t.find(".success-message")).html(e).show(),
                n ? (t.find(".optedIn-message").show(),
                t.find(".optedOut-message").hide()) : (t.find(".optedIn-message").hide(),
                t.find(".optedOut-message").show()),
                t.find("#userTypeSubjects input[type=checkbox][data-type=subjectId]").each(function() {
                    o(this).data("checked", o(this).is(":checked"))
                })
            }),
            e.preventDefault()
        }),
        o("#communication-preferences #communication-preferences-subject-choices input[type=checkbox][data-type=subjectId]").on("click", function(e) {
            o("#communication-preferences").find(".success-message").hide()
        }))
    }
}(SCM.MyAccount = SCM.MyAccount || {}, jQuery);
var SCM = SCM || {};
!function(e, n) {
    e.initSubscriptions = function() {
        n(".subscriptions-wrap table.tablesorter").tablesorter({
            theme: "default",
            delayInit: !0,
            ignoreCase: !0,
            sortList: [[0, 0]]
        }),
        n(".js-subscription-resource-link").on("click", function() {
            var e = n(this)
              , t = e.data("resource-id")
              , e = e.data("resource-type");
            0 < parseInt(t) && 0 < parseInt(e) && n.get("/OUPMyAccount/GetResourceUrl", {
                resourceId: t,
                resourceType: e
            }, function(e) {
                top.location = e
            }, "text")
        })
    }
}(SCM.MyAccount = SCM.MyAccount || {}, jQuery);
var SCM = SCM || {};
!function(e, m) {
    e.initInstitutionalSettings = function() {
        var t = m(".error-summary").html();
        m("#institutionalAccountInfo").on("click", "#saveInstitutionalSettingsBtn", function() {
            var a = m(this).closest("#institutionalAccountInfo")
              , o = a.find(".error-summary");
            o.html(t);
            var r = a.find(".instUpdate-success");
            r.hide(),
            o.hide(),
            a.find(".instUpdate-error").html("").removeClass("is-active");
            var s = a.find("#hdnSelectedInstitutionId")
              , l = a.find("#instSet-InstitutionName")
              , c = a.find("#instSet-IpAddresses")
              , d = a.find("#instSet-OrgId")
              , u = a.find("#instSet-EntityId")
              , h = a.find("#instSet-OpenUrl")
              , f = a.find("#instSet-OpenUrlButton")
              , p = a.find("#instSet-InstUrl")
              , g = a.find("#instSet-InstLogo")
              , e = m("#myaccount-tabs-content").find("#MyAccountToken").val();
            m.post("/OUPMyAccount/UpdateInstitutionalAccountInfo", {
                institutionId: s.val(),
                institutionName: l.val(),
                ipAddresses: c.val(),
                orgId: d.val(),
                entityId: u.val(),
                openUrl: h.val(),
                openUrlButton: f.val(),
                instUrl: p.val(),
                instLogoUrl: g.val(),
                token: e,
                ipAddresessChanged: c.val() !== c.data("default")
            }, function(e) {
                var t, n, i;
                null != e && (e.ReturnId && m("#myaccount-tabs-content").find("#MyAccountToken").val(e.ReturnId),
                m.isEmptyObject(e.Errors) ? (t = r,
                n = f.val(),
                i = g.val(),
                t.show(),
                m.trim(n).length ? m("#instSet-OpenUrlButtonImg").attr("src", n).show() : m("#instSet-OpenUrlButtonImg").hide(),
                m.trim(i).length ? m("#instSet-InstLogoImg").attr("src", i).show() : m("#instSet-InstLogoImg").hide(),
                s.data("default", s.val()),
                l.data("default", l.val()),
                c.data("default", c.val()),
                d.data("default", d.val()),
                u.data("default", u.val()),
                h.data("default", h.val()),
                f.data("default", f.val()),
                p.data("default", p.val()),
                g.data("default", g.val()),
                m("#InstitutionList option:selected").text(l.val())) : function(e, t, n, i) {
                    for (var a in e) {
                        var o = null;
                        switch (a) {
                        case "general":
                            o = "general";
                            break;
                        case "institutionName":
                            o = "instSet-InstitutionName";
                            break;
                        case "ipAddressList":
                            o = "instSet-IpAddresses";
                            break;
                        case "orgId":
                            o = "instSet-OrgId";
                            break;
                        case "entityId":
                            o = "instSet-EntityId";
                            break;
                        case "openUrl":
                            o = "instSet-OpenUrl";
                            break;
                        case "openUrlButton":
                            o = "instSet-OpenUrlButton";
                            break;
                        case "instUrl":
                            o = "instSet-InstUrl";
                            break;
                        case "instLogoUrl":
                            o = "instSet-InstLogo"
                        }
                        null !== o && ("general" === o ? t.find(".instUpdate-error.general-error").html(i.Errors[a]).addClass("is-active") : (t.find("#" + o).next(".instUpdate-error").html(i.Errors[a]).addClass("is-active"),
                        n.append("<p> * " + m("label[for=" + o + "]").text().replace("*", "") + "</p>"),
                        n.show()))
                    }
                    m("html, body").animate({
                        scrollTop: t.offset().top
                    }, 10)
                }(e.Errors, a, o, e))
            })
        }),
        m(document).on("click", "#institutionalAccountInfo .question-icon", function(e) {
            e.preventDefault();
            e = m(this).next('[data-type="help-text"]').html();
            m("#institutionalSettingsModalBody").html(e),
            m("#institutionalSettingsModal").foundation("reveal", "open")
        });
        var l = m(".js-institution-list option:selected");
        m(".js-institution-list").on("change", function() {
            var e, t, n, i, a, o, r, s;
            e = m("#instSet-InstitutionName"),
            t = m("#instSet-IpAddresses"),
            n = m("#instSet-OrgId"),
            i = m("#instSet-EntityId"),
            a = m("#instSet-OpenUrl"),
            o = m("#instSet-OpenUrlButton"),
            r = m("#instSet-InstUrl"),
            s = m("#instSet-InstLogo"),
            e.val() !== e.data("default") || (t.val() !== t.data("default") || (n.val() !== n.data("default") || (i.val() !== i.data("default") || (a.val() !== a.data("default") || (o.val() !== o.data("default") || (r.val() !== r.data("default") || s.val() !== s.data("default"))))))) ? (alert("You have unsaved changes."),
            l.attr("selected", !0)) : window.location = "/my-account/institutional-settings/" + m(this).val()
        })
    }
}(SCM.MyAccount = SCM.MyAccount || {}, jQuery);
var SCM = SCM || {};
SCM.Utilities = SCM.Utilities || {},
function(ns, $) {
    function handleClickEvent() {
        var $this = $(this)
          , articleId = $this.data("articleid")
          , isLayAbstract = "True" === $this.data("is-lay-abstract")
          , $abstractLocation = getAbstractLocation(articleId, isLayAbstract)
          , $abstractLinks = $("#abstract-" + articleId + "-links")
          , ajaxUrl = getAjaxUrl($this, isLayAbstract);
        $abstractLocation.closest(".js-abstract-parent").toggleClass("abstractExpanded");
        var isAbstractAlreadyFetchedFromServer = "True" === $this.data("tried-to-fetch-abstract");
        isAbstractAlreadyFetchedFromServer || (toggleSpinner($abstractLocation),
        $.get(ajaxUrl, {
            articleId: articleId,
            layAbstract: isLayAbstract
        }).done(function(e) {
            $abstractLocation.html(e.Html),
            $abstractLocation.append($abstractLinks.html()),
            handleClickEventForTabs(),
            SCM.Utilities.Brightcove && SCM.Utilities.Brightcove.init && SCM.Utilities.Brightcove.init()
        }).fail(function(xmlHttpRequest, textStatus, errorThrown) {
            var err;
            toggleSpinner($abstractLocation),
            window.console && (err = eval("(" + xmlHttpRequest.responseText + ")"),
            console.log("error: " + err),
            console.log("status: " + textStatus))
        }),
        $this.data("tried-to-fetch-abstract", "True")),
        $abstractLocation.toggleClass("hide");
        var $thisAbstractIcon = $this.find(".js-abstract-toggle-icon")
          , toggleIconClass = $thisAbstractIcon.data("icon-class")
          , downArrow = toggleIconClass + "-down"
          , upArrow = toggleIconClass + "-up";
        $thisAbstractIcon.toggleClass(downArrow),
        $thisAbstractIcon.toggleClass(upArrow),
        $abstractLocation.hasClass("hide") || window.digitalData && SCM.AdobeAnalytics.sendAdobeAnalyticsProductData(articleId)
    }
    function getAbstractLocation(e, t) {
        return $(t ? ".js-layabstract#abstract-" + e : "#abstract-" + e)
    }
    function getAjaxUrl(e, t) {
        var n = ""
          , i = getBaseSiteUrl();
        return i && (n += "//" + i),
        t ? n += "/PlatformArticle/ArticleLayAbstractAjax" : "extract" === e.data("abstract-type") ? n += "/PlatformArticle/ArticleAbstractOrExtractAjax" : n += "/PlatformArticle/ArticleAbstractAjax",
        n
    }
    function getBaseSiteUrl() {
        var e = $("#hfSiteURL");
        return e.length ? e.val() : null
    }
    function handleClickEventForTabs() {
        $(".js-tabs").parents(".js-abstract-response-placeholder").addClass("removePad"),
        $(document).on("click", ".js-abstract-tab-link", function(e) {
            var t = $(e.target)
              , n = t.closest(".js-abstract-response-placeholder")
              , i = t.closest(".js-abstract-tab-link-wrap")
              , e = n.find(".js-tabs-content .js-abstract-tab-content-wrap")
              , t = i.index();
            switchTabLinks(n, i),
            switchTabContent(e, t)
        })
    }
    function switchTabLinks(e, t) {
        e.find(".js-abstract-tab-link-wrap").removeClass("is-active"),
        t.addClass("is-active")
    }
    function switchTabContent(e, t) {
        e.removeClass("is-active"),
        e.eq(t).addClass("is-active")
    }
    function toggleSpinner(e) {
        e.find(".js-spinner").toggleClass("hide")
    }
    ns.initAbstractClickEvent = function() {
        $(".master-main").on("click", ".js-show-abstract", handleClickEvent)
    }
}(SCM.ArticleAbstract = SCM.ArticleAbstract || {}, jQuery),
jQuery(document).ready(function() {
    SCM.ArticleAbstract.initAbstractClickEvent()
});
var SCM = SCM || {};
SCM.SearchResults = {},
SCM.SearchResults.defaults = {
    controller: "Solr",
    action: "SolrSearch",
    instanceName: "Search",
    baseSiteUrl: "",
    updateTargetSelector: "#divSearch"
},
$(function() {
    function n() {
        $(".collapsible-facet .sf-facet-list").each(function() {
            12 < $(this).find(".sf-facet").length && ($(this).children(".facetShowMoreLi").remove(),
            $(this).find(".sf-facet:gt(11)").hide(),
            0 === $(this).find(".facetShowMoreLi").length && $(this).append('<li class="facetShowMoreLi"><a href="javascript:;" class="facetShowMore">Show more</a></li>'))
        }),
        $(".sf-tax-facet-list.taxonomy-lvl-0").each(function() {
            12 < $(this).children(".sf-tax-facet").length && ($(this).children(".facetShowMoreLi").remove(),
            $(this).children(".sf-tax-facet:gt(11)").hide(),
            0 === $(this).find(".sf-tax-facetShowMoreLi").length && $(this).append('<li class="sf-tax-facetShowMoreLi"><a href="javascript:;" class="facetShowMore">Show more</a></li>'))
        })
    }
    function i() {
        $(".js-taxonomy-parent-arrow").on("click", function() {
            var e = $(this);
            e.parents(".js-taxonomy-label-wrap").siblings(".js-taxonomy-child-list").toggleClass("hide");
            e = e.children(".js-taxonomy-icon");
            e.hasClass("icon-general-arrow-filled-right") ? e.removeClass("icon-general-arrow-filled-right").addClass("icon-general-arrow-filled-down") : e.removeClass("icon-general-arrow-filled-down").addClass("icon-general-arrow-filled-right")
        }),
        0 < $(".js-taxonomy-child-list .js-queryitem").length && ($(".js-taxonomy-child-list .js-queryitem").parents(".js-taxonomy-child-list .js-taxonomy-child-list-item").each(function() {
            var e, t;
            0 < $(this).find(".js-queryitem").length && (t = (e = $(this).find(".js-taxonomy-parent-arrow").first()).children(".js-taxonomy-icon"),
            e && e.length && t.hasClass("icon-general-arrow-filled-right") && (e.parents(".js-taxonomy-label-wrap").siblings(".js-taxonomy-child-list").toggleClass("hide"),
            t.removeClass("icon-general-arrow-filled-right").addClass("icon-general-arrow-filled-down")))
        }),
        $(".js-taxonomy-child-list").each(function() {
            0 < $(this).find(".js-taxonomy-checkbox:checked").not(":visible").length && $(this).find(".facetShowMore").click()
        }))
    }
    $(document).on("click", ".facetShowMore", function(e) {
        var t = $(this).parent().hasClass("sf-tax-facetShowMoreLi")
          , n = t ? $(".sf-tax-facet-list.taxonomy-lvl-0").children(".sf-tax-facet:gt(11):visible") : $(this).closest(".sf-facet-list").find(".sf-facet:gt(11):visible");
        n.length ? (n.animate({
            height: "toggle"
        }, 400),
        $(this).text("Show more")) : ((t ? $(".sf-tax-facet-list.taxonomy-lvl-0").children(".sf-tax-facet") : $(this).closest(".sf-facet-list").find(".sf-facet:gt(11)")).not(":visible").animate({
            height: "toggle"
        }, 400),
        $(this).text("Show less")),
        e.preventDefault()
    }),
    $("#searchResultsPage").on("click", ".journal-description-container a", function(e) {
        e.preventDefault(),
        $(this).closest(".journal-description-container").find(".journal-description").toggleClass("hide")
    }),
    n(),
    i();
    var s, a, l = {}, t = window.location.search.substring(1);
    function c(e, t) {
        SCM.ArticleImageDetails.init("sr-item-image", e, t)
    }
    function d(e, t, n) {
        window.console && console.error(n)
    }
    function u(e, t) {
        a(t[0]),
        "undefined" != typeof clientViewOption && "" !== clientViewOption && (t = s(".sri-expandedView"),
        "Expanded" === clientViewOption ? t.show() : t.hide()),
        n(),
        i(),
        window.history.state && window.history.state.queryString == e.queryString || window.history.pushState(e, null, window.location.pathname + "?" + e.queryString),
        SCM.JournalCitationFilter && SCM.JournalCitationFilter.init()
    }
    window.onpopstate = function(e) {
        e.state && SCM.SearchResults.doSolrSearch(e.state)
    }
    ,
    SCM.PublicationDateFilter.init(),
    SCM.Utilities.Brightcove.init(),
    function() {
        var e = $(SCM.SearchResults.defaults.updateTargetSelector);
        l[t] = {
            results: e.html()
        },
        window.history.replaceState({
            queryString: t
        }, null, null);
        var n = !0;
        function i(e) {
            return "string" == typeof e ? "true" === e.toLowerCase() : !!e
        }
        e.on("click", ".js-edition-select", function(e) {
            var t = $(this).siblings("input");
            !t.length || void 0 !== (t = t.data("redirectUrl")) && SCM.SearchResults.doSolrSearch({
                queryString: t
            })
        }),
        e.on("click", ".chkSelect", function(e) {
            SCM.SearchResults.doSolrSearch({
                queryString: $(this).data("redirectUrl")
            })
        }),
        e.on("click", ".js-sf-facet__link", function(e) {
            var t = $(this).attr("data-url");
            t && "#" !== t && "javascript:;" !== t && (e.preventDefault(),
            SCM.SearchResults.doSolrSearch({
                queryString: t
            }))
        }),
        e.on("click", ".js-close-button", function(e) {
            var t = $(this).attr("data-url");
            t && "#" !== t && "javascript:;" !== t && (e.preventDefault(),
            SCM.SearchResults.doSolrSearch({
                queryString: t
            }))
        }),
        e.on("click", ".rbShowFacet", function(e) {
            e.preventDefault(),
            "False" == $(this).attr("previous-status") && (e = $(this).attr("data-url"),
            SCM.SearchResults.doSolrSearch({
                queryString: e
            }))
        }),
        e.on("click", "#solrSearchBtn", function(e) {
            var t = $("#txtSearch").val();
            t && "" !== t ? (t = encodeURIComponent(t),
            SCM.SearchResults.doSolrSearch({
                queryString: "q=" + t
            })) : alert("Please enter a term to perform search")
        }),
        e.on("click", "#btnRangeSearch", function(e) {
            var t = parseInt(SCM.PublicationDateFilter.$fromYear.val())
              , n = parseInt(SCM.PublicationDateFilter.$toYear.val())
              , i = parseInt(SCM.PublicationDateFilter.$fromMonth.val())
              , a = parseInt(SCM.PublicationDateFilter.$toMonth.val())
              , o = ""
              , r = $(".js-date-type-chk").map(function() {
                return $(this).val()
            })
              , s = $(".js-date-type-chk:checked, .js-date-type-chk:hidden:checked");
            if ((o = SCM.PublicationDateFilter.isSingleDateSelected ? SCM.PublicationDateFilter.getValidationResponseTextForSingleDate(t) : SCM.PublicationDateFilter.getValidationResponseTextForDateRange(t, n, i, a)) && o.length)
                return $(".js-publication-date-filter-validation").text(o),
                void $("#js-publication-date-filter-modal").foundation("reveal", "open");
            var l, c = SCM.PublicationDateFilter.getSolrDateString(t, n, i, a), a = "&dateFilterType=" + (SCM.PublicationDateFilter.isSingleDateSelected ? "single" : "range");
            1 === s.length && "rg_VersionDate" === s.val() ? (r.push("rg_ArticleDate"),
            l = a + "&" + s.val() + "=" + c) : (l = c + a,
            0 === (d = s).length && (d = $(".js-date-type-chk"),
            l += "&noDateTypes=true"),
            d.each(function() {
                l += "&" + $(this).val() + "=" + c
            }));
            var d = $(this).attr("data-url").split("&")
              , d = (d = $.grep(d, function(e, t) {
                e = e.split("=")[0];
                return e.indexOf("dateFilterType") < 0 && e.indexOf("noDateTypes") < 0 && $.inArray(e, r) < 0
            })).join("&");
            0 <= d.indexOf("queryText") ? d = d.replace("queryText", l) : d += l,
            SCM.SearchResults.doSolrSearch({
                queryString: d
            })
        });
        var a = function() {
            var e, t = {
                UserEmail: $("#UserEmail").val(),
                ResourceTitle: $("#ResourceTitle").val(),
                AlertType: $("#AlertType").val(),
                CurrentUserEmail: $("#CurrentUserEmail").val(),
                IsUserAlreadySubscribed: i($("#IsUserAlreadySubscribed").val()),
                SuccessfulUpdate: $("#SuccessfulUpdate").val(),
                ResourceId: $("#ResourceId").val(),
                ResourceType: $("#ResourceType").val(),
                SearchTerm: $("#SearchTerm").val(),
                SearchUrl: $("#SearchUrl").val(),
                CurrentAlertContextSiteId: $("#CurrentAlertContextSiteId").val(),
                ShowSaveSearchToUnauthenticatedUser: i($("#ShowSaveSearchToUnauthenticatedUser").val()),
                UserIsLoggedIn: i($("#UserIsLoggedIn").val())
            };
            null != t.IsUserAlreadySubscribed && t.IsUserAlreadySubscribed ? (e = $("#Config_SearchAlertMyAccoutUrl").val(),
            window.location.href = e) : t.ShowSaveSearchToUnauthenticatedUser && !t.UserIsLoggedIn ? (ShowSignInForSearchAlertSignUp(),
            n = !0) : $.post("/Toolbox/ToolboxGetAlertsUpdateMessage", t, function(e) {
                n = !0,
                alert("Alert Saved Sucessfully. Visit My Account page to manage your email alerts"),
                $("#divSearchAlerts").html(e),
                $("#divSearchAlerts a").on("click", function(e) {
                    e.preventDefault(),
                    a()
                })
            })
        };
        e.on("click", "#divSearchAlerts a", function(e) {
            e.preventDefault(),
            n && (n = !1,
            a())
        })
    }(),
    c(!1, "0"),
    SCM.SearchResults = $.extend(SCM.SearchResults, (s = jQuery,
    a = function(e) {
        e.getBoundingClientRect().top < 0 && s("html, body").animate({
            scrollTop: e.offsetTop
        }, 1e3)
    }
    ,
    {
        doSolrSearch: function(n) {
            var i, a = !1;
            n.openModal && (a = !0,
            i = n.openModal);
            if (/\/(search-results|advanced-search)\/?$/i.test(location.pathname)) {
                var o = s.extend(SCM.SearchResults.defaults, n);
                if (/\/advanced-search\/?$/i.test(location.pathname)) {
                    var e = "/search-results";
                    return o.baseSiteUrl && (e = "//" + o.baseSiteUrl + e),
                    e += "?" + n.queryString,
                    void (window.location = e)
                }
                var r = s(o.updateTargetSelector);
                if (l[n.queryString])
                    return n.cacheSearchWithoutUpdatingDom || (r.html(l[n.queryString].results).show(),
                    SCM.SolrSearch.ajaxComplete(),
                    u(n, r),
                    c(a, i)),
                    void (s(".video-js").length && SCM.Utilities.Brightcove.init());
                var t = !1
                  , e = s.deparam.querystring().mg;
                void 0 !== e && (t = "true" === e.toLowerCase()),
                t && (o.instanceName = "OUP_SearchResults_MG",
                null !== n.queryString && (0 < n.queryString.toLowerCase().indexOf("mg=true") || (n.queryString = n.queryString + "&mg=true")));
                e = s.deparam.querystring().page;
                e && 1 !== parseInt(e) && (n.queryString = n.queryString.replace("page=" + e, "page=1"));
                t = "/" + o.controller + "/" + o.action + "/" + o.instanceName;
                void 0 !== o.baseSiteUrl && "" !== o.baseSiteUrl && (t = "//" + o.baseSiteUrl + t),
                t += "?" + n.queryString,
                n.functionToDoWhileAjaxLoading && n.functionToDoWhileAjaxLoading(n.currentItem),
                (e = s(".info-inner-cover")).removeClass("uncovered"),
                e.addClass("covered"),
                s.get(t).done(function(e) {
                    var t;
                    n.cacheSearchWithoutUpdatingDom || r.html(e),
                    (t = s(".info-inner-cover")).removeClass("covered"),
                    t.addClass("uncovered"),
                    l[n.queryString] = {
                        results: e,
                        updateTargetSelector: o.updateTargetSelector
                    },
                    n.cacheSearchWithoutUpdatingDom || (u(n, r),
                    c(a, i))
                }).fail(d).always(function() {
                    n.functionToDoWhileAjaxLoading && n.functionToDoWhileAjaxLoading(n.currentItem)
                })
            }
        }
    }))
});
var SCM = SCM || {};
!function(SolrSearch, $, undefined) {
    SolrSearch.ExpandedCollectionSites = [];
    var bodyVar = $("body"), hfSolrJournalID = $("#hfSolrJournalID"), hfParentSiteName = $("#hfParentSiteName").val(), hfGlobalSearchSiteURL = $("#hfGlobalSearchSiteURL").val(), hfjournalSiteScope = $("#hfJournalSiteScope").val(), hfparentSiteScope = $("#hfParentSiteScope").val(), searchSiteID = $("#hfSiteID").val(), hfParentSiteURL = $("#hfParentSiteUrl").val(), hfparentSiteID = $("#hfParentSiteID").val(), siteUrl = $("#hfSiteURL").val(), hfdefaultSearchURL = $("#hfDefaultSearchURL").val(), defaultAdvancedSearchUrl = $("#hfDefaultAdvancedSearchUrl").val(), hfIssueSearch = $("#hfIssueSearch").val(), hfIssueSiteScope = $("#hfIssueSiteScope").val(), hfCurrentBookSearch = $("#hfCurrentBookSearch").val(), hfCurrentBookScope = $("#hfCurrentBookScope").val(), hfBookSiteScope = $("#hfBookSiteScope").val(), hfSeriesScope = $("#hfSeriesScope").val(), hfUmbrellaScope = $("#hfUmbrellaScope").val(), hfUmbrellaSiteUrl = $("#hfUmbrellaSiteUrl").val(), hfUmbrellaSiteId = $("#hfUmbrellaSiteId").val(), searchAcrossOA = "", queryText = "", currentSearchScope, selectedSearchFilter = $(".navbar-search-filter :selected");
    function setAdvancedSearchLinkToCurrentSearchScope() {
        currentSearchScope === hfparentSiteScope ? $(".js-advanced-search").attr("href", getBaseUrl(hfParentSiteURL) + "/" + getSearchUrl({
            baseUrl: defaultAdvancedSearchUrl
        })) : currentSearchScope === hfBookSiteScope ? $(".js-advanced-search").attr("href", getBaseUrl() + "/books/" + getSearchUrl({
            baseUrl: defaultAdvancedSearchUrl
        })) : currentSearchScope === hfjournalSiteScope ? $(".js-advanced-search").attr("href", getBaseUrl() + "/journals/" + getSearchUrl({
            baseUrl: defaultAdvancedSearchUrl,
            passAllJournals: !0
        })) : currentSearchScope === hfCurrentBookScope ? $(".js-advanced-search").attr("href", getBaseUrl(siteUrl) + "/" + getSearchUrl({
            baseUrl: defaultAdvancedSearchUrl,
            searchSiteId: hfparentSiteID,
            currentBookSearch: !0
        })) : currentSearchScope === hfUmbrellaScope ? $(".js-advanced-search").attr("href", getBaseUrl(hfUmbrellaSiteUrl) + "/" + getSearchUrl({
            baseUrl: defaultAdvancedSearchUrl,
            searchSiteId: hfUmbrellaSiteId
        })) : currentSearchScope.startsWith(hfSeriesScope) ? $(".js-advanced-search").attr("href", getBaseUrl(siteUrl) + "/" + getSearchUrl({
            baseUrl: defaultAdvancedSearchUrl,
            searchSiteId: searchSiteID,
            series: currentSearchScope
        })) : searchAcrossOA ? $(".js-advanced-search").attr("href", getBaseUrl(hfUmbrellaSiteUrl) + "/" + getSearchUrl({
            baseUrl: defaultAdvancedSearchUrl,
            searchSiteId: searchSiteID,
            series: currentSearchScope
        })) : "" !== currentSearchScope ? $(".js-advanced-search").attr("href", getBaseUrl(siteUrl) + "/" + getSearchUrl({
            baseUrl: defaultAdvancedSearchUrl,
            searchSiteId: searchSiteID,
            taxonomy: currentSearchScope
        })) : $(".js-advanced-search").attr("href", getBaseUrl(siteUrl) + "/" + getSearchUrl({
            baseUrl: defaultAdvancedSearchUrl,
            searchSiteId: searchSiteID
        }))
    }
    function getBaseUrl(e) {
        return isNullOrEmpty(e) ? getUrlProtocol() + window.location.hostname : getUrlProtocol() + e
    }
    function getUrlProtocol() {
        return window.location.protocol + "//"
    }
    currentSearchScope = selectedSearchFilter.length ? selectedSearchFilter.val() : hfUmbrellaScope,
    $(".navbar-search-filter, .mobile-navbar-search-filter").on("change", function() {
        currentSearchScope = $(this).val();
        var e = $(":selected", this);
        searchAcrossOA = e.closest("optgroup").attr("class"),
        setAdvancedSearchLinkToCurrentSearchScope()
    });
    var testSearchInput = function(e, t) {
        if ("" === hfParentSiteName)
            return "" === $.trim(e) || null === e || "Search OUP" === e ? (alert("Please enter a term to search: "),
            !1) : e ? (doSolrSearch(e, t),
            !0) : (console.error("Search failed"),
            !1);
        doSolrSearch(e, t)
    }
      , doKeywordsSearch = function(e) {
        '"' !== e[0] && '"' !== e[e.length - 1] && (e = '"' + e + '"');
        var t = "page=1&qb={Keywords1:" + encodeURIComponent(e) + "}&SearchSourceType=1"
          , n = "cqb=[{%22terms%22:[{%22filter%22:%22Keywords%22,%22input%22:" + encodeURIComponent(e) + "}]}]&qb={%22Keywords1%22:" + encodeURIComponent(e) + "}&page=1&searchType=advanced&adv=true"
          , e = "true" === ($("#hfAreOpFeaturesEnabled").val() || "false").toLowerCase()
          , n = "search-results?" + (0 < $(".js-custom-queryBuilder").length || e ? n : t);
        hfGlobalSearchSiteURL === undefined || hfGlobalSearchSiteURL !== undefined && "" === hfGlobalSearchSiteURL ? (t = $("#hfSiteURL")).length && (n = "//" + t.val() + "/" + n) : n = "//" + hfGlobalSearchSiteURL.val() + n,
        window.location.href = n
    }
      , testKeypress = function(e, t, n) {
        13 === e.keyCode && (e.preventDefault(),
        testSearchInput(n, t))
    };
    function doSolrSearch(e, t) {
        queryText = encodeURIComponent(e);
        var n = ""
          , e = ""
          , e = hfGlobalSearchSiteURL === undefined || hfGlobalSearchSiteURL !== undefined && "" === hfGlobalSearchSiteURL ? $("#hfSiteURL") : hfGlobalSearchSiteURL;
        t === hfjournalSiteScope ? n = "/../journals/" + hfdefaultSearchURL + queryText + "&SearchSourceType=1" : isNullOrEmpty(t) ? (n = getSearchUrl({
            baseUrl: hfdefaultSearchURL,
            queryText: queryText,
            searchSiteId: searchSiteID,
            passAllJournals: !0
        }),
        e.length && (n = "//" + e.val() + "/" + n)) : t === hfparentSiteScope ? n = "//" + hfParentSiteURL + "/" + getSearchUrl({
            baseUrl: hfdefaultSearchURL,
            queryText: queryText,
            searchSiteId: hfparentSiteID
        }) : t === hfIssueSiteScope ? (n = getSearchUrl({
            baseUrl: hfdefaultSearchURL,
            queryText: queryText,
            searchSiteId: searchSiteID,
            issueSearch: !0
        }),
        e.length && (n = "//" + e.val() + "/" + n)) : t === hfCurrentBookScope ? (n = getSearchUrl({
            baseUrl: hfdefaultSearchURL,
            queryText: queryText,
            searchSiteId: searchSiteID,
            currentBookSearch: !0
        }),
        e.length && (n = "//" + e.val() + "/" + n)) : t === hfBookSiteScope ? n = "/../books/" + hfdefaultSearchURL + queryText + "&SearchSourceType=1" : t === hfUmbrellaScope ? n = "//" + hfUmbrellaSiteUrl + "/" + getSearchUrl({
            baseUrl: hfdefaultSearchURL,
            queryText: queryText,
            searchSiteId: hfUmbrellaSiteId
        }) : t.startsWith(hfSeriesScope) ? (n = getSearchUrl({
            baseUrl: hfdefaultSearchURL,
            queryText: queryText,
            searchSiteId: searchSiteID,
            series: currentSearchScope
        }),
        e.length && (n = "//" + e.val() + "/" + n)) : searchAcrossOA ? (n = getSearchUrl({
            baseUrl: hfdefaultSearchURL,
            queryText: queryText,
            searchSiteId: hfUmbrellaSiteId,
            taxonomy: t
        }),
        e.length && (n = "//" + hfUmbrellaSiteUrl + "/" + n)) : (n = getSearchUrl({
            baseUrl: hfdefaultSearchURL,
            queryText: queryText,
            searchSiteId: searchSiteID,
            taxonomy: t
        }),
        e.length && (n = "//" + e.val() + "/" + n)),
        window.location.href = n
    }
    function getSearchUrl(e) {
        var t = (t = e.baseUrl) || "";
        return e.queryText ? t += e.queryText : t = t.replace("&q=", ""),
        e.searchSiteId && (t += "&fl_SiteID=" + e.searchSiteId),
        t += "&SearchSourceType=1",
        e.passAllJournals && (t += "&allJournals=1"),
        e.issueSearch && hfIssueSearch && (t += hfIssueSearch),
        e.currentBookSearch && hfCurrentBookSearch && (t += hfCurrentBookSearch),
        e.series && (t += "&" + e.series),
        e.taxonomy && (t += "&" + getTaxonomyParameter(e.taxonomy)),
        t
    }
    function isNullOrEmpty(e) {
        return void 0 === e || e === undefined || null === e || "" === e
    }
    function getTaxonomyParameter(e) {
        return "tax=" + e
    }
    var openSaveSolrSearch = function(e) {
        e.foundation("reveal", "open")
    }
      , saveSolrSearchInfo = function(solrSearchSaveModel) {
        var txtSolrSearchName = $(solrSearchSaveModel.find(".txtSolrSearchName"))
          , ddlSearchAlertFrequency = $(solrSearchSaveModel.find("#ddlSearchAlertFrequency"));
        if ("" === $.trim(txtSolrSearchName.val()) || null === txtSolrSearchName.val())
            return alert("Please enter a name"),
            !1;
        var redirectUrl = $("#hdnSearchSaveRedirectUrl")
          , currentUrl = window.location.href
          , token = $("#SolrSearchAuthToken").val()
          , data = JSON.stringify({
            searchName: txtSolrSearchName.val(),
            url: currentUrl,
            scheduleId: ddlSearchAlertFrequency.val(),
            redirectUrl: redirectUrl.val(),
            token: token
        })
          , ajaxUrl = "//" + SCM.SearchResults.defaults.baseSiteUrl + "/Solr/SaveSolrSearchInfoWithToken";
        $.ajax({
            url: ajaxUrl,
            type: "POST",
            dataType: "json",
            cache: !1,
            data: data,
            contentType: "application/json; charset=utf-8",
            success: function(e) {
                null !== e && (e.ReturnId && $("#SolrSearchAuthToken").val(e.ReturnId),
                e.RedirectUrl && e.RedirectUrl.length ? window.location = e.RedirectUrl : (alert(e.Html),
                solrSearchSaveModel.foundation("reveal", "close")))
            },
            error: function(xmlHttpRequest, textStatus, errorThrown) {
                var err;
                window.console && (err = eval("(" + xmlHttpRequest.responseText + ")"),
                console.log("error: " + err),
                console.log("status: " + textStatus))
            }
        })
    };
    function buildSaveSearchUiEvent() {
        var e = $(".lnkSaveSolrSearch")
          , n = $(".solrSearchSaveModel")
          , t = $(".btnSolrSearchSave")
          , i = $(".txtSolrSearchName");
        e.off("click").on("click", function() {
            var e, t = $(this).attr("data-userloggedin");
            t !== undefined && "false" === t.toLowerCase() ? (e = $("#hdnSearchSaveRedirectUrl"),
            t = window.location.href,
            window.location = e.val() + "?returnUrl=" + encodeURIComponent(t + "#triggerSaveSearch=1")) : openSaveSolrSearch(n)
        }),
        t.off("click").on("click", function() {
            saveSolrSearchInfo($(this).parents(".solrSearchSaveModel"))
        }),
        i.off("keypress").on("keypress", function(e) {
            13 === (e.keyCode || e.which) && saveSolrSearchInfo($(this).parents(".solrSearchSaveModel"))
        })
    }
    function initCollectionArrows() {
        if (SCM.SolrSearch.ExpandedCollectionSites && 0 < SCM.SolrSearch.ExpandedCollectionSites.length)
            for (i = 0; i < SCM.SolrSearch.ExpandedCollectionSites.length; i++) {
                var e = SCM.SolrSearch.ExpandedCollectionSites[i]
                  , t = $(".js-collection-facet").find(".js-collection-arrow-icon[data-siteid=" + e + "]");
                t && t.hasClass("icon-general-arrow-filled-right") && (t.removeClass("icon-general-arrow-filled-right"),
                t.addClass("icon-general-arrow-filled-down"),
                $(".js-collection-headings-placeholder[data-siteid=" + e + "]").toggleClass("hide"))
            }
    }
    function restrictedImagesSearch() {
        $("div.sri-figure[restricted]").each(function() {
            $(this).off("contextmenu").on("contextmenu", function() {
                return !1
            })
        })
    }
    function updateCollectionFacetDescendantCheckboxes(e) {
        e.first().is(":checked") ? e.prop("checked", !0) : e.prop("checked", !1)
    }
    function doCollectionFacetQuery() {
        var e = $("#CollectionCurrentDataUrl").val();
        e = decodeURIComponent(e);
        var t = $(".js-collection-facet").find(".js-collection-checkbox:checked")
          , n = [];
        for (i = 0; i < t.length; i++) {
            var a = t[i].dataset.siteid;
            n.push(a)
        }
        var o, r, s = -1 !== e.indexOf("collection=");
        !s && 0 < n.length ? e += "&collection=" + n.join(",") : !s || (r = $.deparam.querystring().collection) && "" !== r && (e = 0 < n.length ? (o = "collection=" + n.join(","),
        e.replace("collection=" + r, o)) : (s = "collection=" + r,
        r = (o = e.indexOf(s)) + s.length,
        "&" === e.charAt(o - 1) ? s = "&" + s : "&" === e.charAt(r + 1) && (s += "&"),
        e.replace(s, ""))),
        SCM.SearchResults.doSolrSearch({
            queryString: e
        })
    }
    function bindUiEvents() {
        var e = $(".js-master-header").find(".microsite-search-icon")
          , t = $(".js-master-header").find(".microsite-search-term")
          , n = $(".js-master-header").find(".mobile-microsite-search-icon")
          , i = $(".js-master-header").find(".mobile-microsite-search-term")
          , a = $("#UmbrellaSearchIcon")
          , o = $("#UmbrellaHomeSearchIcon")
          , r = $("#UmbrellaSearchTerm")
          , s = $("#UmbrellaHomeSearchTerm")
          , l = $(".kwd-part");
        a.on("click", function() {
            testSearchInput(r.val(), "J*")
        }),
        o.on("click", function() {
            testSearchInput(s.val(), "J*")
        }),
        e.on("click", function() {
            testSearchInput(t.val(), currentSearchScope)
        }),
        n.on("click", function() {
            testSearchInput(i.val(), currentSearchScope)
        }),
        $(document.body).on("click", ".toolbar-search .microsite-search-icon", function() {
            testSearchInput($(this).siblings(".microsite-search-term").val(), currentSearchScope)
        }),
        $(".searchLi .icon-search").on("click", function() {
            testSearchInput(t.val(), currentSearchScope)
        }),
        l.on("click", function() {
            doKeywordsSearch($(this).attr("data-keyword"))
        }),
        r.on("keypress", function(e) {
            testKeypress(e, "J*", r.val())
        }),
        s.on("keypress", function(e) {
            testKeypress(e, "J*", s.val())
        }),
        t.on("keypress", function(e) {
            testKeypress(e, currentSearchScope, t.val())
        }),
        i.on("keypress", function(e) {
            testKeypress(e, currentSearchScope, i.val())
        }),
        $(document.body).on("keypress", ".toolbar-search .microsite-search-term", function(e) {
            testKeypress(e, currentSearchScope, $(this).val())
        })
    }
    $("body").on("click", ".js-taxonomy-label", function() {
        var n, e = $(this), t = "";
        e.hasClass("js-taxonomy-checkbox") ? (n = "taxWithOr=",
        i = "taxWithOr",
        a = $(this).closest(".js-taxonomy-child-list-item"),
        $(this).is(":checked") ? a.find(".js-taxonomy-checkbox").prop("checked", !0) : a.find(".js-taxonomy-checkbox").prop("checked", !1),
        $(this).closest(".js-taxonomy-tree-wrap").find(".js-taxonomy-checkbox:checked").each(function(e) {
            t += $(this).attr("data-id") + ","
        }),
        t.endsWith(",") && (t = t.slice(0, -1))) : (n = "tax=",
        i = "tax",
        t = $(this).parent(".taxonomy-label-wrap").attr("data-id"));
        var i, a, o = $("#TaxonomyCurrentDataUrl").val(), e = (o = decodeURIComponent(o)).split("&"), e = $.grep(e, function(e, t) {
            return !e.startsWith(n)
        });
        "" !== $(this).attr("data-parentid") && (a = $(this).closest(".taxonomy-node").attr("data-id"),
        -1 !== o.indexOf(n) && "taxWithOr" !== i ? (i = decodeURIComponent($.deparam.querystring()[i])) && "" !== i && (-1 < i.indexOf("=" + a) ? o = o.replace(n + i, n + t) : -1 === $.inArray(t, decodeURIComponent(i.slice(4)).split(",")) && (a = i + "," + t,
        o = o.replace(i, a))) : o = e.join("&").concat("&" + n + t),
        SCM.SearchResults.doSolrSearch({
            queryString: o
        }))
    }),
    bodyVar.on("click", ".js-collection-arrow", function(e) {
        var t, n, i = $(this).find(".js-collection-arrow-icon");
        i.length || (i = $(this).parent().find(".js-collection-arrow-icon")),
        i.length ? (t = i.data("siteid")) ? (n = $(".js-collection-headings-placeholder[data-siteid=" + t + "]")).length ? (i.hasClass("icon-general-arrow-filled-right") ? (SolrSearch.ExpandedCollectionSites.indexOf(t) < 0 && SolrSearch.ExpandedCollectionSites.push(t),
        i.removeClass("icon-general-arrow-filled-right"),
        i.addClass("icon-general-arrow-filled-down")) : i.hasClass("icon-general-arrow-filled-down") && (SolrSearch.ExpandedCollectionSites.splice(SolrSearch.ExpandedCollectionSites.indexOf(t), 1),
        i.removeClass("icon-general-arrow-filled-down"),
        i.addClass("icon-general-arrow-filled-right")),
        n.toggleClass("hide")) : console.error(".js-collection-headings-placeholder not found") : console.error("siteid not found") : console.error(".js-collection-arrow-icon not found")
    }),
    bodyVar.on("click", ".js-collection-label", function(e) {
        var t;
        $(e.target).is(".js-collection-checkbox") || ((e = (t = $(this).closest(".js-collection-item").find(".js-collection-checkbox")).first()).is(":checked") ? e.prop("checked", !1) : e.prop("checked", !0),
        updateCollectionFacetDescendantCheckboxes(t),
        doCollectionFacetQuery())
    }),
    bodyVar.on("click", ".js-collection-checkbox", function() {
        updateCollectionFacetDescendantCheckboxes($(this).closest(".js-collection-item").find(".js-collection-checkbox")),
        doCollectionFacetQuery()
    }),
    SolrSearch.init = function() {
        var n;
        SCM.SiteJS.isPageViewLarge() || (n = "",
        bindUiEvents(),
        buildSaveSearchUiEvent(),
        restrictedImagesSearch(),
        setAdvancedSearchLinkToCurrentSearchScope(),
        bodyVar.on("click", ".sf-group-header", function() {
            var e, t;
            $(window).outerWidth() < 1024 && (t = (e = $(this)).children(".sf-group-header-icon"),
            e.siblings("fieldset").children(".sf-facets, .sf-facet-list").slideToggle(),
            e.siblings(".taxonomy-child-list").slideToggle(),
            t.hasClass("icon-general_arrow-right") ? t.removeClass("icon-general_arrow-right").addClass("icon-general_arrow-down") : t.removeClass("icon-general_arrow-down").addClass("icon-general_arrow-right"))
        }),
        SCM.QueryBuilder.configure(),
        0 < $(SCM.SearchResults.defaults.updateTargetSelector).length ? SCM.QueryBuilder.defaults.runSearch = function(e) {
            SCM.SearchResults.doSolrSearch({
                queryString: e
            })
        }
        : ($(".querybuilder-submit").attr("value", "Search"),
        $(".querybuilder-title").text("Build a query"),
        SCM.QueryBuilder.defaults.runSearch = function(e) {
            var t = $("#hfSiteURL").val();
            -1 === e.indexOf("q=") && (e = "q=" + e),
            window.location = window.location.protocol + "//" + t + "/search-results?" + e
        }
        ),
        $(".sort-dropdown-option:selected").addClass("selected"),
        bodyVar.on("click", ".sriTopiclink", function(e) {
            var t = (queryText = $(this).text()).replace(",", "");
            doSolrSearch(t, "" === (n = currentSearchScope) || null === n ? null : n),
            e.preventDefault()
        }),
        $("a.categoryLink").each(function() {
            var e = $(this).attr("href")
              , t = hfSolrJournalID.val();
            isNullOrEmpty(t) ? $(this).attr("href", hfGlobalSearchSiteURL + e) : (t = t.substr(1, t.length),
            $(this).attr("href", "/" + e + "&fd_JournalID=" + t))
        }),
        bodyVar.on("click", "#topicResultsWire", function(e) {
            var t = (t = location.search).substring(0, t.indexOf("&fd_JournalID"));
            window.location.href = hfGlobalSearchSiteURL.val() + "solr/topicresults.aspx" + t
        }),
        bodyVar.on("click", ".mg-tab", function(e) {
            var t = $(this).data("tab")
              , n = $.deparam.querystring().q
              , i = "";
            n && (i = "&q=" + n);
            var a = $.deparam.querystring().qb
              , o = "";
            a && (o = "&qb=" + a);
            var r = $.deparam.querystring().cqb
              , s = "";
            r && (s = "&cqb=" + r);
            var l = ""
              , c = $.deparam.querystring().fl_SiteID;
            c && (l = "&fl_SiteID=" + c);
            var d = ""
              , u = $.deparam.querystring().SearchSourceType;
            u && (d = "&SearchSourceType=" + u);
            n = "",
            a = $.deparam.querystring().allJournals;
            a && (n = "&allJournals=" + a);
            r = $.deparam.querystring().mg,
            c = !1;
            r && (c = "true" === r.toLowerCase());
            u = "",
            a = $.deparam.querystring().rg_ArticleDate;
            a && (u = "&rg_ArticleDate=" + a);
            r = "",
            a = $.deparam.querystring().dateFilterType;
            a && (r = "&dateFilterType=" + a);
            o = window.location.href.split("?")[0] + "?page=1" + i + l + d + n + u + r + s + o;
            "Images" !== t || c ? "AllResults" === t && c && (window.location.href = o) : window.location.href = o + "&mg=true"
        }))
    }
    ,
    SolrSearch.RefreshBrightcove = function() {
        var e;
        $("#searchResultsPage .brightcove-player").length && ("undefined" != typeof videojs ? (e = $("#searchResultsPage .brightcove-player")[0],
        videojs.getPlayer(e) || SCM.Utilities.Brightcove.init()) : SCM.Utilities.Brightcove.init())
    }
    ,
    SolrSearch.ajaxComplete = function() {
        buildSaveSearchUiEvent(),
        restrictedImagesSearch(),
        SCM.QueryBuilder.configure(),
        SCM.SiteJS.initSearchResultsSort(),
        SCM.PublicationDateFilter.init(),
        initCollectionArrows(),
        SolrSearch.RefreshBrightcove(),
        $(".page-column--left").not("[data-client-solrsearch-event-registered]").length && (SCM.SiteJS.toggleResponsiveLeftColumn(),
        $(".page-column--left").attr("data-client-solrsearch-event-registered", "true")),
        $(".widget-AdBlock  > .hide").length && googletag.cmd.push(function() {
            googletag.pubads().refresh()
        })
    }
    ,
    SCM.SearchResults.defaults.instanceName = "OUP_SearchResults",
    SCM.SearchResults.defaults.updateTargetSelector = "#searchResultsPage";
    var baseSiteURL = $("#hfSiteURL");
    void 0 !== baseSiteURL && "" !== baseSiteURL.val() && (SCM.SearchResults.defaults.baseSiteUrl = baseSiteURL.val()),
    SCM.SolrSearch.init()
}(SCM.SolrSearch = SCM.SolrSearch || {}, jQuery);
var SCM = SCM || {}
  , App = App || {};
!function(s, l, c) {
    var d = "instOpenUrlKey_"
      , u = "instOpenUrlNoDOIKey_"
      , h = "instOpenUrlBaseUrlKey_";
    s.replaceOpenUrlPlaceHolders = function(e, n) {
        n && e.length && e.each(function() {
            var e = l(this)
              , t = e.attr("data-targetId")
              , t = n.replace("{openUrlTargetId}", t);
            e.html(t),
            e.parent().show().removeClass("empty-target")
        })
    }
    ,
    s.replaceOpenUrlNonDOIPlaceHolders = function(e, i, a) {
        a && e.length && e.each(function() {
            var e, t = l(this), n = t.find(".js-open-url-link");
            !n.length || (e = n.attr("data-href-template")) && e.length && (e = e.replace("{targetURL}", i),
            n.attr("href", e),
            n.removeAttr("data-href-template"),
            n.html(a),
            t.parent().show().removeClass("empty-target"))
        })
    }
    ,
    s.replaceFindInMyLibraryOpenUrlPlaceHolders = function(t) {
        t && t.length && l(".js-openurl-library-link").each(function() {
            l(this).removeClass("hide");
            var e = l(this).attr("href");
            l(this).attr("href", t + e)
        })
    }
    ,
    s.getAndReplaceOpenUrlPlaceHolders = function(i, a) {
        var e, o, r;
        l("#openUrlUpdated").length || (l("#ContentColumn").append("<input id='openUrlUpdated' type='hidden' value='true'/>"),
        e = "/ThirdParty/InstitutionOpenUrlTemplate",
        o = "target='_blank'",
        r = "OpenURL Link",
        l(".oup-header.sigma").length && (e = "/Accounts/SigmaOpenUrl",
        o = "",
        r = "Find in my library"),
        l.ajax({
            type: "POST",
            url: e,
            dataType: "json",
            success: function(e) {
                var t, n;
                e && (n = t = "",
                e.DisplayOpenUrlLink && (n = e.LinkImageSource ? (t = " <a class='openInAnotherWindow' " + o + " href='" + e.TargetUrl + "'><img alt='" + r + "' src='" + e.LinkImageSource + "'/></a> ",
                "<img alt='" + r + "' src='" + e.LinkImageSource + "'/>") : (t = " <a class='openInAnotherWindow' " + o + " href='" + e.TargetUrl + "'> " + e.LinkImageText + " </a> ",
                e.LinkImageText)),
                s.replaceOpenUrlPlaceHolders(i, t),
                s.replaceOpenUrlNonDOIPlaceHolders(a, e.BaseUrl, n),
                s.replaceFindInMyLibraryOpenUrlPlaceHolders(e.BaseUrl),
                c && window.sessionStorage && window.App.LoginUserInfo && window.App.LoginUserInfo.currentSessionId && (c.setItem(d + window.App.LoginUserInfo.currentSessionId, t, window.sessionStorage),
                c.setItem(u + window.App.LoginUserInfo.currentSessionId, n, window.sessionStorage),
                c.setItem(h + window.App.LoginUserInfo.currentSessionId, e.BaseUrl, window.sessionStorage)))
            },
            error: function(e) {
                l("#openUrlUpdated").remove()
            }
        }))
    }
    ,
    s.checkAndReplaceOpenUrlPlaceHolders = function() {
        var e, t, n, i, a;
        window.App.LoginUserInfo && 0 < window.App.LoginUserInfo.isInstLoggedIn && (e = l(".inst-open-url-holders"),
        t = l(".js-inst-open-url-holders-nodoi"),
        n = l(".js-openurl-library-link"),
        (e.length || t.length || n.length) && (n = null,
        c && window.sessionStorage && window.App.LoginUserInfo.currentSessionId && (n = c.getItem(d + window.App.LoginUserInfo.currentSessionId, window.sessionStorage),
        i = c.getItem(u + window.App.LoginUserInfo.currentSessionId, window.sessionStorage),
        a = c.getItem(h + window.App.LoginUserInfo.currentSessionId, window.sessionStorage)),
        n && i && a ? (s.replaceOpenUrlPlaceHolders(e, n),
        s.replaceOpenUrlNonDOIPlaceHolders(t, a, i)) : s.getAndReplaceOpenUrlPlaceHolders(e, t)))
    }
    ,
    s.init = function() {
        s.checkAndReplaceOpenUrlPlaceHolders()
    }
}(SCM.InstitutionOpenUrl = SCM.InstitutionOpenUrl || {}, jQuery, SCM.Utilities.LocalStorage);
var SCM = SCM || {};
!function(e, t, n, i) {
    var a = t("#ArticleFullTextWrap")
      , o = !1;
    a && a.attr("data-userHasAccess") && (o = "true" === a.attr("data-userHasAccess").toLowerCase()),
    e.replaceContentLinks = function() {
        o || a.find("a[data-reveal-id]").each(function() {
            t(this).replaceWith(function() {
                return "<span>" + this.innerHTML + "</span>"
            })
        })
    }
    ,
    e.init = function() {
        e.replaceContentLinks(),
        i.init(),
        n.init()
    }
}(SCM.ArticleFulltext = SCM.ArticleFulltext || {}, jQuery, SCM.InstitutionOpenUrl, SCM.Utilities.Brightcove);
var SCM = SCM || {};
!function(e, t) {
    e.init = function() {
        t.init()
    }
}(SCM.BookChapterMainView = SCM.BookChapterMainView || {}, (jQuery,
SCM.InstitutionOpenUrl));
try {
    var _cookiepolicyfancybox = jQuery
} catch (e) {
    try {
        var _cookiepolicyfancybox = $
    } catch (e) {}
}
$ !== jQuery && (_cookiepolicyfancybox = _cookiepolicyfancybox.noConflict()),
function(s) {
    function l() {
        u.hide(),
        j.onerror = j.onload = null,
        M && M.abort(),
        d.empty()
    }
    function c() {
        if (!1 === S.onError(w, y, S))
            return u.hide(),
            _ = !1;
        S.titleShow = !1,
        S.width = "auto",
        S.height = "auto",
        d.html('<p id="oupcookiepolicy_fancybox-error">The requested content cannot be loaded.<br />Please try again later.</p>'),
        L()
    }
    function a() {
        var i, e, t, n, a, o, r = w[y];
        if (l(),
        S = s.extend({}, s.fn.oupcookiepolicy_fancybox.defaults, void 0 === s(r).data("oupcookiepolicy_fancybox") ? S : s(r).data("oupcookiepolicy_fancybox")),
        !1 !== (o = S.onStart(w, y, S)))
            if ("object" == typeof o && (S = s.extend(S, o)),
            t = S.title || (r.nodeName ? s(r).attr("title") : r.title) || "",
            r.nodeName && !S.orig && (S.orig = s(r).children("img:first").length ? s(r).children("img:first") : s(r)),
            "" === t && S.orig && S.titleFromAlt && (t = S.orig.attr("alt")),
            i = S.href || (r.nodeName ? s(r).attr("href") : r.href) || null,
            !/^(?:javascript)/i.test(i) && "#" != i || (i = null),
            S.type ? (e = S.type,
            i = i || S.content) : S.content ? e = "html" : i && (e = i.match(T) ? "image" : i.match(A) ? "swf" : s(r).hasClass("iframe") ? "iframe" : 0 === i.indexOf("#") ? "inline" : "ajax"),
            e)
                switch ("inline" == e && (r = i.substr(i.indexOf("#")),
                e = 0 < s(r).length ? "inline" : "ajax"),
                S.type = e,
                S.href = i,
                S.title = t,
                S.autoDimensions && ("html" == S.type || "inline" == S.type || "ajax" == S.type ? (S.width = "auto",
                S.height = "auto") : S.autoDimensions = !1),
                S.modal && (S.overlayShow = !0,
                S.hideOnOverlayClick = !1,
                S.hideOnContentClick = !1,
                S.enableEscapeButton = !1,
                S.showCloseButton = !1),
                S.padding = parseInt(S.padding, 10),
                S.margin = parseInt(S.margin, 10),
                d.css("padding", S.padding + S.margin),
                s(".oupcookiepolicy_fancybox-inline-tmp").unbind("oupcookiepolicy_fancybox-cancel").bind("oupcookiepolicy_fancybox-change", function() {
                    s(this).replaceWith(h.children())
                }),
                e) {
                case "html":
                    d.html(S.content),
                    L();
                    break;
                case "inline":
                    if (!0 === s(r).parent().is("#oupcookiepolicy_fancybox-content"))
                        return _ = !1,
                        0;
                    s('<div class="oupcookiepolicy_fancybox-inline-tmp" />').hide().insertBefore(s(r)).bind("oupcookiepolicy_fancybox-cleanup", function() {
                        s(this).replaceWith(h.children())
                    }).bind("oupcookiepolicy_fancybox-cancel", function() {
                        s(this).replaceWith(d.children())
                    }),
                    s(r).appendTo(d),
                    L();
                    break;
                case "image":
                    _ = !1,
                    s.oupcookiepolicy_fancybox.showActivity(),
                    (j = new Image).onerror = function() {
                        c()
                    }
                    ,
                    j.onload = function() {
                        _ = !0,
                        j.onerror = j.onload = null,
                        R()
                    }
                    ,
                    j.src = i;
                    break;
                case "swf":
                    S.scrolling = "no",
                    n = '<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="' + S.width + '" height="' + S.height + '"><param name="movie" value="' + i + '"></param>',
                    a = "",
                    s.each(S.swf, function(e, t) {
                        n += '<param name="' + e + '" value="' + t + '"></param>',
                        a += " " + e + '="' + t + '"'
                    }),
                    n += '<embed src="' + i + '" type="application/x-shockwave-flash" width="' + S.width + '" height="' + S.height + '"' + a + "></embed></object>",
                    d.html(n),
                    L();
                    break;
                case "ajax":
                    _ = !1,
                    s.oupcookiepolicy_fancybox.showActivity(),
                    S.ajax.win = S.ajax.success,
                    M = s.ajax(s.extend({}, S.ajax, {
                        url: i,
                        data: S.ajax.data || {},
                        error: function(e, t, n) {
                            0 < e.status && c()
                        },
                        success: function(e, t, n) {
                            if (200 == ("object" == typeof n ? n : M).status) {
                                if ("function" == typeof S.ajax.win) {
                                    if (!1 === (o = S.ajax.win(i, e, t, n)))
                                        return void u.hide();
                                    "string" != typeof o && "object" != typeof o || (e = o)
                                }
                                d.html(e),
                                L()
                            }
                        }
                    }));
                    break;
                case "iframe":
                    D()
                }
            else
                c();
        else
            _ = !1
    }
    function o() {
        return [s(window).width() - 2 * k.margin, s(window).height() - 2 * k.margin, s(document).scrollLeft() + k.margin, s(document).scrollTop() + k.margin]
    }
    function e() {
        u.is(":visible") ? (s("div", u).css("top", -40 * $ + "px"),
        $ = ($ + 1) % 12) : clearInterval(m)
    }
    var d, u, n, i, t, h, r, f, p, g, m, v, b, y = 0, S = {}, w = [], C = 0, k = {}, x = [], M = null, j = new Image, T = /\.(jpg|gif|png|bmp|jpeg)(.*)?$/i, A = /[^\.]\.(swf)\s*$/i, $ = 1, I = 0, F = "", _ = !1, E = s.extend(s("<div/>")[0], {
        prop: 0
    }), L = function() {
        var e = S.width
          , t = S.height
          , e = -1 < e.toString().indexOf("%") ? parseInt((s(window).width() - 2 * S.margin) * parseFloat(e) / 100, 10) + "px" : "auto" == e ? "auto" : e + "px"
          , t = -1 < t.toString().indexOf("%") ? parseInt((s(window).height() - 2 * S.margin) * parseFloat(t) / 100, 10) + "px" : "auto" == t ? "auto" : t + "px";
        d.wrapInner('<div style="width:' + e + ";height:" + t + ";overflow: " + ("auto" == S.scrolling ? "auto" : "yes" == S.scrolling ? "scroll" : "hidden") + ';position:relative;"></div>'),
        S.width = d.width(),
        S.height = d.height(),
        D()
    }, R = function() {
        S.width = j.width,
        S.height = j.height,
        s("<img />").attr({
            id: "oupcookiepolicy_fancybox-img",
            src: j.src,
            alt: S.title
        }).appendTo(d),
        D()
    }, D = function() {
        var e, t;
        return u.hide(),
        i.is(":visible") && !1 === k.onCleanup(x, C, k) ? (s.event.trigger("oupcookiepolicy_fancybox-cancel"),
        void (_ = !1)) : (_ = !0,
        s(h.add(n)).unbind(),
        s(window).unbind("resize.fb scroll.fb"),
        s(document).unbind("keydown.fb"),
        x = w,
        C = y,
        k = S,
        i.is(":visible") && "outside" !== k.titlePosition && i.css("height", i.height()),
        k.overlayShow ? (n.css({
            "background-color": k.overlayColor,
            opacity: k.overlayOpacity,
            cursor: k.hideOnOverlayClick ? "pointer" : "auto",
            height: s(document).height()
        }),
        n.is(":visible") || n.show()) : n.hide(),
        b = B(),
        U(),
        i.is(":visible") ? (s(r.add(p).add(g)).hide(),
        e = i.position(),
        v = {
            top: e.top,
            left: e.left,
            width: i.width(),
            height: i.height()
        },
        t = v.width == b.width && v.height == b.height,
        void h.fadeTo(k.changeFade, .3, function() {
            function e() {
                h.html(d.contents()).fadeTo(k.changeFade, 1, P)
            }
            s.event.trigger("oupcookiepolicy_fancybox-change"),
            h.empty().removeAttr("filter").css({
                "border-width": k.padding,
                width: b.width - 2 * k.padding,
                height: S.autoDimensions ? "auto" : b.height - I - 2 * k.padding
            }),
            t ? e() : (E.prop = 0,
            s(E).animate({
                prop: 1
            }, {
                duration: k.changeSpeed,
                easing: k.easingChange,
                step: N,
                complete: e
            }))
        })) : (i.removeAttr("style"),
        h.css("border-width", k.padding),
        "elastic" == k.transitionIn ? (v = q(),
        h.html(d.contents()),
        i.show(),
        k.opacity && (b.opacity = 0),
        E.prop = 0,
        void s(E).animate({
            prop: 1
        }, {
            duration: k.speedIn,
            easing: k.easingIn,
            step: N,
            complete: P
        })) : ("inside" == k.titlePosition && 0 < I && f.show(),
        h.css({
            width: b.width - 2 * k.padding,
            height: S.autoDimensions ? "auto" : b.height - I - 2 * k.padding
        }).html(d.contents()),
        void i.css(b).fadeIn("none" == k.transitionIn ? 0 : k.speedIn, P))))
    }, U = function() {
        var e;
        if (F = k.title || "",
        I = 0,
        f.empty().removeAttr("style").removeClass(),
        !1 !== k.titleShow)
            if ((F = s.isFunction(k.titleFormat) ? k.titleFormat(F, x, C, k) : !(!(e = F) || !e.length) && ("float" == k.titlePosition ? '<table id="oupcookiepolicy_fancybox-title-float-wrap" cellpadding="0" cellspacing="0"><tr><td id="oupcookiepolicy_fancybox-title-float-left"></td><td id="oupcookiepolicy_fancybox-title-float-main">' + e + '</td><td id="oupcookiepolicy_fancybox-title-float-right"></td></tr></table>' : '<div id="oupcookiepolicy_fancybox-title-' + k.titlePosition + '">' + e + "</div>")) && "" !== F) {
                switch (f.addClass("oupcookiepolicy_fancybox-title-" + k.titlePosition).html(F).appendTo("body").show(),
                k.titlePosition) {
                case "inside":
                    f.css({
                        width: b.width - 2 * k.padding,
                        marginLeft: k.padding,
                        marginRight: k.padding
                    }),
                    I = f.outerHeight(!0),
                    f.appendTo(t),
                    b.height += I;
                    break;
                case "over":
                    f.css({
                        marginLeft: k.padding,
                        width: b.width - 2 * k.padding,
                        bottom: k.padding
                    }).appendTo(t);
                    break;
                case "float":
                    f.css("left", -1 * parseInt((f.width() - b.width - 40) / 2, 10)).appendTo(i);
                    break;
                default:
                    f.css({
                        width: b.width - 2 * k.padding,
                        paddingLeft: k.padding,
                        paddingRight: k.padding
                    }).appendTo(i)
                }
                f.hide()
            } else
                f.hide();
        else
            f.hide()
    }, P = function() {
        s.support.opacity || (h.get(0).style.removeAttribute("filter"),
        i.get(0).style.removeAttribute("filter")),
        S.autoDimensions && h.css("height", "auto"),
        i.css("height", "auto"),
        F && F.length && f.show(),
        k.showCloseButton && r.show(),
        (k.enableEscapeButton || k.enableKeyboardNav) && s(document).bind("keydown.fb", function(e) {
            27 == e.keyCode && k.enableEscapeButton ? (e.preventDefault(),
            s.oupcookiepolicy_fancybox.close()) : 37 != e.keyCode && 39 != e.keyCode || !k.enableKeyboardNav || "INPUT" === e.target.tagName || "TEXTAREA" === e.target.tagName || "SELECT" === e.target.tagName || (e.preventDefault(),
            s.oupcookiepolicy_fancybox[37 == e.keyCode ? "prev" : "next"]())
        }),
        k.showNavArrows ? ((k.cyclic && 1 < x.length || 0 !== C) && p.show(),
        (k.cyclic && 1 < x.length || C != x.length - 1) && g.show()) : (p.hide(),
        g.hide()),
        k.hideOnContentClick && h.bind("click", s.oupcookiepolicy_fancybox.close),
        k.hideOnOverlayClick && n.bind("click", s.oupcookiepolicy_fancybox.close),
        s(window).bind("resize.fb", s.oupcookiepolicy_fancybox.resize),
        k.centerOnScroll && s(window).bind("scroll.fb", s.oupcookiepolicy_fancybox.center),
        "iframe" == k.type && s('<iframe id="oupcookiepolicy_fancybox-frame" name="oupcookiepolicy_fancybox-frame' + (new Date).getTime() + '" frameborder="0" hspace="0" allowtransparency="true" scrolling="' + S.scrolling + '" src="' + k.href + '"></iframe>').appendTo(h),
        i.show(),
        _ = !1,
        s.oupcookiepolicy_fancybox.center(),
        k.onComplete(x, C, k),
        O()
    }, O = function() {
        var e;
        x.length - 1 > C && void 0 !== (e = x[C + 1].href) && e.match(T) && ((new Image).src = e),
        0 < C && void 0 !== (e = x[C - 1].href) && e.match(T) && ((new Image).src = e)
    }, N = function(e) {
        var t = {
            width: parseInt(v.width + (b.width - v.width) * e, 10),
            height: parseInt(v.height + (b.height - v.height) * e, 10),
            top: parseInt(v.top + (b.top - v.top) * e, 10),
            left: parseInt(v.left + (b.left - v.left) * e, 10)
        };
        void 0 !== b.opacity && (t.opacity = e < .5 ? .5 : e),
        i.css(t),
        h.css({
            width: t.width - 2 * k.padding,
            height: t.height - I * e - 2 * k.padding
        })
    }, B = function() {
        var e = o()
          , t = {}
          , n = k.autoScale
          , i = 2 * k.padding;
        return -1 < k.width.toString().indexOf("%") ? t.width = parseInt(e[0] * parseFloat(k.width) / 100, 10) : t.width = k.width + i,
        -1 < k.height.toString().indexOf("%") ? t.height = parseInt(e[1] * parseFloat(k.height) / 100, 10) : t.height = k.height + i,
        n && (t.width > e[0] || t.height > e[1]) && ("image" == S.type || "swf" == S.type ? (n = k.width / k.height,
        t.width > e[0] && (t.width = e[0],
        t.height = parseInt((t.width - i) / n + i, 10)),
        t.height > e[1] && (t.height = e[1],
        t.width = parseInt((t.height - i) * n + i, 10))) : (t.width = Math.min(t.width, e[0]),
        t.height = Math.min(t.height, e[1]))),
        t.top = parseInt(Math.max(e[3] - 20, e[3] + .5 * (e[1] - t.height - 40)), 10),
        t.left = parseInt(Math.max(e[2] - 20, e[2] + .5 * (e[0] - t.width - 40)), 10),
        t
    }, q = function() {
        var e, t = !!S.orig && s(S.orig);
        return t && t.length ? ((e = (t = t).offset()).top += parseInt(t.css("paddingTop"), 10) || 0,
        e.left += parseInt(t.css("paddingLeft"), 10) || 0,
        e.top += parseInt(t.css("border-top-width"), 10) || 0,
        e.left += parseInt(t.css("border-left-width"), 10) || 0,
        e.width = t.width(),
        e.height = t.height(),
        {
            width: e.width + 2 * k.padding,
            height: e.height + 2 * k.padding,
            top: e.top - k.padding - 20,
            left: e.left - k.padding - 20
        }) : (e = o(),
        {
            width: 2 * k.padding,
            height: 2 * k.padding,
            top: parseInt(e[3] + .5 * e[1], 10),
            left: parseInt(e[2] + .5 * e[0], 10)
        })
    };
    s.fn.oupcookiepolicy_fancybox = function(e) {
        return s(this).length && s(this).data("oupcookiepolicy_fancybox", s.extend({}, e, s.metadata ? s(this).metadata() : {})).unbind("click.fb").bind("click.fb", function(e) {
            e.preventDefault(),
            _ || (_ = !0,
            s(this).blur(),
            w = [],
            y = 0,
            (e = s(this).attr("rel") || "") && "" != e && "nofollow" !== e ? (w = s("a[rel=" + e + "], area[rel=" + e + "]"),
            y = w.index(this)) : w.push(this),
            a())
        }),
        this
    }
    ,
    s.oupcookiepolicy_fancybox = function(e) {
        var t;
        if (!_) {
            if (_ = !0,
            t = void 0 !== arguments[1] ? arguments[1] : {},
            w = [],
            y = parseInt(t.index, 10) || 0,
            s.isArray(e)) {
                for (var n = 0, i = e.length; n < i; n++)
                    "object" == typeof e[n] ? s(e[n]).data("oupcookiepolicy_fancybox", s.extend({}, t, e[n])) : e[n] = s({}).data("oupcookiepolicy_fancybox", s.extend({
                        content: e[n]
                    }, t));
                w = jQuery.merge(w, e)
            } else
                "object" == typeof e ? s(e).data("oupcookiepolicy_fancybox", s.extend({}, t, e)) : e = s({}).data("oupcookiepolicy_fancybox", s.extend({
                    content: e
                }, t)),
                w.push(e);
            (y > w.length || y < 0) && (y = 0),
            a()
        }
    }
    ,
    s.oupcookiepolicy_fancybox.showActivity = function() {
        clearInterval(m),
        u.show(),
        m = setInterval(e, 66)
    }
    ,
    s.oupcookiepolicy_fancybox.hideActivity = function() {
        u.hide()
    }
    ,
    s.oupcookiepolicy_fancybox.next = function() {
        return s.oupcookiepolicy_fancybox.pos(C + 1)
    }
    ,
    s.oupcookiepolicy_fancybox.prev = function() {
        return s.oupcookiepolicy_fancybox.pos(C - 1)
    }
    ,
    s.oupcookiepolicy_fancybox.pos = function(e) {
        _ || (e = parseInt(e),
        w = x,
        -1 < e && e < x.length ? (y = e,
        a()) : k.cyclic && 1 < x.length && (y = e >= x.length ? 0 : x.length - 1,
        a()))
    }
    ,
    s.oupcookiepolicy_fancybox.cancel = function() {
        _ || (_ = !0,
        s.event.trigger("oupcookiepolicy_fancybox-cancel"),
        l(),
        S.onCancel(w, y, S),
        _ = !1)
    }
    ,
    s.oupcookiepolicy_fancybox.close = function() {
        var e;
        function t() {
            n.fadeOut("fast"),
            f.empty().hide(),
            i.hide(),
            s.event.trigger("oupcookiepolicy_fancybox-cleanup"),
            h.empty(),
            x = S = [],
            C = y = 0,
            k = S = {},
            _ = !1
        }
        _ || i.is(":hidden") || (_ = !0,
        k && !1 === k.onCleanup(x, C, k) ? _ = !1 : (l(),
        s(r.add(p).add(g)).hide(),
        s(h.add(n)).unbind(),
        s(window).unbind("resize.fb scroll.fb"),
        s(document).unbind("keydown.fb"),
        h.find("iframe").attr("src", "about:blank"),
        "inside" !== k.titlePosition && f.empty(),
        i.stop(),
        "elastic" == k.transitionOut ? (v = q(),
        e = i.position(),
        b = {
            top: e.top,
            left: e.left,
            width: i.width(),
            height: i.height()
        },
        k.opacity && (b.opacity = 1),
        f.empty().hide(),
        E.prop = 1,
        s(E).animate({
            prop: 0
        }, {
            duration: k.speedOut,
            easing: k.easingOut,
            step: N,
            complete: t
        })) : i.fadeOut("none" == k.transitionOut ? 0 : k.speedOut, t)))
    }
    ,
    s.oupcookiepolicy_fancybox.resize = function() {
        n.is(":visible") && n.css("height", s(document).height()),
        s.oupcookiepolicy_fancybox.center(!0)
    }
    ,
    s.oupcookiepolicy_fancybox.center = function() {
        var e, t;
        _ || (t = !0 === arguments[0] ? 1 : 0,
        e = o(),
        !t && (i.width() > e[0] || i.height() > e[1]) || i.stop().animate({
            top: parseInt(Math.max(e[3] - 20, e[3] + .5 * (e[1] - h.height() - 40) - k.padding)),
            left: parseInt(Math.max(e[2] - 20, e[2] + .5 * (e[0] - h.width() - 40) - k.padding))
        }, "number" == typeof arguments[0] ? arguments[0] : 200))
    }
    ,
    s.oupcookiepolicy_fancybox.init = function() {
        s("#oupcookiepolicy_fancybox-wrap").length || (s("body").append(d = s('<div id="oupcookiepolicy_fancybox-tmp"></div>'), u = s('<div id="oupcookiepolicy_fancybox-loading"><div></div></div>'), n = s('<div id="oupcookiepolicy_fancybox-overlay"></div>'), i = s('<div id="oupcookiepolicy_fancybox-wrap"></div>')),
        (t = s('<div id="oupcookiepolicy_fancybox-outer"></div>').append('<div class="oupcookiepolicy_fancybox-bg" id="oupcookiepolicy_fancybox-bg-n"></div><div class="oupcookiepolicy_fancybox-bg" id="oupcookiepolicy_fancybox-bg-ne"></div><div class="oupcookiepolicy_fancybox-bg" id="oupcookiepolicy_fancybox-bg-e"></div><div class="oupcookiepolicy_fancybox-bg" id="oupcookiepolicy_fancybox-bg-se"></div><div class="oupcookiepolicy_fancybox-bg" id="oupcookiepolicy_fancybox-bg-s"></div><div class="oupcookiepolicy_fancybox-bg" id="oupcookiepolicy_fancybox-bg-sw"></div><div class="oupcookiepolicy_fancybox-bg" id="oupcookiepolicy_fancybox-bg-w"></div><div class="oupcookiepolicy_fancybox-bg" id="oupcookiepolicy_fancybox-bg-nw"></div>').appendTo(i)).append(h = s('<div id="oupcookiepolicy_fancybox-content"></div>'), r = s('<a id=""></a>'), f = s('<div id="oupcookiepolicy_fancybox-title"></div>'), p = s('<a href="javascript:;" id="oupcookiepolicy_fancybox-left"><span class="fancy-ico" id="oupcookiepolicy_fancybox-left-ico"></span></a>'), g = s('<a href="javascript:;" id="oupcookiepolicy_fancybox-right"><span class="fancy-ico" id="oupcookiepolicy_fancybox-right-ico"></span></a>')),
        r.click(s.oupcookiepolicy_fancybox.close),
        u.click(s.oupcookiepolicy_fancybox.cancel),
        p.click(function(e) {
            e.preventDefault(),
            s.oupcookiepolicy_fancybox.prev()
        }),
        g.click(function(e) {
            e.preventDefault(),
            s.oupcookiepolicy_fancybox.next()
        }),
        s.fn.mousewheel && i.bind("mousewheel.fb", function(e, t) {
            _ ? e.preventDefault() : 0 != s(e.target).get(0).clientHeight && s(e.target).get(0).scrollHeight !== s(e.target).get(0).clientHeight || (e.preventDefault(),
            s.oupcookiepolicy_fancybox[0 < t ? "prev" : "next"]())
        }),
        s.support.opacity || i.addClass("oupcookiepolicy_fancybox-ie"))
    }
    ,
    s.fn.oupcookiepolicy_fancybox.defaults = {
        padding: 10,
        margin: 40,
        opacity: !1,
        modal: !1,
        cyclic: !1,
        scrolling: "auto",
        width: 560,
        height: 340,
        autoScale: !0,
        autoDimensions: !0,
        centerOnScroll: !1,
        ajax: {},
        swf: {
            wmode: "transparent"
        },
        hideOnOverlayClick: !0,
        hideOnContentClick: !1,
        overlayShow: !0,
        overlayOpacity: .7,
        overlayColor: "#777",
        titleShow: !0,
        titlePosition: "float",
        titleFormat: null,
        titleFromAlt: !1,
        transitionIn: "fade",
        transitionOut: "fade",
        speedIn: 300,
        speedOut: 300,
        changeSpeed: 300,
        changeFade: "fast",
        easingIn: "swing",
        easingOut: "swing",
        showCloseButton: !0,
        showNavArrows: !0,
        enableEscapeButton: !1,
        enableKeyboardNav: !0,
        onStart: function() {},
        onCancel: function() {},
        onComplete: function() {},
        onCleanup: function() {},
        onClosed: function() {},
        onError: function() {}
    },
    s(document).ready(function() {
        s.oupcookiepolicy_fancybox.init()
    })
}(jQuery);
var domain = "//global.oup.com"
  , cookieWsUrl = domain + "/cookiealert"
  , cookiePolicyUrl = domain + "/cookiepolicy/"
  , version = "/0"
  , cookieDate = "/01-01-2000"
  , preferredLanguage = ""
  , cookieName = "oup-cookie"
  , databaseVersion = "0"
  , cookieOlderThanSpecificDays = !0
  , ie6Message = '<div id="oupcookiepolicy_message" class="cookiepolicyimplied"><div class="cookiepolicytext">We use cookies to enhance your experience on our website. By clicking \'continue\' or by continuing to use our website, you are agreeing to our use of cookies. You can change your cookie settings at any time.</div><ul class="cookiepolicylinks"><li><a href="#" onClick="window.location.reload( true );" class="cookiepolicycontinue" title="Close this message">Continue</a></li><li><a href="http://global.oup.com/cookiepolicy/" target="_blank" class="cookiepolicymore" title="How we use cookies on this site">Find out more</a></li></ul><div class="cookiepolicyend"></div></div>';
try {
    var _cookiepolicy = jQuery
} catch (e) {
    try {
        var _cookiepolicy = $
    } catch (e) {}
}
function writeTheElements() {
    var e = document.createElement("div");
    e.innerHTML = '<div id="cookiepolicy_div"><div id="cookiepolicy_parent"style="display:none"><div id="cookiepolicy_data"></div></div></div>',
    document.body.insertBefore(e, document.body.firstChild)
}
function getTheCookie() {
    var e = window.navigator.userLanguage;
    null == e && (e = window.navigator.language),
    e = e.substring(0, 2);
    var t = metaKeywords();
    "" != oupcookiepolicy_preferredlanguage && " " != oupcookiepolicy_preferredlanguage && "undefined" != oupcookiepolicy_preferredlanguage && 0 < oupcookiepolicy_preferredlanguage.length ? preferredLanguage = "/" + oupcookiepolicy_preferredlanguage : "" != t && "undefined" != t ? (t = t.substring(0, 2),
    preferredLanguage = "/" + t) : "" != e && "undefined" != e && (e = e.substring(0, 2),
    preferredLanguage = "/" + e),
    "" != preferredLanguage && "undefined" != preferredLanguage || (preferredLanguage = "/en");
    e = document.cookie;
    cookiearray = e.split(";");
    for (var n = 0; n < cookiearray.length; n++) {
        var i, a = cookiearray[n].split("=")[0], o = cookiearray[n].split("=")[1];
        -1 != a.indexOf(cookieName) && (version = "" == o.split("_")[0] ? "/0" : "/" + o.split("_")[0],
        i = constructDateString(o.split("_")[1]),
        a = new Date(i),
        i = new Date,
        cookieOlderThanSpecificDays = 7776e6 < i - a,
        cookieDate = "/" + o.split("_")[1])
    }
}
function metaKeywords() {
    var e = "";
    for (metaCollection = document.getElementsByTagName("meta"),
    i = 0; i < metaCollection.length; i++)
        nameAttribute = metaCollection[i].name.search(/language/),
        -1 != nameAttribute && (e = metaCollection[i].content);
    return e
}
function constructDateString(e) {
    try {
        var t = e.split("-")[0]
          , n = e.split("-")[1];
        return e.split("-")[2] + "," + n + "," + t
    } catch (e) {}
}
function checkForAlertMessage() {
    var e = null
      , e = createCORSRequest("GET", cookieWsUrl + preferredLanguage + version + cookieDate, !0);
    if ("undefined" != typeof XDomainRequest)
        e.onprogress = function() {}
        ,
        e.ontimeout = function() {}
        ,
        e.onerror = function() {}
        ,
        e.onload = function() {
            "true" == e.responseText && getAlertMessage()
        }
        ,
        setTimeout(function() {
            e.send()
        }, 0);
    else if (window.ActiveXObject)
        e.onreadystatechange = function() {
            4 == e.readyState && 200 == e.status && "true" == e.responseText && getAlertMessage()
        }
        ,
        e.send();
    else
        try {
            e.onreadystatechange = function() {
                4 == e.readyState && "true" == e.responseText && getAlertMessage()
            }
            ,
            e.send()
        } catch (e) {}
}
function getAlertMessage() {
    var e = null
      , t = !1
      , e = createCORSRequest("GET", cookieWsUrl + preferredLanguage + "/" + oupcookiepolicy_messagetype, !0);
    "undefined" != typeof XDomainRequest ? e.onload = function() {
        t || (t = !0,
        generateAlertMessage(e.responseText))
    }
    : window.ActiveXObject ? e.onreadystatechange = function() {
        4 == e.readyState && 200 == e.status && (t = !0,
        generateAlertMessage(e.responseText))
    }
    : e.onreadystatechange = function() {
        4 != e.readyState || 200 != e.status || t || (t = !0,
        generateAlertMessage(e.responseText))
    }
    ,
    e.send()
}
function createCORSRequest(t, n) {
    navigator.userAgent;
    var i = new XMLHttpRequest;
    if ("withCredentials"in i)
        i.open(t, n, !0);
    else if ("undefined" != typeof XDomainRequest)
        try {
            (i = new XDomainRequest).open(t, n)
        } catch (e) {
            (i = new XMLHttpRequest).open(t, n, !0)
        }
    else if (window.ActiveXObject)
        try {
            (i = new ActiveXObject("Msxml2.XMLHTTP")).open(t, n)
        } catch (e) {
            try {
                (i = new ActiveXObject("Microsoft.XMLHTTP")).open(t, n)
            } catch (e) {
                i.open(t, n, !0)
            }
        }
    else
        try {
            (i = new XDomainRequest).open(t, n)
        } catch (e) {
            (i = new XMLHttpRequest).open(t, n, !0)
        }
    return i
}
function generateAlertMessage(e) {
    var t = "/cookiepolicy/"
      , n = "1"
      , i = preferredLanguage.substring(1, preferredLanguage.length).split(",")
      , a = 0
      , o = ""
      , r = "";
    if (e.length && 0 < e.length) {
        i.length;
        if (-1 != e.indexOf("____"))
            for (var s = e.split("____"), l = s.length - 1, c = 0; c < l; c++) {
                for (var d = s[c].substring(0, e.indexOf("|")), o = s[c].substring(s[c].indexOf("|") + 1, s[c].length), u = FindNewLangWithCountryCode(i[a++]), h = o.split(t), f = h.length, p = "", g = 0; g < f; g++)
                    p = 0 != g ? "explicit" == oupcookiepolicy_messagetype ? p + t + "?siteid=" + oupcookiepolicy_siteid + "&lang=" + u + h[g] + "<br/>" : p + t + "?siteid=" + oupcookiepolicy_siteid + "&lang=" + u + h[g] : h[g];
                r += p = p.replace("dbCookieVersion", d)
            }
        else
            e.length && 0 < e.length && -1 != e.indexOf("|") && (d = e.substring(0, e.indexOf("|")),
            r = o = e.substring(e.indexOf("|") + 1, e.length));
        if ("" != n && " " != n || (n = "1"),
        alertMessageToDisplay = r,
        "implied" == oupcookiepolicy_messagetype) {
            alertMessageToDisplay = htmlDecode(alertMessageToDisplay);
            var m = document.createElement("div");
            m.innerHTML = alertMessageToDisplay,
            document.body.insertBefore(m, document.body.firstChild),
            saveCookie(n)
        } else {
            document.getElementById("cookiepolicy_data").innerHTML = alertMessageToDisplay;
            try {
                document.getElementById("cookiepolicy_link").click()
            } catch (e) {
                _cookiepolicy("#cookiepolicy_link").click()
            }
        }
    }
}
function cookiePolicy() {
    window.open(cookiePolicyUrl, "_blank")
}
function saveCookie(e) {
    var t = new Date
      , n = new Date;
    n.setDate(n.getDate() + 365);
    t = t.getDate() + "-" + (t.getMonth() + 1) + "-" + t.getFullYear(),
    n = n.toGMTString(),
    e = cookieName + "=" + e + "_" + t + "; expires=" + n + "; path=" + oupcookiepolicy_documentroot,
    t = document.domain;
    null != oupcookiepolicy_siteid && "" != oupcookiepolicy_siteid && "journals" == oupcookiepolicy_siteid && null != t && "undefine" != t && "" != t && (n = "",
    -1 != t.indexOf(".") && (2 < (t = t.split(".")).length && (n = "." + t[t.length - 2] + "." + t[t.length - 1]),
    e = e + "; domain=" + n)),
    document.cookie = e,
    _cookiepolicy.oupcookiepolicy_fancybox && _cookiepolicy.oupcookiepolicy_fancybox.close()
}
function closeImplied() {
    document.location.reload(!0)
}
function htmlDecode(e) {
    var t, n, i = e;
    if (this.isEmpty(i))
        return "";
    if (i = this.HTML2Numerical(i),
    arr = i.match(/&#[0-9]{1,5};/g),
    null != arr)
        for (var a = 0; a < arr.length; a++)
            i = -32768 <= (t = (n = arr[a]).substring(2, n.length - 1)) && t <= 65535 ? i.replace(n, String.fromCharCode(t)) : i.replace(n, "");
    return i
}
function isEmpty(e) {
    return !e || (null === e || 0 == e.length || /^\s+$/.test(e))
}
function HTML2Numerical(e) {
    return swapArrayVals(e, this.arr1, this.arr2)
}
_cookiepolicy(document).ready(function() {
    writeTheElements(),
    getTheCookie(),
    "explicit" == oupcookiepolicy_messagetype && "function" == typeof _cookiepolicy.oupcookiepolicy_fancybox && (_cookiepolicy("a#cookiepolicy_link").oupcookiepolicy_fancybox({
        hideOnContentClick: !1,
        hideOnOverlayClick: !1
    }),
    _cookiepolicy("a.group").oupcookiepolicy_fancybox({
        transitionIn: "elastic",
        transitionOut: "elastic",
        speedIn: 600,
        speedOut: 200,
        overlayShow: !1
    }));
    try {
        cookieOlderThanSpecificDays && checkForAlertMessage()
    } catch (e) {
        var t, n = "/cookiepolicy/";
        alertMessageToDisplay = htmlDecode(ie6Message),
        -1 != alertMessageToDisplay.indexOf(n) && (t = alertMessageToDisplay.substring(0, alertMessageToDisplay.indexOf(n)),
        i = alertMessageToDisplay.substring(alertMessageToDisplay.indexOf(n) + n.length, alertMessageToDisplay.length),
        alertMessageToDisplay = t + n + "?siteid=" + oupcookiepolicy_siteid + i);
        var i = document.createElement("div");
        i.innerHTML = alertMessageToDisplay,
        document.body.insertBefore(i, document.body.firstChild),
        saveCookie(1)
    }
}),
_cookiepolicy(document).keydown(function(e) {
    if (27 == e.keyCode && 27 == e.keyCode && !e.disableEscape)
        return !1
});
var arr1 = ["&nbsp;", "&iexcl;", "&cent;", "&pound;", "&curren;", "&yen;", "&brvbar;", "&sect;", "&uml;", "&copy;", "&ordf;", "&laquo;", "&not;", "&shy;", "&reg;", "&macr;", "&deg;", "&plusmn;", "&sup2;", "&sup3;", "&acute;", "&micro;", "&para;", "&middot;", "&cedil;", "&sup1;", "&ordm;", "&raquo;", "&frac14;", "&frac12;", "&frac34;", "&iquest;", "&Agrave;", "&Aacute;", "&Acirc;", "&Atilde;", "&Auml;", "&Aring;", "&AElig;", "&Ccedil;", "&Egrave;", "&Eacute;", "&Ecirc;", "&Euml;", "&Igrave;", "&Iacute;", "&Icirc;", "&Iuml;", "&ETH;", "&Ntilde;", "&Ograve;", "&Oacute;", "&Ocirc;", "&Otilde;", "&Ouml;", "&times;", "&Oslash;", "&Ugrave;", "&Uacute;", "&Ucirc;", "&Uuml;", "&Yacute;", "&THORN;", "&szlig;", "&agrave;", "&aacute;", "&acirc;", "&atilde;", "&auml;", "&aring;", "&aelig;", "&ccedil;", "&egrave;", "&eacute;", "&ecirc;", "&euml;", "&igrave;", "&iacute;", "&icirc;", "&iuml;", "&eth;", "&ntilde;", "&ograve;", "&oacute;", "&ocirc;", "&otilde;", "&ouml;", "&divide;", "&oslash;", "&ugrave;", "&uacute;", "&ucirc;", "&uuml;", "&yacute;", "&thorn;", "&yuml;", "&quot;", "&amp;", "&lt;", "&gt;", "&OElig;", "&oelig;", "&Scaron;", "&scaron;", "&Yuml;", "&circ;", "&tilde;", "&ensp;", "&emsp;", "&thinsp;", "&zwnj;", "&zwj;", "&lrm;", "&rlm;", "&ndash;", "&mdash;", "&lsquo;", "&rsquo;", "&sbquo;", "&ldquo;", "&rdquo;", "&bdquo;", "&dagger;", "&Dagger;", "&permil;", "&lsaquo;", "&rsaquo;", "&euro;", "&fnof;", "&Alpha;", "&Beta;", "&Gamma;", "&Delta;", "&Epsilon;", "&Zeta;", "&Eta;", "&Theta;", "&Iota;", "&Kappa;", "&Lambda;", "&Mu;", "&Nu;", "&Xi;", "&Omicron;", "&Pi;", "&Rho;", "&Sigma;", "&Tau;", "&Upsilon;", "&Phi;", "&Chi;", "&Psi;", "&Omega;", "&alpha;", "&beta;", "&gamma;", "&delta;", "&epsilon;", "&zeta;", "&eta;", "&theta;", "&iota;", "&kappa;", "&lambda;", "&mu;", "&nu;", "&xi;", "&omicron;", "&pi;", "&rho;", "&sigmaf;", "&sigma;", "&tau;", "&upsilon;", "&phi;", "&chi;", "&psi;", "&omega;", "&thetasym;", "&upsih;", "&piv;", "&bull;", "&hellip;", "&prime;", "&Prime;", "&oline;", "&frasl;", "&weierp;", "&image;", "&real;", "&trade;", "&alefsym;", "&larr;", "&uarr;", "&rarr;", "&darr;", "&harr;", "&crarr;", "&lArr;", "&uArr;", "&rArr;", "&dArr;", "&hArr;", "&forall;", "&part;", "&exist;", "&empty;", "&nabla;", "&isin;", "&notin;", "&ni;", "&prod;", "&sum;", "&minus;", "&lowast;", "&radic;", "&prop;", "&infin;", "&ang;", "&and;", "&or;", "&cap;", "&cup;", "&int;", "&there4;", "&sim;", "&cong;", "&asymp;", "&ne;", "&equiv;", "&le;", "&ge;", "&sub;", "&sup;", "&nsub;", "&sube;", "&supe;", "&oplus;", "&otimes;", "&perp;", "&sdot;", "&lceil;", "&rceil;", "&lfloor;", "&rfloor;", "&lang;", "&rang;", "&loz;", "&spades;", "&clubs;", "&hearts;", "&diams;"]
  , arr2 = ["&#160;", "&#161;", "&#162;", "&#163;", "&#164;", "&#165;", "&#166;", "&#167;", "&#168;", "&#169;", "&#170;", "&#171;", "&#172;", "&#173;", "&#174;", "&#175;", "&#176;", "&#177;", "&#178;", "&#179;", "&#180;", "&#181;", "&#182;", "&#183;", "&#184;", "&#185;", "&#186;", "&#187;", "&#188;", "&#189;", "&#190;", "&#191;", "&#192;", "&#193;", "&#194;", "&#195;", "&#196;", "&#197;", "&#198;", "&#199;", "&#200;", "&#201;", "&#202;", "&#203;", "&#204;", "&#205;", "&#206;", "&#207;", "&#208;", "&#209;", "&#210;", "&#211;", "&#212;", "&#213;", "&#214;", "&#215;", "&#216;", "&#217;", "&#218;", "&#219;", "&#220;", "&#221;", "&#222;", "&#223;", "&#224;", "&#225;", "&#226;", "&#227;", "&#228;", "&#229;", "&#230;", "&#231;", "&#232;", "&#233;", "&#234;", "&#235;", "&#236;", "&#237;", "&#238;", "&#239;", "&#240;", "&#241;", "&#242;", "&#243;", "&#244;", "&#245;", "&#246;", "&#247;", "&#248;", "&#249;", "&#250;", "&#251;", "&#252;", "&#253;", "&#254;", "&#255;", "&#34;", "&#38;", "&#60;", "&#62;", "&#338;", "&#339;", "&#352;", "&#353;", "&#376;", "&#710;", "&#732;", "&#8194;", "&#8195;", "&#8201;", "&#8204;", "&#8205;", "&#8206;", "&#8207;", "&#8211;", "&#8212;", "&#8216;", "&#8217;", "&#8218;", "&#8220;", "&#8221;", "&#8222;", "&#8224;", "&#8225;", "&#8240;", "&#8249;", "&#8250;", "&#8364;", "&#402;", "&#913;", "&#914;", "&#915;", "&#916;", "&#917;", "&#918;", "&#919;", "&#920;", "&#921;", "&#922;", "&#923;", "&#924;", "&#925;", "&#926;", "&#927;", "&#928;", "&#929;", "&#931;", "&#932;", "&#933;", "&#934;", "&#935;", "&#936;", "&#937;", "&#945;", "&#946;", "&#947;", "&#948;", "&#949;", "&#950;", "&#951;", "&#952;", "&#953;", "&#954;", "&#955;", "&#956;", "&#957;", "&#958;", "&#959;", "&#960;", "&#961;", "&#962;", "&#963;", "&#964;", "&#965;", "&#966;", "&#967;", "&#968;", "&#969;", "&#977;", "&#978;", "&#982;", "&#8226;", "&#8230;", "&#8242;", "&#8243;", "&#8254;", "&#8260;", "&#8472;", "&#8465;", "&#8476;", "&#8482;", "&#8501;", "&#8592;", "&#8593;", "&#8594;", "&#8595;", "&#8596;", "&#8629;", "&#8656;", "&#8657;", "&#8658;", "&#8659;", "&#8660;", "&#8704;", "&#8706;", "&#8707;", "&#8709;", "&#8711;", "&#8712;", "&#8713;", "&#8715;", "&#8719;", "&#8721;", "&#8722;", "&#8727;", "&#8730;", "&#8733;", "&#8734;", "&#8736;", "&#8743;", "&#8744;", "&#8745;", "&#8746;", "&#8747;", "&#8756;", "&#8764;", "&#8773;", "&#8776;", "&#8800;", "&#8801;", "&#8804;", "&#8805;", "&#8834;", "&#8835;", "&#8836;", "&#8838;", "&#8839;", "&#8853;", "&#8855;", "&#8869;", "&#8901;", "&#8968;", "&#8969;", "&#8970;", "&#8971;", "&#9001;", "&#9002;", "&#9674;", "&#9824;", "&#9827;", "&#9829;", "&#9830;"];
function swapArrayVals(e, t, n) {
    if (this.isEmpty(e))
        return "";
    var i;
    if (t && n && t.length == n.length)
        for (var a = 0, o = t.length; a < o; a++)
            i = new RegExp(t[a],"g"),
            e = e.replace(i, n[a]);
    return e
}
function FindNewLangWithCountryCode(e) {
    var t = !1
      , n = "GB"
      , i = new Array(10);
    i[0] = new Array(2),
    i[0][0] = "ja",
    i[0][1] = "JP",
    i[1] = new Array(2),
    i[1][0] = "en",
    i[1][1] = "GB",
    i[2] = new Array(2),
    i[2][0] = "zh",
    i[2][1] = "TW",
    i[3] = new Array(2),
    i[3][0] = "de",
    i[3][1] = "DE",
    i[4] = new Array(2),
    i[4][0] = "fr",
    i[4][1] = "FR",
    i[5] = new Array(2),
    i[5][0] = "es",
    i[5][1] = "ES",
    i[6] = new Array(2),
    i[6][0] = "nl",
    i[6][1] = "NL",
    i[7] = new Array(2),
    i[7][0] = "it",
    i[7][1] = "IT",
    i[8] = new Array(2),
    i[8][0] = "pt",
    i[8][1] = "PT",
    i[9] = new Array(2),
    i[9][0] = "sk",
    i[9][1] = "SK";
    for (var a = 0; a < 10; a++)
        for (var o = 0; o < 2; o++)
            if (i[a][o],
            0 == o && i[a][o] == e) {
                e = e + "_" + (n = i[a][o + 1]),
                t = !0;
                break
            }
    return t || (e = "en_" + n),
    e
}
var SCM = SCM || {};
SCM.BookToc = SCM.BookToc || {},
function(e, s) {
    function t(e) {
        var t, n, i, a, o, r = s(this).find(".js-show-headings-icon");
        r.length || (r = s(this).parent().find(".js-show-headings-icon")),
        r.length ? (t = r.data("sectionid")) ? (n = r.data("targeturl")) ? (i = s(".js-headings-placeholder[data-sectionid=" + t + "]")).length ? (a = s(".js-show-headings-icon[data-sectionid=" + t + "]"),
        r.hasClass("icon-general-arrow-filled-right") ? (i.children().length || (o = window.location.origin + "/Book/ChapterHeadings",
        s.ajax({
            url: o,
            data: {
                chapterId: t,
                targetUrl: n,
                BypassOutputCache: -1 < window.location.search.toLowerCase().indexOf("bypassoutputcache=true")
            }
        }).done(function(e) {
            e && e.length && i.append(e)
        }).fail(function(e, t) {
            window.console && window.console.error && (console.error("error: " + e.responseText),
            console.error("status: " + t),
            a.removeClass("icon-general-arrow-filled-down"),
            a.addClass("icon-general-arrow-filled-right"),
            a.addClass("disabled"))
        })),
        a.removeClass("icon-general-arrow-filled-right"),
        a.addClass("icon-general-arrow-filled-down")) : r.hasClass("icon-general-arrow-filled-down") && (a.removeClass("icon-general-arrow-filled-down"),
        a.addClass("icon-general-arrow-filled-right")),
        i.toggleClass("hide")) : console.error(".js-headings-placeholder not found") : console.error("targeturl not found") : console.error("sectionid not found") : console.error(".js-show-headings-icon not found")
    }
    e.init = function() {
        e.registerHeadingsClick(),
        e.checkAccess(),
        s("#hfIsBookTocSlim").val() && e.addNotesTocLink()
    }
    ,
    e.registerHeadingsClick = function() {
        s(document).on("click", ".js-show-headings-button", t),
        s("#hfIsBookTocSlim").val() && s(document).on("click", ".js-tocLink", t)
    }
    ,
    e.checkAccess = function() {
        var e;
        !s(".chapter-user-restricted").length || (e = s(".js-tocLink.active")).length && ((e = e.closest(".js-toc-chapter-link")).find(".js-jumplink").addClass("hide").removeAttr("href"),
        e.find(".js-jumplink-span").removeClass("hide"))
    }
    ,
    e.addNotesTocLink = function() {
        var e, t, n = s("#endNotesTargetLocation").find(".widget-items"), i = s("#chapter-footnotes"), a = s(".js-tocLink.active:last");
        a.length && ((e = a.closest(".js-toc-chapter-link")).length ? (t = e.find(".js-toc-notes-link"),
        a = e.find(".js-toc-footnotes-link"),
        n.length && "" != n.html().trim() && t.length && (t.removeClass("hide"),
        SCM.JumpLinks.registerNotesTocLink("#endNotesTargetLocation", "js-notes-link-end-notes")),
        i.length && a.length && (a.removeClass("hide"),
        SCM.JumpLinks.registerNotesTocLink("#chapter-footnotes", "js-notes-link-chapter-footnotes")),
        a = e,
        i = i,
        n.length || i.length || a.find(".js-toc-chapter-link:not(.hide)").length || e.find(".js-show-headings-button").addClass("hide")) : s(".js-show-headings-button").addClass("hide"))
    }
}(SCM.BookToc.Headings = SCM.BookToc.Headings || {}, jQuery);
var SCM = SCM || {};
!function(e, t, n, i) {
    e.init = function() {
        t.init(),
        n.init()
    }
    ,
    e.goToPageHandler = function() {
        i("#goToPageNumberBook, #goToPageNumber").on("click", function(e) {
            i(".pageError").hide();
            var t, n = i("#pageNumberEntry").val();
            n.length ? (t = i("a[name='page-" + n + "']"),
            !i("a[name='page-" + n + "']").closest("#endNotesTargetLocation").length && t && t.length ? (window.location.hash = "page-" + n,
            i("#pageNumberEntry").val("")) : (t = App.CurrentSubdomain.length ? "/" + App.CurrentSubdomain : "",
            i.ajax({
                url: t + "/Content/GoToBookPage",
                cache: !1,
                data: {
                    bookId: i("#pageNumberEntry").attr("data-bookid"),
                    pageNum: n
                },
                dataType: "json",
                success: function(e) {
                    e.Success ? window.location = e.RedirectURL : i(".pageError").text(e.ErrorMessage).show()
                }
            }))) : i(".pageError").text("Please enter a page number").show()
        })
    }
    ,
    i(function() {
        e.init(),
        e.goToPageHandler()
    })
}(SCM.BookToc = SCM.BookToc || {}, SCM.BookToc.Headings = SCM.BookToc.Headings || {}, SCM.InstitutionOpenUrl = SCM.InstitutionOpenUrl || {}, jQuery);
var SCM = SCM || {};
!function(ns, $) {
    ns.initChapterAbstractClickEvent = function() {
        $(".master-main").on("click", ".js-showChapterAbstractLink", function() {
            var wrapperDiv = $(this).closest("div[data-chapter-abstract-to-be-fetched-wrapper]")
              , chapterId = $(wrapperDiv).attr("data-chapterid-for-abstract")
              , bookId = $(wrapperDiv).attr("data-bookid-for-abstract")
              , triedFetchDiv = $(wrapperDiv).children("div[data-tried-to-fetch-abstract]").first()
              , triedFetch = "true" === $(triedFetchDiv).attr("data-tried-to-fetch-abstract")
              , abstractLocation = $("#abstract-" + chapterId)
              , baseSiteUrl = $("#hfSiteURL")
              , abstractLinks = $("#abstract-" + chapterId + "-links")
              , ajaxUrl = "extract" == $(this).parent().attr("data-link-chapter-abstract-type") ? "/PlatformBook/ChapterAbstractOrExtractAjax" : "/PlatformBook/ChapterAbstractAjax";
            baseSiteUrl && baseSiteUrl.val() && (ajaxUrl = "//" + baseSiteUrl.val() + ajaxUrl),
            $(abstractLocation).closest("li").toggleClass("abstractExpanded"),
            triedFetch || ($(abstractLocation).append('<div class="spinner"></div>'),
            $.ajax({
                url: ajaxUrl,
                type: "GET",
                data: {
                    chapterId: chapterId,
                    bookId: bookId
                },
                success: function(e) {
                    abstractLocation.html(e.Html),
                    abstractLocation.append(abstractLinks.html())
                },
                error: function(xmlHttpRequest, textStatus, errorThrown) {
                    var err;
                    $(abstractLocation).find(".spinner").remove(),
                    window.console && (err = eval("(" + xmlHttpRequest.responseText + ")"),
                    console.log("error: " + err),
                    console.log("status: " + textStatus))
                }
            }),
            $(triedFetchDiv).attr("data-tried-to-fetch-abstract", "true")),
            abstractLocation.toggleClass("hide");
            var $thisAbstractIcon = wrapperDiv.find(".abstract-toggle-icon")
              , toggleIconClass = $thisAbstractIcon.attr("data-icon-class")
              , downArrow = toggleIconClass + "-down"
              , upArrow = toggleIconClass + "-up";
            $thisAbstractIcon.toggleClass(downArrow),
            $thisAbstractIcon.toggleClass(upArrow)
        })
    }
}(SCM.ChapterAbstract = SCM.ChapterAbstract || {}, jQuery),
jQuery(document).ready(function(e) {
    SCM.ChapterAbstract.initChapterAbstractClickEvent()
});
var SCM = SCM || {};
!function(ns, $) {
    ns.initBookAbstractClickEvent = function() {
        $(".master-main").on("click", ".js-showBookAbstractLink", function() {
            var wrapperDiv = $(this).closest("[data-book-abstract-to-be-fetched-wrapper]")
              , bookId = $(wrapperDiv).attr("data-bookid-abstract")
              , triedFetchDiv = $(wrapperDiv).children("[data-tried-to-fetch-abstract]").first()
              , triedFetch = "true" === $(triedFetchDiv).attr("data-tried-to-fetch-abstract")
              , abstractLocation = $("#abstract-" + bookId)
              , baseSiteUrl = $("#hfSiteURL")
              , abstractLinks = $("#abstract-" + bookId + "-links")
              , ajaxUrl = "extract" == $(this).parent().attr("data-link-book-abstract-type") ? "/Book/BookAbstractOrExtractAjax" : "/Book/BookAbstractAjax";
            baseSiteUrl && baseSiteUrl.val() && (ajaxUrl = "//" + baseSiteUrl.val() + ajaxUrl),
            $(abstractLocation).closest("li").toggleClass("abstractExpanded"),
            triedFetch || ($(abstractLocation).append('<div class="spinner"></div>'),
            $.ajax({
                url: ajaxUrl,
                type: "GET",
                data: {
                    bookId: bookId
                },
                success: function(e) {
                    abstractLocation.html(e.Html),
                    abstractLocation.append(abstractLinks.html())
                },
                error: function(xmlHttpRequest, textStatus, errorThrown) {
                    var err;
                    $(abstractLocation).find(".spinner").remove(),
                    window.console && (err = eval("(" + xmlHttpRequest.responseText + ")"),
                    console.log("error: " + err),
                    console.log("status: " + textStatus))
                }
            }),
            $(triedFetchDiv).attr("data-tried-to-fetch-abstract", "true")),
            abstractLocation.toggleClass("hide");
            var $thisAbstractIcon = wrapperDiv.find(".abstract-toggle-icon")
              , $downArrow = "icon-general-arrow-filled-down"
              , $upArrow = "icon-general-arrow-filled-up";
            $thisAbstractIcon.hasClass($downArrow) ? $thisAbstractIcon.removeClass($downArrow).addClass($upArrow) : $thisAbstractIcon.removeClass($upArrow).addClass($downArrow)
        })
    }
}(SCM.BookAbstract = SCM.BookAbstract || {}, jQuery),
jQuery(document).ready(function(e) {
    SCM.BookAbstract.initBookAbstractClickEvent()
});
var SCM = SCM || {};
!function(t, i) {
    t.init = function() {
        var e = i("#hfEnableOupOnlineProductsFeatures");
        e && "True" === e.val() && (i(".js-google-preview-ref-link").show(),
        i(".js-worldcat-preview-ref-link").show(),
        i(".js-copac-preview-ref-link").show(),
        t.showParagraphCitations())
    }
    ,
    t.showParagraphCitations = function() {
        var t = void 0
          , n = void 0;
        i(".js-citation-links").off("click"),
        i(".js-citation-links").on("click", function(e) {
            e.stopPropagation(),
            t = document.activeElement,
            (n = i(this).siblings(".citation-wrap")).is(":visible") ? n.removeClass("show-inline").addClass("hidden") : (i(".citation-wrap").removeClass("show-inline").addClass("hidden"),
            n.removeClass("hidden").addClass("show-inline"),
            (e = n.find(".citation-links a:visible")).length && e[0].focus())
        }),
        i(document).on("click", function() {
            void 0 !== n && (n.removeClass("show-inline").addClass("hidden"),
            void 0 !== t && t.focus(),
            n = void 0)
        })
    }
}(SCM.RefLinks = SCM.RefLinks || {}, jQuery);
var SCM = SCM || {};
!function(e, g) {
    e.queryBuilderHandler = function() {
        var e = g(".querybuilder-submit").attr("data-current-url").split("&")
          , t = ["fd_IsLatestEdition", "cqb", "qb", "page", "q"]
          , n = e.filter(function(e) {
            e = e.split("=")[0];
            return t.indexOf(e) < 0
        });
        (n = function(e) {
            var l, c = [], d = {}, u = [], h = {}, f = 1, p = !1;
            g(".querybuilder-wrap .querybuilder-instance").each(function(e) {
                var t, n, i, a, o, r, s = g(this);
                s.hasClass("hide") || (t = "qOp" + f,
                void 0 !== l && 0 < l.length && (h[t] = l.val()),
                ((r = (0 === (a = s.find("#instance_QueryBuilderSearchTerm")).length ? s.find(".querybuilder-input") : a).val().trim()).match(/\"/g) || []).length % 2 != 0 && (r = r.replace(/\"/g, "")),
                n = !1,
                (/[^']*'$/.test(r) || /[^"]*"$/.test(r)) && (n = !0),
                o = r.replace(/^"(.*)"$/, "$1"),
                i = encodeURIComponent(o),
                void 0 !== (a = s.find(".querybuilder-filter-dropdown .querybuilder-filter.selected").attr("data-fieldname")) && 0 !== a.length || (a = ""),
                o = {},
                void 0 !== (l = s.find("[name^=operator-]:checked")) && 0 < l.length && ("OR" === l.val() ? (u.length && (u[0].condition && delete u[0].condition,
                d.terms = u,
                c.push(d),
                u = [],
                d = {}),
                d.condition = l.val()) : o.condition = l.val(),
                h[t] = l.val()),
                o.filter = "all" === a ? "" : a,
                o.input = i,
                n && (o.exactMatch = !0),
                o.input && o.input.length && u.push(o),
                "" !== r.trim() && (r = a + f,
                "" === a && (r = "q",
                1 !== f && (r += f)),
                n && (r += "-exact"),
                h[r] = i,
                p = !0)),
                f++
            }),
            u.length && (u[0].condition && delete u[0].condition,
            d.terms = u,
            c.push(d));
            c.length && c[0].condition && delete c[0].condition;
            var t = JSON.stringify(c);
            e.push("cqb=" + t),
            p && (t = JSON.stringify(h),
            e.push("qb=" + t));
            return e
        }(n)).push("page=1");
        e = n.filter(function(e) {
            return e.startsWith("searchType")
        });
        return e || n.push("searchType=advanced"),
        (e = n.filter(function(e) {
            return e.startsWith("adv")
        })) || n.push("adv=true"),
        n.join("&")
    }
}(SCM.CustomQueryBuilder = SCM.CustomQueryBuilder || {}, jQuery);
var SCM = SCM || {};
SCM.Pagination = function(i) {
    return {
        init: function() {
            i(".js-pagination-click").length && i("body").on("click", ".js-pagination-click", function() {
                var e = i(this)
                  , t = e.data("click-handler").split(".");
                window[t[0]][t[1]][t[2]](e)
            })
        },
        performAjaxPagination: function(e, t) {
            {
                var n;
                t.data("elem-to-replace") ? (n = i(t.data("elem-to-replace"))) ? i.ajax(e).done(function(e) {
                    n.html(e)
                }).fail(function(e, t, n) {
                    window.console && (console.log("error: " + e.responseText),
                    console.log("status: " + t))
                }) : alert("Unable to find an element to respond to ajax response.") : alert("The elem-to-replace data attribute was not populated.  You must populate this in the Widget's view to pass back the call to performAjaxPagination")
            }
        },
        updateBrowseHistory: function(e, t) {
            var n = {
                pagination: t
            };
            history.pushState && (null !== history.state && history.state.pagination || history.replaceState({
                pagination: document.URL
            }, null, document.URL),
            history.pushState(n, null, t))
        },
        enableBrowserHistoryNavigation: function() {
            window.addEventListener("popstate", function(e) {
                e.state && history.state.pagination && (window.location = e.state.pagination)
            })
        },
        trimEndUntilRegexMatches: function(e, t) {
            for (; !e.match(t); )
                if (0 === (e = e.substr(0, e.length - 1)).length)
                    return alert("SCM.Pagination.trimEndUntilRegexMatches: The entire string was trimmed, this likely indicates a problem with your regex pattern.  Note:  This method expects a regular expression literal (see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions)"),
                    "";
            return e
        },
        scrollToTop: function() {
            i(window).scrollTop(0)
        }
    }
}(jQuery),
jQuery(function() {
    SCM.Pagination.init()
});
var SCM = SCM || {};
SCM.CitedByPagination = function(e) {
    var n, i;
    return {
        init: function() {
            e(".widget-CrossRefCitedBy").length && (n = SCM.Pagination.trimEndUntilRegexMatches(document.URL.valueOf(), /[a-zA-Z]\/\d+$/),
            i = n.match(/[a-zA-Z]\/(\d+)$/)[1],
            SCM.Pagination.enableBrowserHistoryNavigation())
        },
        handlePaginationClick: function(e) {
            SCM.Pagination.updateBrowseHistory(n, n + "/" + e.data("clicked-page"));
            var t = {
                type: "POST",
                url: (App.CurrentSubdomain.length ? "/" + App.CurrentSubdomain : "") + "/ThirdParty/CrossRefCitedBy/" + e.data("parent-instance"),
                cache: !1,
                data: {
                    selectedPage: e.data("clicked-page"),
                    articleId: i
                }
            };
            SCM.Pagination.performAjaxPagination(t, e)
        }
    }
}(jQuery),
jQuery(function() {
    SCM.CitedByPagination.init()
});
var SCM = SCM || {};
!function(e) {
    var r = $(".js-invalid").length ? $(".js-invalid") : void 0;
    e.PerformCalculation = function(e, t, n) {
        if (e && e.length) {
            var i = e.closest("tr")
              , a = e.hasClass("js-si-right") ? "js-si-right" : "js-si-left"
              , o = i.find(".js-invalid." + a);
            if (isNaN(e.val()))
                return e.addClass("invalid"),
                void (void 0 !== r && (o.length || (o = r.clone()).addClass(a).appendTo(i),
                function(e, t, n) {
                    var i = e.position();
                    t.removeClass("hide"),
                    t.addClass("at-invalidInputFlyout");
                    var a = i.top - t.outerHeight() - 4
                      , o = i.left - 4
                      , r = "a-left";
                    "js-si-right" === n && (n = e.outerWidth(),
                    e = t.outerWidth(),
                    o = i.left - (e - n) + 4,
                    r = "a-right"),
                    t.find(".arrow-down").addClass(r),
                    t.css({
                        top: a,
                        left: o
                    })
                }(e, o, a)));
            i.find(".invalid").each(function(e) {
                $(this).removeClass("invalid")
            }),
            i.find(".js-invalid").each(function(e) {
                $(this).addClass("hide"),
                $(this).removeClass("at-invalidInputFlyout")
            });
            t = i.find(t);
            t.length && t.val(function(e, t, n) {
                t = t.find(".js-si-calc");
                if (!t.length)
                    return;
                t = t.attr("data-calc");
                return "" === e.val() ? "" : n(e.val(), t).toFixed(2)
            }(e, i, n))
        }
    }
}(SCM.SiConversionCalculator = SCM.SiConversionCalculator || {}),
$(function() {
    $(document.body).on("input", ".js-si-left", function() {
        SCM.SiConversionCalculator.PerformCalculation($(this), ".js-si-right", function(e, t) {
            return e * t
        })
    }),
    $(document.body).on("input", ".js-si-right", function() {
        SCM.SiConversionCalculator.PerformCalculation($(this), ".js-si-left", function(e, t) {
            return e / t
        })
    })
});
var ArtMetric = {}
  , $body = $("body")
  , $printableModal = $(".js-printable-metrics-modal");
function getWidgetInstanceName(e) {
    var t = ""
      , n = $(e).attr("class")
      , e = n.indexOf("widget-instance-");
    return 0 <= e && (t = n.substr(e).split("-")[2]),
    t
}
ArtMetric.fullVersion = function($dest, routeUrl) {
    var ctHtmlLabels, baseSiteUrl;
    $dest.find(".widget-ArticleLevelMetrics").length < 1 && (ctHtmlLabels = function(e) {
        return function(e) {
            e.on("draw", function(e) {
                "label" === e.type && ((e = e.element._node.childNodes[0]).innerHTML = e.innerText)
            })
        }
    }
    ,
    baseSiteUrl = $("#hfSiteURL"),
    void 0 !== baseSiteUrl && void 0 !== baseSiteUrl.val() && "" != baseSiteUrl && (routeUrl = "//" + baseSiteUrl.val() + routeUrl),
    $.ajax({
        url: routeUrl,
        datatype: "HTML",
        success: function(e) {
            $dest.prepend(e),
            setTimeout(function() {
                var e, t, n;
                void 0 !== window.ChartistData && (e = {
                    lineSmooth: !1,
                    showArea: !0,
                    low: 0,
                    plugins: [ctHtmlLabels()]
                },
                t = [["screen and (max-width: 1024px)", {
                    axisX: {
                        labelInterpolationFnc: function(e) {
                            return e.slice(0, 3)
                        }
                    }
                }], ["screen and (min-width: 1px)", {
                    axisX: {
                        labelInterpolationFnc: function(e) {
                            return e
                        }
                    },
                    plugins: [ctHtmlLabels()]
                }]],
                n = ".ct-chart",
                $("#sv_main:visible").length && (n = ".sv-ct-chart",
                $dest.find(".ct-chart").addClass("sv-ct-chart")),
                ArtMetric.createChart(n, window.ChartistData.data, e, t))
            }, 200),
            $(".artmet-dimensions").length && window.__dimensions_embed && window.__dimensions_embed.addBadges && window.__dimensions_embed.addBadges()
        },
        error: function(xmlHttpRequest, textStatus, errorThrown) {
            var err;
            window.console && (err = eval("(" + xmlHttpRequest.responseText + ")"),
            console.log("error: " + err),
            console.log("status: " + textStatus))
        }
    }))
}
,
ArtMetric.limitLabels = function() {
    var e = $(".ct-horizontal.ct-label")
      , t = e.length
      , n = Math.ceil(t / 8)
      , i = 1;
    e.not(":eq(0)").each(function() {
        i % n != 0 && $(this).hide(),
        i++
    })
}
,
ArtMetric.createChart = function(e, t, n, i) {
    var i = new Chartist.Line(e,t,n,i)
      , a = 0;
    i.on("created", function() {
        a = 0,
        ArtMetric.limitLabels()
    }),
    i.on("draw", function(e) {
        "line" !== e.type && "point" !== e.type && "area" !== e.type || a++,
        "line" === e.type ? e.element.animate({
            opacity: {
                begin: 25 * a + 150,
                dur: 250,
                from: 0,
                to: 1
            }
        }) : "point" === e.type ? e.element.animate({
            x1: {
                begin: 25 * a,
                dur: 250,
                from: e.x - 10,
                to: e.x,
                easing: "easeOutQuart"
            },
            x2: {
                begin: 25 * a,
                dur: 250,
                from: e.x - 10,
                to: e.x,
                easing: "easeOutQuart"
            },
            opacity: {
                begin: 25 * a,
                dur: 250,
                from: 0,
                to: 1,
                easing: "easeOutQuart"
            }
        }) : "area" === e.type && e.element.animate({
            opacity: {
                begin: 25 * a + 250,
                dur: 300,
                from: 0,
                to: 1
            }
        })
    })
}
,
ArtMetric.triggerModal = function(e, t) {
    var n = $(".artmet-dimensions").length ? "true" : "false"
      , i = "/ThirdParty/ArticleLevelMetricsDetails"
      , a = getWidgetInstanceName(".widget-ArticleLevelMetrics");
    0 < a.length && (i += "/" + a),
    i += "?articleId=" + t + "&showDimensionsBadge=" + n,
    ArtMetric.fullVersion(e, i),
    e.parent().css({
        display: "block",
        opacity: 1
    }),
    $body.addClass("metrics-modal-open"),
    0 < $printableModal.length && $printableModal.addClass("metrics-modal-open")
}
,
ArtMetric.closeModal = function() {
    $(".artmet-modal:visible").attr("style", ""),
    $body.removeClass("metrics-modal-open"),
    $printableModal.removeClass("metrics-modal-open")
}
,
ArtMetric.eventsToClose = function() {
    $(".js-artmet-close-modal").click(function() {
        ArtMetric.closeModal()
    }),
    $(".js-artmet-modal").click(function() {
        $(event.target).closest(".artmet-modal-contents").length || ArtMetric.closeModal()
    })
}
,
ArtMetric.cloneMetricsModalForPrint = function(e) {
    var t;
    0 == $printableModal.length && e.length && (t = $("<div/>", {
        class: "printable-metrics-modal js-printable-metrics-modal"
    }),
    e.clone().appendTo(t),
    0 < $("body.metrics-modal-open").length && t.addClass("metrics-modal-open"),
    $body.append(t),
    $printableModal = $(".js-printable-metrics-modal"))
}
,
$(document).ready(function() {
    $(".widget-ArticleLevelMetrics:visible").on("click", ".js-artmet-modal-trigger, .artmet-condensed-stats .artmet-views", function(e) {
        var t = $(".widget-ArticleLevelMetrics:visible .artmet-modal-trigger").attr("data-article-id");
        ArtMetric.triggerModal($(".artmet-modal-contents").first(), t)
    }),
    $(window).on("beforeprint", function() {
        var e = $(".js-metric-modal-contents:has(.js-metric-full-wrap):first");
        !$printableModal.length && e.length && ArtMetric.cloneMetricsModalForPrint(e)
    }),
    ArtMetric.eventsToClose()
});
var SCM = SCM || {}
  , $body = $("body")
  , $printableModal = $(".js-printable-metrics-modal");
SCM.ContentMetric = function(ns) {
    function fullVersion($dest, routeUrl) {
        var ctHtmlLabels, baseSiteUrl;
        $dest.find(".widget-ContentLevelMetrics").length < 1 && (ctHtmlLabels = function(e) {
            return function(e) {
                e.on("draw", function(e) {
                    "label" === e.type && ((e = e.element._node.childNodes[0]).innerHTML = e.innerText)
                })
            }
        }
        ,
        baseSiteUrl = $("#hfSiteURL"),
        void 0 !== baseSiteUrl && void 0 !== baseSiteUrl.val() && "" != baseSiteUrl && (routeUrl = "//" + baseSiteUrl.val() + routeUrl),
        $.ajax({
            url: routeUrl,
            datatype: "HTML",
            success: function(e) {
                e = updateAltmetricPropsForBooksAndArticles(e),
                $dest.prepend(e),
                $(window).on("beforeprint", function() {
                    var e = $(".js-metric-modal-contents:has(.js-metric-full-wrap):first");
                    e.length && cloneMetricsModalForPrint(e)
                }),
                setTimeout(function() {
                    var e, t;
                    void 0 !== window.ChartistData && (e = {
                        lineSmooth: !1,
                        showArea: !0,
                        low: 0,
                        plugins: [ctHtmlLabels()]
                    },
                    t = [["screen and (max-width: 1024px)", {
                        axisX: {
                            labelInterpolationFnc: function(e) {
                                return e.slice(0, 3)
                            }
                        }
                    }], ["screen and (min-width: 1px)", {
                        axisX: {
                            labelInterpolationFnc: function(e) {
                                return e
                            }
                        },
                        plugins: [ctHtmlLabels()]
                    }]],
                    createChart(".ct-chart", window.ChartistData.data, e, t))
                }, 200),
                $(".artmet-dimensions").length && window.__dimensions_embed && window.__dimensions_embed.addBadges && window.__dimensions_embed.addBadges()
            },
            error: function(xmlHttpRequest, textStatus, errorThrown) {
                var err;
                window.console && (err = eval("(" + xmlHttpRequest.responseText + ")"),
                console.log("error: " + err),
                console.log("status: " + textStatus))
            }
        }))
    }
    function limitLabels() {
        var e = $(".ct-horizontal.ct-label")
          , t = e.length
          , n = Math.ceil(t / 8)
          , i = 1;
        e.not(":eq(0)").each(function() {
            i % n != 0 && $(this).hide(),
            i++
        })
    }
    function createChart(e, t, n, i) {
        var i = new Chartist.Line(e,t,n,i)
          , a = 0;
        i.on("created", function() {
            a = 0,
            limitLabels()
        }),
        i.on("draw", function(e) {
            "line" !== e.type && "point" !== e.type && "area" !== e.type || a++,
            "line" === e.type ? e.element.animate({
                opacity: {
                    begin: 25 * a + 150,
                    dur: 250,
                    from: 0,
                    to: 1
                }
            }) : "point" === e.type ? e.element.animate({
                x1: {
                    begin: 25 * a,
                    dur: 250,
                    from: e.x - 10,
                    to: e.x,
                    easing: "easeOutQuart"
                },
                x2: {
                    begin: 25 * a,
                    dur: 250,
                    from: e.x - 10,
                    to: e.x,
                    easing: "easeOutQuart"
                },
                opacity: {
                    begin: 25 * a,
                    dur: 250,
                    from: 0,
                    to: 1,
                    easing: "easeOutQuart"
                }
            }) : "area" === e.type && e.element.animate({
                opacity: {
                    begin: 25 * a + 250,
                    dur: 300,
                    from: 0,
                    to: 1
                }
            })
        })
    }
    function getWidgetInstanceName(e) {
        var t = ""
          , n = $(e).attr("class")
          , e = n.indexOf("widget-instance-");
        return 0 <= e && (t = n.substr(e).split("-")[2]),
        t
    }
    function triggerModal(e, t, n) {
        var i = $(".content-main .contentmet-dimensions").length ? "true" : "false"
          , a = "/ThirdParty/ContentLevelMetricsDetails"
          , o = getWidgetInstanceName(".widget-ContentLevelMetrics");
        0 < o.length && (a += "/" + o),
        fullVersion(e, a += "?resourceId=" + t + "&resourceType=" + n + "&showDimensionsBadge=" + i),
        e.closest(".artmet-modal").css({
            display: "block",
            opacity: 1
        }),
        $body.addClass("metrics-modal-open"),
        $printableModal.addClass("metrics-modal-open")
    }
    function closeModal(e) {
        e.closest(".artmet-modal").attr("style", ""),
        $body.removeClass("metrics-modal-open"),
        $printableModal.removeClass("metrics-modal-open")
    }
    function eventsToClose(t) {
        $(".content-main .js-contentmet-close-modal").on("click", function() {
            closeModal(t)
        }),
        $(".content-main .js-contentmet-modal").on("click", function(e) {
            $(e.target).closest(".artmet-modal-contents").length || closeModal(t)
        })
    }
    function registerModalClicks() {
        $("#Sidebar").on("click", ".js-contentmet-modal-trigger, .js-contentmet-views, .js-contentmet-citations", function() {
            var e = $(".content-main .contentmet-modal-trigger")
              , t = e.attr("data-resource-id")
              , e = e.attr("data-resource-type");
            triggerModal($(".content-main .artmet-modal-contents"), t, e)
        })
    }
    function updateAltmetricPropsForBooksAndArticles(e) {
        return $(".widget-BookChapterMainView").length ? e : e.replaceAll('data-hide-no-mentions="true"', 'data-hide-no-mentions="false"')
    }
    function cloneMetricsModalForPrint(e) {
        var t;
        0 == $printableModal.length && e.length && (t = $("<div/>", {
            class: "printable-metrics-modal js-printable-metrics-modal"
        }),
        e.clone().appendTo(t),
        0 < $("body.metrics-modal-open").length && t.addClass("metrics-modal-open"),
        $body.append(t),
        $printableModal = $(".js-printable-metrics-modal"))
    }
    function init() {
        $(document).ready(function() {
            registerModalClicks(),
            eventsToClose($(".content-main .artmet-modal-contents")),
            $(document).on("altmetric:show", function() {
                $(".shares-title").removeClass("hide")
            })
        })
    }
    return {
        init: init,
        triggerModal: triggerModal,
        closeModal: closeModal
    }
}(SCM.ContentMetric = SCM.ContentMetric || {});
var SCM = SCM || {};
SCM.ZEncoderV1 = function() {
    var n = [":", '"', "'", ",", "[", "]", "{", "}", " ", "/", "!", "#", "$", "&", "(", ")", "+", "=", "?", "@", "*", "%", ".", "_", "-"]
      , o = function() {
        for (var e = {}, t = 0; t < n.length; t++)
            e[n[t]] = String.fromCharCode("a".charCodeAt(0) + t);
        return e
    }()
      , r = (res = {},
    $.each(o, function(e, t) {
        res[t] = e
    }),
    res);
    return {
        Encode: function(e) {
            if (!e)
                return "";
            for (var t, n = "", i = 0; i < e.length; i++) {
                var a = e[i];
                "z" === a ? n += "zz" : "a" <= (t = a) && t <= "z" || "A" <= t && t <= "Z" || "0" <= t && t <= "9" ? n += a : (n += "z",
                o.hasOwnProperty(a) ? n += o[a] : n += function(e) {
                    for (var t = "", n = 0; n < e.length; n++)
                        t += ("000" + e.charCodeAt(n).toString(16)).slice(-4);
                    return t
                }(a))
            }
            return n
        },
        Decode: function(e) {
            if (!e)
                return "";
            for (var t = "", n = 0; n < e.length; n++) {
                var i = e[n];
                if ("z" === i) {
                    if (n === e.Length - 1)
                        return "";
                    if ("z" !== e[n + 1])
                        if (e[n + 1]in r)
                            t += r[e[n + 1]],
                            n++;
                        else {
                            if (n >= e.length - 4)
                                return "";
                            var a = e.substring(n + 1, 4);
                            if ("number" != typeof a)
                                return "";
                            t += a,
                            n += 4
                        }
                    else
                        t += "z",
                        n++
                } else
                    t += i
            }
            return t
        }
    }
}();
var SCM = SCM || {};
!function(e, t) {
    e.AddMetadataBorder = function() {
        (t(".js-chapter-abstract-wrap").length || t(".js-book-abstract-wrap").length) && t(".js-metadata-panel").addClass("add-border")
    }
    ,
    e.init = function() {
        e.AddMetadataBorder()
    }
}(SCM.BookMetadata = SCM.BookMetadata || {}, jQuery);
//# sourceMappingURL=site.min.js.map
